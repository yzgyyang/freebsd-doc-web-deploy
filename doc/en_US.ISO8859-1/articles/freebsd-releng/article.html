<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>FreeBSD Release Engineering</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><meta name="description" content="This article describes the release engineering process of the FreeBSD Project." /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div xml:lang="en" class="article" lang="en"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp43976440"></a>FreeBSD Release Engineering</h1></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Glen</span> <span class="surname">Barber</span></h3><div class="affiliation"><span class="orgname"> <a class="link" href="https://www.freebsdfoundation.org" target="_top">The
	      FreeBSD Foundation</a><br /></span></div><div class="affiliation"><span class="orgname"> <a class="link" href="https://www.netgate.com" target="_top">Rubicon
	      Communications, LLC (Netgate)</a><br /></span><div class="address"><p><code class="email">&lt;<a xmlns="" class="email" href="mailto:gjb@FreeBSD.org">gjb@FreeBSD.org</a>&gt;</code></p></div></div></div></div></div><div><div xmlns="http://www.w3.org/1999/xhtml" class="legalnotice"><a id="trademarks"></a><p>FreeBSD is a registered trademark of
  the FreeBSD Foundation.</p><p>Intel, Celeron, Centrino, Core, EtherExpress, i386,
  i486, Itanium, Pentium, and Xeon are trademarks or registered
  trademarks of Intel Corporation or its subsidiaries in the United
  States and other countries.</p><p>Many of the designations used by
  manufacturers and sellers to distinguish their products are claimed
  as trademarks.  Where those designations appear in this document,
  and the FreeBSD Project was aware of the trademark claim, the
  designations have been followed by the <span class="quote">&#8220;<span class="quote">&#8482;</span>&#8221;</span> or the
  <span class="quote">&#8220;<span class="quote">®</span>&#8221;</span> symbol.</p></div></div><div>Last modified on 2020-09-30 15:54:17 +0000 by gjb.</div><div><div xmlns="http://www.w3.org/1999/xhtml" class="abstract"><div class="abstract-title">Abstract</div><p>This article describes the release engineering process of
	the FreeBSD Project.</p></div></div></div><div class="docformatnavi">
      [
      <a href="index.html">Split HTML</a>
      /
      
	  Single HTML
	
      ]
    </div><hr /></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="sect1"><a href="#introduction">1. Introduction to the FreeBSD Release Engineering
      Process</a></span></dt><dt><span class="sect1"><a href="#releng-prep">2. General Information and Preparation</a></span></dt><dt><span class="sect1"><a href="#releng-terms">3. Release Engineering Terminology</a></span></dt><dt><span class="sect1"><a href="#releng-website">4. Website Changes During the Release Cycle</a></span></dt><dt><span class="sect1"><a href="#releng-head">5. Release from <code class="literal">head/</code></a></span></dt><dt><span class="sect1"><a href="#releng-stable">6. Release from <code class="literal">stable/</code></a></span></dt><dt><span class="sect1"><a href="#releng-building">7. Building FreeBSD Installation Media</a></span></dt><dt><span class="sect1"><a href="#releng-mirrors">8. Publishing FreeBSD Installation Media to Project Mirrors</a></span></dt><dt><span class="sect1"><a href="#releng-wrapup">9. Wrapping up the Release Cycle</a></span></dt><dt><span class="sect1"><a href="#releng-eol">10. Release End-of-Life</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="introduction"></a>1. Introduction to the FreeBSD Release Engineering
      Process</h2></div></div></div><p>Development of FreeBSD has a very specific workflow.  In
      general, all changes to the FreeBSD base system are committed to
      the <code class="literal">head/</code> branch, which reflects the top of the source
      tree.</p><p>After a reasonable testing period, changes can then be
      merged to the <code class="literal">stable/</code> branches.  The default minimum
      timeframe before merging to <code class="literal">stable/</code> branches is three
      (3) days.</p><p>Although a general rule to wait a minimum of three days
      before merging from <code class="literal">head/</code>, there are a few special
      circumstances where an immediate merge may be necessary, such as
      a critical security fix, or a bug fix that directly inhibits the
      release build process.</p><p>After several months, and the number of changes in the
      <code class="literal">stable/</code> branch have grown significantly, it is time to
      release the next version of FreeBSD.  These releases have been
      historically referred to as <span class="quote">&#8220;<span class="quote">point</span>&#8221;</span>
      releases.</p><p>In between releases from the <code class="literal">stable/</code> branches,
      approximately every two (2) years, a release will be cut
      directly from <code class="literal">head/</code>.  These releases have been
      historically referred to as <span class="quote">&#8220;<span class="quote">dot-zero</span>&#8221;</span>
      releases.</p><p>This article will highlight the workflow and
      responsibilities of the FreeBSD Release Engineering Team for both
      <span class="quote">&#8220;<span class="quote">dot-zero</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">point</span>&#8221;</span>'
      releases.</p><p>The following sections of this article describe:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><a class="xref" href="#releng-prep" title="2. General Information and Preparation">Section 2, &#8220;General Information and Preparation&#8221;</a></span></dt><dd><p>General information and preparation before
	    starting the release cycle.</p></dd><dt><span class="term"><a class="xref" href="#releng-website" title="4. Website Changes During the Release Cycle">Section 4, &#8220;Website Changes During the Release Cycle&#8221;</a></span></dt><dd><p>Website Changes During the Release Cycle</p></dd><dt><span class="term"><a class="xref" href="#releng-terms" title="3. Release Engineering Terminology">Section 3, &#8220;Release Engineering Terminology&#8221;</a></span></dt><dd><p>Terminology and general information, such as the
	    <span class="quote">&#8220;<span class="quote">code slush</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">code
	      freeze</span>&#8221;</span>, used throughout this document.</p></dd><dt><span class="term"><a class="xref" href="#releng-head" title="5. Release from head/">Section 5, &#8220;Release from <code class="literal">head/</code>&#8221;</a></span></dt><dd><p>The Release Engineering process for a
	    <span class="quote">&#8220;<span class="quote">dot-zero</span>&#8221;</span> release.</p></dd><dt><span class="term"><a class="xref" href="#releng-stable" title="6. Release from stable/">Section 6, &#8220;Release from <code class="literal">stable/</code>&#8221;</a></span></dt><dd><p>The Release Engineering process for a
	    <span class="quote">&#8220;<span class="quote">point</span>&#8221;</span> release.</p></dd><dt><span class="term"><a class="xref" href="#releng-building" title="7. Building FreeBSD Installation Media">Section 7, &#8220;Building FreeBSD Installation Media&#8221;</a></span></dt><dd><p>Information related to the specific procedures to
	    build installation medium.</p></dd><dt><span class="term"><a class="xref" href="#releng-mirrors" title="8. Publishing FreeBSD Installation Media to Project Mirrors">Section 8, &#8220;Publishing FreeBSD Installation Media to Project Mirrors&#8221;</a></span></dt><dd><p>Procedures to publish installation medium.</p></dd><dt><span class="term"><a class="xref" href="#releng-wrapup" title="9. Wrapping up the Release Cycle">Section 9, &#8220;Wrapping up the Release Cycle&#8221;</a></span></dt><dd><p>Wrapping up the release cycle.</p></dd></dl></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-prep"></a>2. General Information and Preparation</h2></div></div></div><p>Approximately two months before the start of the release
      cycle, the FreeBSD Release Engineering Team decides on a schedule for the release.
      The schedule includes the various milestone points of the
      release cycle, such as freeze dates, branch dates, and build
      dates.  For example:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Milestone</th><th>Anticipated Date</th></tr></thead><tbody><tr><td><code class="literal">head/</code> slush:</td><td>May 27, 2016</td></tr><tr><td><code class="literal">head/</code> freeze:</td><td>June 10, 2016</td></tr><tr><td><code class="literal">head/</code> KBI freeze:</td><td>June 24, 2016</td></tr><tr><td><code class="literal">doc/</code> tree slush [1]:</td><td>June 24, 2016</td></tr><tr><td>Ports quarterly branch [2]:</td><td>July 1, 2016</td></tr><tr><td><code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> branch:</td><td>July 8, 2016</td></tr><tr><td><code class="literal">doc/</code> tree tag [3]:</td><td>July 8, 2016</td></tr><tr><td>BETA1 build starts:</td><td>July 8, 2016</td></tr><tr><td><code class="literal">head/</code> thaw:</td><td>July 9, 2016</td></tr><tr><td>BETA2 build starts:</td><td>July 15, 2016</td></tr><tr><td>BETA3 build starts [*]:</td><td>July 22, 2016</td></tr><tr><td><code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code> branch:</td><td>July 29, 2016</td></tr><tr><td>RC1 build starts:</td><td>July 29, 2016</td></tr><tr><td><code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> thaw:</td><td>July 30, 2016</td></tr><tr><td>RC2 build starts:</td><td>August 5, 2016</td></tr><tr><td>Final Ports package builds [4]:</td><td>August 6, 2016</td></tr><tr><td>Ports release tag:</td><td>August 12, 2016</td></tr><tr><td>RC3 build starts [*]:</td><td>August 12, 2016</td></tr><tr><td>RELEASE build starts:</td><td>August 19, 2016</td></tr><tr><td>RELEASE announcement:</td><td>September 2, 2016</td></tr></tbody></table></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Items marked with "[*]" are "as
	needed".</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The <code class="literal">doc/</code> tree slush is coordinated by
	  the FreeBSD Documentation Engineering Team.</p></li><li class="listitem"><p>The Ports quarterly branch used is determined by when
	  the final <code class="literal">RC</code> build is planned.  A new
	  quarterly branch is created on the first day of the quarter,
	  so this metric should be used when taking the release cycle
	  milestones into account.  The quarterly branch is created by
	  the FreeBSD Ports Management Team.</p></li><li class="listitem"><p>The <code class="literal">doc/</code> tree is tagged by the
	  FreeBSD Documentation Engineering Team.</p></li><li class="listitem"><p>The final Ports package build is done by the
	  FreeBSD Ports Management Team after the final (or what is expected to be
	  final) <code class="literal">RC</code> build.</p></li></ol></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">If the release is being created from an existing
	<code class="literal">stable/</code> branch, the <acronym class="acronym">KBI</acronym>
	freeze date can be excluded, since the <acronym class="acronym">KBI</acronym>
	is already considered frozen on established
	<code class="literal">stable/</code> branches.</p></div><p>When writing the release cycle schedule, a number of things
      need to be taken into consideration, in particular milestones
      where the target date depends on predefined milestones upon
      which there is a dependency.  For example, the Ports Collection
      release tag originates from the active quarterly branch at the
      time of the last <code class="literal">RC</code>.  This in part defines
      which quarterly branch is used, when the release tag can happen,
      and what revision of the ports tree is used for the final
      <code class="literal">RELEASE</code> build.</p><p>After general agreement on the schedule, the FreeBSD Release Engineering Team
      emails the schedule to the FreeBSD Developers.</p><p>It is somewhat typical that many developers will inform
      the FreeBSD Release Engineering Team about various works-in-progress.  In some cases,
      an extension for the in-progress work will be requested, and
      in other cases, a request for <span class="quote">&#8220;<span class="quote">blanket approval</span>&#8221;</span>
      to a particular subset of the tree will be made.</p><p>When such requests are made, it is important to make sure
      timelines (even if estimated) are discussed.  For blanket
      approvals, the length of time for the blanket approval should
      be made clear.  For example, a FreeBSD developer may request
      blanket approvals from the start of the code slush until the
      start of the <code class="literal">RC</code> builds.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">In order to keep track of blanket approvals, the FreeBSD Release Engineering Team
	uses an internal repository to keep a running log of such
	requests, which defines the area upon which a blanket approval
	was granted, the author(s), when the blanket approval expires,
	and the reason the approval was granted.  One example of this
	is granting blanket approval to <code class="filename">release/doc/</code> to all FreeBSD Release Engineering Team
	members until the final <code class="literal">RC</code> to update the
	release notes and other release-related documentation.</p></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The FreeBSD Release Engineering Team also uses this repository to track pending
	approval requests that are received just prior to starting
	various builds during the release cycle, which the Release
	Engineer specifies the cutoff period with an email to the FreeBSD
	developers.</p></div><p>Depending on the underlying set of code in question, and
      the overall impact the set of code has on FreeBSD as a whole, such
      requests may be approved or denied by the FreeBSD Release Engineering Team.</p><p>The same applies to work-in-progress extensions.  For
      example, in-progress work for a new device driver that is
      otherwise isolated from the rest of the tree may be granted
      an extension.  A new scheduler, however, may not be feasible,
      especially if such dramatic changes do not exist in another
      branch.</p><p>The schedule is also added to the Project website, in the
      <code class="literal">doc/</code> repository, in
      <code class="filename">head/en_US.ISO8859-1/htdocs/releases/<em class="replaceable"><code>12.0</code></em>R/schedule.xml</code>.
      This file is continuously updated as the release cycle
      progresses.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">In most cases, the <code class="filename">schedule.xml</code> can
	be copied from a prior release and updated accordingly.</p></div><p>In addition to adding <code class="filename">schedule.xml</code> to
      the website, <code class="filename">head/share/xml/navibar.ent</code> and
      <code class="filename">head/share/xml/release.ent</code> are also updated
      to add the link to the schedule to various subpages, as well as
      enabling the link to the schedule on the Project website index
      page.</p><p>The schedule is also linked from
      <code class="filename">head/en_US.ISO8859-1/htdocs/releng/index.xml</code>.</p><p>Approximately one month prior to the scheduled <span class="quote">&#8220;<span class="quote">code
	slush</span>&#8221;</span>, the FreeBSD Release Engineering Team sends a reminder email to the
      FreeBSD Developers.</p><p>Once the first builds of the release cycle are available,
      update the <code class="literal">beta.local.where</code> entity in
      <code class="filename">head/en_US.ISO8859-1/htdocs/releases/<em class="replaceable"><code>12.0</code></em>R/schedule.xml</code>.
      replacing <code class="literal">IGNORE</code> with
      <code class="literal">INCLUDE</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">If two parallel release cycles are happening at once, the
	<code class="literal">beta2.local.where</code> entity may be used
	instead.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-terms"></a>3. Release Engineering Terminology</h2></div></div></div><p>This section describes some of the terminology used throughout
    the rest of this document.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-terms-code-slush"></a>3.1. The Code Slush</h3></div></div></div><p>Although the code slush is not a hard freeze on the tree,
      the FreeBSD Release Engineering Team requests that bugs in the existing code base take
      priority over new features.</p><p>The code slush does not enforce commit approvals to the
      branch.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-terms-code-freeze"></a>3.2. The Code Freeze</h3></div></div></div><p>The code freeze marks the point in time where all commits to
      the branch require explicit approval from the FreeBSD Release Engineering Team.</p><p>The FreeBSD <span class="application">Subversion</span> repository
      contains several hooks to perform sanity checks before any
      commit is actually committed to the tree.  One of these hooks
      will evaluate if committing to a particular branch requires
      specific approval.</p><p>To enforce commit approvals by the FreeBSD Release Engineering Team, the Release
      Engineer updates
      <code class="filename">base/svnadmin/conf/approvers</code>, and commits
      the change back to the repository.  Once this is done, any
      change to the branch must include an <span class="quote">&#8220;<span class="quote">Approved by:</span>&#8221;</span>
      line in the commit message.</p><p>The <span class="quote">&#8220;<span class="quote">Approved by:</span>&#8221;</span> line must match the second
      column in <code class="filename">base/svnadmin/conf/approvers</code>,
      otherwise the commit will be rejected by the repository
      hooks.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">During the code freeze, FreeBSD committers are urged to
	follow the <a class="link" href="https://wiki.freebsd.org/Releng/ChangeRequestGuidelines" target="_top">Change
	  Request Guidelines</a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-terms-kbi-freeze"></a>3.3. The <acronym class="acronym">KBI</acronym>/<acronym class="acronym">KPI</acronym>
      Freeze</h3></div></div></div><p><acronym class="acronym">KBI</acronym>/<acronym class="acronym">KPI</acronym> stability
      implies that the caller of a function across two different
      releases of software that implement the function results in the
      same end state.  The caller, whether it is a process, thread, or
      function, expects the function to operate in a certain way,
      otherwise the <acronym class="acronym">KBI</acronym>/<acronym class="acronym">KPI</acronym>
      stability on the branch is broken.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-website"></a>4. Website Changes During the Release Cycle</h2></div></div></div><p>This section describes the changes to the website that should
    occur as the release cycle progresses.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The files specified throughout this section are relative to
      the <code class="literal">head/</code> branch of the
      <code class="literal">doc</code> repository in
      <span class="application">Subversion</span>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-website-prerelease"></a>4.1. Website Changes Before the Release Cycle Begins</h3></div></div></div><p>When the release cycle schedule is available, these files
      need to be updated to enable various different functionalities
      on the FreeBSD Project website:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File to Edit</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">share/xml/release.ent</code></td><td>Change <code class="literal">beta.upcoming</code>
	      from <code class="literal">IGNORE</code> to
	      <code class="literal">INCLUDE</code></td></tr><tr><td><code class="filename">share/xml/release.ent</code></td><td>Change <code class="literal">% beta.upcoming</code>
	      from <code class="literal">IGNORE</code> to
	      <code class="literal">INCLUDE</code></td></tr><tr><td><code class="filename">share/xml/release.ent</code></td><td>Change <code class="literal">beta.testing</code>
	      from <code class="literal">IGNORE</code> to
	      <code class="literal">INCLUDE</code></td></tr><tr><td><code class="filename">share/xml/release.ent</code></td><td>Change <code class="literal">% beta.testing</code>
	      from <code class="literal">IGNORE</code> to
	      <code class="literal">INCLUDE</code></td></tr></tbody></table></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-website-beta-rc"></a>4.2. Website Changes During <code class="literal">BETA</code> or
      <code class="literal">RC</code></h3></div></div></div><p>When transitioning from <code class="literal">PRERELEASE</code> to
      <code class="literal">BETA</code>, these files need to be updated to
      enable the "Help Test" block on the download page.
      All files are relative to <code class="filename">head/</code> in the
      <code class="literal">doc</code> repository:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File to Edit</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">en_US.ISO8859-1/htdocs/releases/12.0R/schedule.xml</code></td><td>Change <code class="literal">% beta.local.where</code>
	      <code class="literal">IGNORE</code> to
	      <code class="literal">INCLUDE</code></td></tr><tr><td><code class="filename">share/xml/release.ent</code></td><td>Update <code class="literal">% betarel.vers</code> to
	      <code class="literal">BETA<em class="replaceable"><code>1</code></em></code></td></tr><tr><td><code class="filename">share/xml/news.xml</code></td><td>Add an entry announcing the
	      <code class="literal">BETA</code></td></tr><tr><td><code class="filename">en_US.ISO8859-1/htdocs/security/advisory-template.txt</code></td><td>Add the new <code class="literal">BETA</code>,
	      <code class="literal">RC</code>, or final
	      <code class="literal">RELEASE</code> to the template</td></tr><tr><td><code class="filename">en_US.ISO8859-1/htdocs/security/errata-template.txt</code></td><td>Add the new <code class="literal">BETA</code>,
	      <code class="literal">RC</code>, or final
	      <code class="literal">RELEASE</code> to the template</td></tr></tbody></table></div><p>Once the <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code> branch is created, the various
      release-related documents need to be generated and manually
      added to the <code class="literal">doc/</code> repository.</p><p>Within <code class="filename">release/doc</code>,
      invoke <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> to generate
      <code class="filename">errata.html</code>,
      <code class="filename">hardware.html</code>,
      <code class="filename">readme.html</code>, and
      <code class="filename">relnotes.html</code> pages, which are then added
      to <code class="filename">doc/head/en_US.ISO8859-1/htdocs/releases/<em class="replaceable"><code>X.Y</code></em>R/</code>,
      where <em class="replaceable"><code>X.Y</code></em> represents the major and
      minor version number of the release.</p><p>The <code class="literal">fbsd:nokeywords</code> property must be set
      to <code class="literal">on</code> on the newly-added files before the
      pre-commit hooks will allow them to be added to the
      repository.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The relevant release-related documents exist in the
	<code class="filename">doc</code> repository for
	FreeBSD 12.x and later.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-ports-beta-rc"></a>4.3. Ports Changes During <code class="literal">BETA</code>,
      <code class="literal">RC</code>, and the Final
      <code class="literal">RELEASE</code></h3></div></div></div><p>For each build during the release cycle, the
      <code class="literal">MANIFEST</code> files containing the
      <code class="literal">SHA256</code> of the various distribution sets, such
      as <code class="literal">base.txz</code>, <code class="literal">kernel.txz</code>,
      and so on, are added to the
      <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/misc/freebsd-release-manifests/pkg-descr">misc/freebsd-release-manifests</a> port.  This
      allows utilities other than <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">bsdinstall</span>(8)</span></a>, such as
      <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/ports-mgmt/poudriere/pkg-descr">ports-mgmt/poudriere</a>, to safely use these
      distribution sets by providing a mechanism through which the
      checksums can be verified.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-head"></a>5. Release from <code class="literal">head/</code></h2></div></div></div><p>This section describes the general procedures of the FreeBSD
    release cycle from the <code class="literal">head/</code> branch.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-head-builds-alpha"></a>5.1. FreeBSD <span class="quote">&#8220;<span class="quote"><code class="literal">ALPHA</code></span>&#8221;</span> Builds</h3></div></div></div><p>Starting with the FreeBSD 10.0-RELEASE cycle, the notion
      of <span class="quote">&#8220;<span class="quote"><code class="literal">ALPHA</code></span>&#8221;</span> builds was
      introduced.  Unlike the <code class="literal">BETA</code> and
      <code class="literal">RC</code> builds, <code class="literal">ALPHA</code> builds
      are not included in the FreeBSD Release schedule.</p><p>The idea behind <code class="literal">ALPHA</code> builds is to
      provide regular FreeBSD-provided builds before the creation of the
      <code class="literal">stable/</code> branch.</p><p>FreeBSD <code class="literal">ALPHA</code> snapshots should be built
      approximately once a week.</p><p>For the first <code class="literal">ALPHA</code> build, the
      <code class="varname">BRANCH</code> value in
      <code class="filename">sys/conf/newvers.sh</code> needs to be changed
      from <code class="literal">CURRENT</code> to <code class="literal">ALPHA1</code>.
      For subsequent <code class="literal">ALPHA</code> builds, increment each
      <code class="literal">ALPHA<em class="replaceable"><code>N</code></em></code> value by
      one.</p><p>See <a class="xref" href="#releng-building" title="7. Building FreeBSD Installation Media">Section 7, &#8220;Building FreeBSD Installation Media&#8221;</a> for information on
      building the <code class="literal">ALPHA</code> images.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-head-branching"></a>5.2. Creating the <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> Branch</h3></div></div></div><p>When creating the <code class="literal">stable/</code> branch, several changes
      are required in both the new <code class="literal">stable/</code> branch and the
      <code class="literal">head/</code> branch.  The files listed are relative to the
      repository root.  To create the new <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> branch
      in Subversion:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn cp ^/head <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code></code></strong></pre><p>Once the <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> branch has been committed, make
      the following edits:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File to Edit</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/UPDATING</code></td><td>Update the FreeBSD version, and remove the notice
	      about <code class="literal">WITNESS</code></td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/contrib/jemalloc/include/jemalloc/jemalloc_FreeBSD.h</code></td><td><pre class="screen">#ifndef MALLOC_PRODUCTION
#define MALLOC_PRODUCTION
#endif</pre></td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/lib/clang/llvm.build.mk</code></td><td>Uncomment <code class="literal">-DNDEBUG</code></td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/sys/*/conf/GENERIC*</code></td><td>Remove debugging support</td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/sys/*/conf/MINIMAL</code></td><td>Remove debugging support</td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/release/release.conf.sample</code></td><td>Update <code class="varname">SRCBRANCH</code></td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/sys/*/conf/GENERIC-NODEBUG</code></td><td>Remove these kernel configurations</td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/sys/arm/conf/std.arm*</code></td><td>Remove debugging options</td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/sys/conf/newvers.sh</code></td><td>Update the <code class="varname">BRANCH</code> value to
	      reflect <code class="literal">BETA1</code></td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/share/mk/src.opts.mk</code></td><td>Move <code class="varname">REPRODUCIBLE_BUILD</code> from
	      <code class="literal">__DEFAULT_NO_OPTIONS</code> to
	      <code class="literal">__DEFAULT_YES_OPTIONS</code></td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/share/mk/src.opts.mk</code></td><td>Move <code class="varname">LLVM_ASSERTIONS</code> from
	      <code class="literal">__DEFAULT_YES_OPTIONS</code> to
	      <code class="literal">__DEFAULT_NO_OPTIONS</code> (FreeBSD 13.x
		and later only)</td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/libexec/rc/rc.conf</code></td><td>Set <code class="literal">dumpdev</code> from
	      <code class="literal">AUTO</code> to <code class="literal">NO</code> (it is
	      configurable via <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">bsdinstall</span>(8)</span></a> for those that want
	      it enabled by default)</td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/release/Makefile</code></td><td>Remove the
	      <code class="literal">debug.witness.trace</code> entries</td></tr></tbody></table></div><p>Then in the <code class="literal">head/</code> branch, which will now become
      a new major version:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File to Edit</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">head/UPDATING</code></td><td>Update the FreeBSD version</td></tr><tr><td><code class="filename">head/sys/conf/newvers.sh</code></td><td>Update the <code class="varname">BRANCH</code> value to
	      reflect <code class="literal">CURRENT</code>, and increment
	      <code class="literal">REVISION</code></td></tr><tr><td><code class="filename">head/Makefile.inc1</code></td><td>Update <code class="literal">TARGET_TRIPLE</code> and
	      <code class="literal">MACHINE_TRIPLE</code></td></tr><tr><td><code class="filename">head/sys/sys/param.h</code></td><td>Update <code class="literal">__FreeBSD_version</code></td></tr><tr><td><code class="filename">head/gnu/usr.bin/cc/cc_tools/freebsd-native.h</code></td><td>Update <code class="literal">FBSD_MAJOR</code> and
	      <code class="literal">FBSD_CC_VER</code></td></tr><tr><td><code class="filename">head/contrib/gcc/config.gcc</code></td><td>Append the
	      <code class="literal">freebsd&lt;version&gt;.h</code>
	      section</td></tr><tr><td><code class="filename">head/lib/clang/llvm.build.mk</code></td><td>Update the value of
	      <code class="literal">OS_VERSION</code></td></tr><tr><td><code class="filename">head/lib/clang/freebsd_cc_version.h</code></td><td>Update
	      <code class="literal">FREEBSD_CC_VERSION</code></td></tr><tr><td><code class="filename">head/lib/clang/include/lld/Common/Version.inc</code></td><td>Update
	      <code class="literal">LLD_REVISION_STRING</code></td></tr><tr><td><code class="filename">head/Makefile.libcompat</code></td><td>Update <code class="literal">LILB32CPUFLAGS</code></td></tr></tbody></table></div></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-stable"></a>6. Release from <code class="literal">stable/</code></h2></div></div></div><p>This section describes the general procedures of the FreeBSD
    release cycle from an extablished <code class="literal">stable/</code> branch.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-stable-slush"></a>6.1. FreeBSD <code class="literal">stable</code> Branch Code Slush</h3></div></div></div><p>In preparation for the code freeze on
      a <code class="literal">stable</code> branch, several files need to be
      updated to reflect the release cycle is officially in
      progress.  These files are all relative to the top-most level of
      the stable branch:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File to Edit</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">sys/conf/newvers.sh</code></td><td>Update the <code class="varname">BRANCH</code> value to
	      reflect <code class="literal">PRERELEASE</code></td></tr><tr><td><code class="filename">Makefile.inc1</code></td><td>Update <code class="varname">TARGET_TRIPLE</code></td></tr><tr><td><code class="filename">lib/clang/llvm.build.mk</code></td><td>Update <code class="varname">OS_VERSION</code></td></tr><tr><td><code class="filename">Makefile.libcompat</code></td><td>Update <code class="literal">LIB32CPUFLAGS</code></td></tr><tr><td><code class="filename">gnu/usr.bin/groff/tmac/mdoc.local.in</code></td><td>Add a new <code class="literal">.ds</code> entry for the FreeBSD
	      version, and update
	      <code class="varname">doc-default-operating-system</code>
	      (FreeBSD 11.x and earlier only)</td></tr></tbody></table></div><p>In the <code class="literal">doc</code> repository, also update
      <code class="filename">head/en_US.ISO8859-1/htdocs/releases/<em class="replaceable"><code>12.0</code></em>R/Makefile.hardware</code>,
      switching the value of <code class="varname">_BRANCH</code> to
      <code class="literal">BETA<em class="replaceable"><code>X</code></em></code>,
      <code class="literal">RC<em class="replaceable"><code>X</code></em></code>, or
      <code class="literal">RELEASE</code>, respectively.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-stable-builds-beta"></a>6.2. FreeBSD <code class="literal">BETA</code> Builds</h3></div></div></div><p>Following the code slush, the next phase of the release
      cycle is the code freeze.  This is the point at which all
      commits to the stable branch require explicit approval from
      the FreeBSD Release Engineering Team.  This is enforced by pre-commit hooks in the
      Subversion repository by editing
      <code class="filename">base/svnadmin/conf/approvers</code> to include
      a regular expression matching the <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> branch for
      the release:</p><pre class="programlisting">^/<code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code>	re
^/<code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code>	re</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">There are two general exceptions to requiring commit
	approval during the release cycle.  The first is any change
	that needs to be committed by the Release Engineer in order
	to proceed with the day-to-day workflow of the release cycle,
	the other is security fixes that may occur during the release
	cycle.</p></div><p>Once the code freeze is in effect, the next build from the
      branch is labeled <code class="literal">BETA1</code>.  This is done by
      updating the <code class="varname">BRANCH</code> value in
      <code class="filename">sys/conf/newvers.sh</code> from
      <code class="literal">PRERELEASE</code> to
      <code class="literal">BETA1</code>.</p><p>Once this is done, the first set of <code class="literal">BETA</code>
      builds are started.  Subsequent <code class="literal">BETA</code> builds
      do not require updates to any files other than
      <code class="filename">sys/conf/newvers.sh</code>, incrementing the
      <code class="literal">BETA</code> build number.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-stable-branching"></a>6.3. Creating the <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code> Branch</h3></div></div></div><p>When the first <code class="literal">RC</code> (Release Candidate)
      build is ready to begin, the <code class="literal">releng/</code> branch is created.
      This is a multi-step process that must be done in a specific
      order, in order to avoid anomalies such as overlaps with
      <code class="varname">__FreeBSD_version</code> values, for example.  The
      paths listed below are relative to the repository root.  The
      order of commits and what to change are:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn cp ^/<code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code></code></strong></pre><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File to Edit</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">releng/<em class="replaceable"><code>12.0</code></em>/sys/conf/newvers.sh</code></td><td>Change
	      <code class="literal">BETA<em class="replaceable"><code>X</code></em></code>
	      to <code class="literal">RC1</code></td></tr><tr><td><code class="filename">releng/<em class="replaceable"><code>12.0</code></em>/sys/sys/param.h</code></td><td>Update <code class="varname">__FreeBSD_version</code></td></tr><tr><td><code class="filename">releng/<em class="replaceable"><code>12.0</code></em>/etc/pkg/FreeBSD.conf</code></td><td>Replace <code class="literal">latest</code> with
	      <code class="literal">quarterly</code> as the default package
	      repository location</td></tr><tr><td><code class="filename">releng/<em class="replaceable"><code>12.0</code></em>/release/pkg_repos/release-dvd.conf</code></td><td>Replace <code class="literal">latest</code> with
	      <code class="literal">quarterly</code> as the default package
	      repository location</td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/sys/conf/newvers.sh</code></td><td>Update
	      <code class="literal">BETA<em class="replaceable"><code>X</code></em></code> with
	      <code class="literal">PRERELEASE</code></td></tr><tr><td><code class="filename">stable/<em class="replaceable"><code>12</code></em>/sys/sys/param.h</code></td><td>Update <code class="varname">__FreeBSD_version</code></td></tr><tr><td><code class="filename">svnadmin/conf/approvers</code></td><td>Add a new approvers line for the releng
	      branch as was done for the stable branch</td></tr></tbody></table></div><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn propdel -R svn:mergeinfo <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn commit <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn commit <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code></code></strong></pre><p>Now that two new <code class="varname">__FreeBSD_version</code> values
      exist, also update
      <code class="filename">head/en_US.ISO8859-1/books/porters-handbook/versions/chapter.xml</code>
      in the Documentation Project repository.</p><p>After the first <code class="literal">RC</code> build has completed
      and tested, the <code class="literal">stable/</code> branch can be
      <span class="quote">&#8220;<span class="quote">thawed</span>&#8221;</span> by removing (or commenting) the
      ^/<code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> entry in
      <code class="filename">svnadmin/conf/approvers</code>.</p><p>Following the availability of the first
      <code class="literal">RC</code>, FreeBSD Bugmeister Team should be emailed to
      add the new FreeBSD <code class="literal">-RELEASE</code> to the
      <code class="literal">versions</code> available in the drop-down menu
      shown in the bug tracker.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-building"></a>7. Building FreeBSD Installation Media</h2></div></div></div><p>This section describes the general procedures producing FreeBSD
    development snapshots and releases.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-build-scripts"></a>7.1. Release Build Scripts</h3></div></div></div><p>This section describes the build scripts used by FreeBSD Release Engineering Team
      to produce development snapshots and releases.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-build-scripts-single"></a>7.1.1. The <code class="filename">release.sh</code> Script</h4></div></div></div><p>Prior to FreeBSD 9.0-RELEASE,
	<code class="filename">src/release/Makefile</code> was updated to
	support <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">bsdinstall</span>(8)</span></a>, and the
	<code class="filename">src/release/generate-release.sh</code> script
	was introduced as a wrapper to automate invoking the
	<a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=release&amp;sektion=7&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">release</span>(7)</span></a> targets.</p><p>Prior to FreeBSD 9.2-RELEASE,
	<code class="filename">src/release/release.sh</code> was introduced,
	which heavily based on
	<code class="filename">src/release/generate-release.sh</code> included
	support to specify configuration files to override various
	options and environment variables.  Support for configuration
	files provided support for cross building each architecture
	for a release by specifying a separate configuration file for
	each invocation.</p><p>As a brief example of using
	<code class="filename">src/release/release.sh</code> to build a single
	release in <code class="filename">/scratch</code>:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/bin/sh /usr/src/release/release.sh</code></strong></pre><p>As a brief example of using
	<code class="filename">src/release/release.sh</code> to build a single,
	cross-built release using a different target directory, create
	a custom <code class="filename">release.conf</code> containing:</p><pre class="programlisting"># release.sh configuration for powerpc/powerpc64
CHROOTDIR="/scratch-powerpc64"
TARGET="powerpc"
TARGET_ARCH="powerpc64"
KERNEL="GENERIC64"</pre><p>Then invoke <code class="filename">src/release/release.sh</code>
	as:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>/bin/sh /usr/src/release/release.sh -c <em class="replaceable"><code>$HOME/release.conf</code></em></code></strong></pre><p>See <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=release&amp;sektion=7&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">release</span>(7)</span></a> and
	<code class="filename">src/release/release.conf.sample</code> for more
	details and example usage.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-build-scripts-multiple"></a>7.1.2. The <code class="filename">thermite.sh</code> Wrapper
	Script</h4></div></div></div><p>In order to make cross building the full set of
	architectures supported on a given branch faster, easier, and
	reduce human error factors, a wrapper script around
	<code class="filename">src/release/release.sh</code> was written to
	iterate through the various combinations of architectures and
	invoke <code class="filename">src/release/release.sh</code> using
	a configuration file specific to that architecture.</p><p>The wrapper script is called
	<code class="filename">thermite.sh</code>, which is available in the
	FreeBSD Subversion repository at
	<code class="literal">svn://svn.freebsd.org/base/user/gjb/thermite/</code>,
	in addition to configuration files used to build
	<code class="literal">head/</code> and <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> development
	snapshots.</p><p>Using <code class="filename">thermite.sh</code> is covered in <a class="xref" href="#releng-build-snapshot" title="7.2. Building FreeBSD Development Snapshots">Section 7.2, &#8220;Building FreeBSD Development Snapshots&#8221;</a> and <a class="xref" href="#releng-build-release" title="7.3. Building FreeBSD Releases">Section 7.3, &#8220;Building FreeBSD Releases&#8221;</a>.</p><p>Each architecture and individual kernel have their own
	configuration file used by <code class="filename">release.sh</code>.
	Each branch has its own <code class="filename">defaults-X.conf</code>
	configuration which contains entries common throughout each
	architecture, where overrides or special variables are set
	and/or overridden in the per-build files.</p><p>The per-build configuration file naming scheme is in the
	form of
	<code class="filename">${revision}-${TARGET_ARCH}-${KERNCONF}-${type}.conf</code>,
	where the uppercase variables are equivalent to what
	<a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> uses in the build system, and lowercase variables
	are set within the configuration files, mapping to the major
	version of the respective branch.</p><p>Each branch also has its own
	<code class="filename">builds-X.conf</code> configuration, which is
	used by <code class="filename">thermite.sh</code>.  The
	<code class="filename">thermite.sh</code> script iterates through each
	${revision}, ${TARGET_ARCH},
	${KERNCONF}, and ${type} value, creating
	a master list of what to build.  However, a given
	combination from the list will only be built if the
	respective configuration file exists, which is where the
	naming scheme above is relevant.</p><p>There are two paths of file sourcing:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">builds-<em class="replaceable"><code>12</code></em>.conf</code>
	    -&gt; <code class="filename">main.conf</code></p><p>This controls <code class="filename">thermite.sh</code>
	    behavior</p></li><li class="listitem"><p><code class="filename"><em class="replaceable"><code>12</code></em>-<em class="replaceable"><code>amd64</code></em>-<em class="replaceable"><code>GENERIC</code></em>-<em class="replaceable"><code>snap</code></em>.conf</code>
	    -&gt;
	    <code class="filename">defaults-<em class="replaceable"><code>12</code></em>.conf</code>
	    -&gt; <code class="filename">main.conf</code></p><p>This controls <code class="filename">release/release.sh</code>
	    behavior within the build <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chroot</span>(8)</span></a></p></li></ul></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The
	  <code class="filename">builds-<em class="replaceable"><code>12</code></em>.conf</code>,
	  <code class="filename">defaults-<em class="replaceable"><code>12</code></em>.conf</code>,
	  and <code class="filename">main.conf</code> configuration files exist
	  to reduce repetition between the various per-build
	  files.</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-build-snapshot"></a>7.2. Building FreeBSD Development Snapshots</h3></div></div></div><p>The official release build machines have a specific
      filesystem layout, which using <acronym class="acronym">ZFS</acronym>,
      <code class="filename">thermite.sh</code> takes heavy advantage of with
      clones and snapshots, ensuring a pristine build
      environment.</p><p>The build scripts reside in <code class="filename">/releng/scripts-snapshot/scripts</code>
      or <code class="filename">/releng/scripts-release/scripts</code>
      respectively, to avoid collisions between an
      <code class="literal">RC</code> build from a releng branch versus
      a <code class="literal">STABLE</code> snapshot from the respective stable
      branch.</p><p>A separate dataset exists for the final build images,
      <code class="filename">/snap/ftp</code>.  This
      directory contains both snapshots and releases directories.
      They are only used if the <code class="literal">EVERYTHINGISFINE</code>
      variable is defined in <code class="filename">main.conf</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The <code class="literal">EVERYTHINGISFINE</code> variable name was
	chosen to avoid colliding with a variable that might be
	possibly set in the user environment, accidentally enabling
	the behavior that depends on it being defined.</p></div><p>As <code class="filename">thermite.sh</code> iterates through the
      master list of combinations and locates the per-build
      configuration file, a <acronym class="acronym">ZFS</acronym> dataset is created
      under <code class="filename">/releng</code>, such as
      <code class="filename">/releng/12-amd64-GENERIC-snap</code>.
      The <code class="literal">src/</code>, <code class="literal">ports/</code>, and
      <code class="literal">doc/</code> trees are checked out to separate
      <acronym class="acronym">ZFS</acronym> datasets, such as <code class="filename">/releng/12-src-snap</code>, which are
      then cloned and mounted into the respective build datasets.
      This is done to avoid checking out a given tree more than
      once.</p><p>Assuming these filesystem paths,
      <code class="filename">thermite.sh</code> would be invoked as:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /releng/scripts-snapshot/scripts</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./setrev.sh -b <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./zfs-cleanup.sh -c ./builds-<em class="replaceable"><code>12</code></em>.conf</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./thermite.sh -c ./builds-<em class="replaceable"><code>12</code></em>.conf</code></strong></pre><p>Once the builds have completed, additional helper scripts
      are available to generate development snapshot emails which are
      sent to the <code class="literal">freebsd-snapshots@freebsd.org</code>
      mailing list:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /releng/scripts-snapshot/scripts</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>./get-checksums.sh -c ./builds-<em class="replaceable"><code>12</code></em>.conf | ./generate-email.pl &gt; snapshot-<em class="replaceable"><code>12</code></em>-mail</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The generated output should be double-checked for
	correctness, and the email itself should be PGP signed,
	in-line.</p></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">These helper scripts only apply to development snapshot
	builds.  Announcements during the release cycle (excluding the
	final release announcement) are created from an email
	template.  A sample of the email template currently used can
	be found <a class="link" href="https://svn.freebsd.org/base/user/gjb/thermite/non-release-template-mail.txt" target="_top">here</a>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-build-release"></a>7.3. Building FreeBSD Releases</h3></div></div></div><p>Similar to building FreeBSD development snapshots,
      <code class="filename">thermite.sh</code> would be invoked the same way.
      The difference between development snapshots and release builds,
      <code class="literal">BETA</code> and <code class="literal">RC</code> included, is
      that the <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chroot</span>(8)</span></a> configuration files must be named with
      <code class="literal">release</code> instead of <code class="literal">snap</code> as
      the "type", as mentioned above.</p><p>In addition, the <code class="literal">BUILDTYPE</code> and
      <code class="literal">types</code> must be changed from
      <code class="literal">snap</code> to <code class="literal">release</code> in
      <code class="filename">defaults-<em class="replaceable"><code>12</code></em>.conf</code>
      and
      <code class="filename">builds-<em class="replaceable"><code>12</code></em>.conf</code>,
      respectively.</p><p>When building <code class="literal">BETA</code>,
      <code class="literal">RC</code>, and the final <code class="literal">RELEASE</code>,
      also statically set <code class="literal">BUILDSVNREV</code> to the
      revision on the branch reflecting the name change,
      <code class="literal">BUILDDATE</code> to the date the builds are started
      in <code class="literal">YYYYMMDD</code> format.  If the
      <code class="literal">doc/</code> and <code class="literal">ports/</code> trees have
      been tagged, also set <code class="literal">PORTBRANCH</code> and
      <code class="literal">DOCBRANCH</code> to the relevant tag path in the
      Subversion repository, replacing <code class="literal">HEAD</code> with
      the last changed revision.  Also set
      <code class="literal">releasesrc</code> in
      <code class="filename">builds-<em class="replaceable"><code>12</code></em>.conf</code>
      to the relevant branch, such as <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> or
      <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code>.</p><p>During the release cycle, a copy of
      <code class="filename">CHECKSUM.SHA512</code> and
      <code class="filename">CHECKSUM.SHA256</code> for each architecture are
      stored in the FreeBSD Release Engineering Team internal repository in addition to being
      included in the various announcement emails.  Each
      <code class="filename">MANIFEST</code> containing the hashes of
      <code class="filename">base.txz</code>, <code class="filename">kernel.txz</code>,
      etc. are added to
      <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/misc/freebsd-release-manifests/pkg-descr">misc/freebsd-release-manifests</a> in the Ports
      Collection, as well.</p><p>In preparation for the release build, several files need to
      be updated:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File to Edit</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">sys/conf/newvers.sh</code></td><td>Update the <code class="varname">BRANCH</code> value to
	      <code class="literal">RELEASE</code></td></tr><tr><td><code class="filename">UPDATING</code></td><td>Add the anticipated announcement date</td></tr><tr><td><code class="filename">lib/csu/common/crtbrand.c</code></td><td>Replace <code class="literal">__FreeBSD_version</code> with
	      the value in
	      <code class="filename">sys/sys/param.h</code></td></tr></tbody></table></div><p>After building the final <code class="literal">RELEASE</code>, the
      <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code> branch is tagged as <code class="literal">release/<em class="replaceable"><code>12.0.0</code></em>/</code> using the
      revision from which the <code class="literal">RELEASE</code> was built.
      Similar to creating the <code class="literal">stable/<em class="replaceable"><code>12</code></em>/</code> and <code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code>
      branches, this is done with <code class="command">svn cp</code>.  From the
      repository root:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn cp ^/<code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code>@r<em class="replaceable"><code>306420</code></em> <code class="literal">release/<em class="replaceable"><code>12.0.0</code></em>/</code></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn commit <code class="literal">release/<em class="replaceable"><code>12.0.0</code></em>/</code></code></strong></pre></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-mirrors"></a>8. Publishing FreeBSD Installation Media to Project Mirrors</h2></div></div></div><p>This section describes the procedure to publish FreeBSD
    development snapshots and releases to the Project mirrors.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-mirrors-staging"></a>8.1. Staging FreeBSD Installation Media Images</h3></div></div></div><p>Staging FreeBSD snapshots and releases is a two part
      process:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Creating the directory structure to match the hierarchy
	  on <code class="systemitem">ftp-master</code></p><p>If <code class="literal">EVERYTHINGISFINE</code> is defined in the
	  build configuration files, <code class="filename">main.conf</code> in
	  the case of the build scripts referenced above, this happens
	  automatically in the <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chroot</span>(8)</span></a> after the build is
	  complete, creating the directory structure in <code class="filename">${DESTDIR}/R/ftp-stage</code>
	  with a path structure matching what is expected on
	  <code class="systemitem">ftp-master</code>.  This is equivalent to
	  running the following in the <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chroot</span>(8)</span></a> directly:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>make -C /usr/src/release -f Makefile.mirrors EVERYTHINGISFINE=1 ftp-stage</code></strong></pre><p>After each architecture is built,
	  <code class="filename">thermite.sh</code> will
	  <span class="application">rsync</span> the <code class="filename">${DESTDIR}/R/ftp-stage</code>
	  from the build <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chroot</span>(8)</span></a> to <code class="filename">/snap/ftp/snapshots</code> or
	  <code class="filename">/snap/ftp/releases</code> on
	  the build host, respectively.</p></li><li class="listitem"><p>Copying the files to a staging directory on
	  <code class="systemitem">ftp-master</code> before moving the files
	  into <code class="filename">pub/</code> to begin
	  propagation to the Project mirrors</p><p>Once all builds have finished, <code class="filename">/snap/ftp/snapshots</code>, or
	  <code class="filename">/snap/ftp/releases</code>
	  for a release, is polled by
	  <code class="systemitem">ftp-master</code> using
	  <span class="application">rsync</span> to <code class="filename">/archive/tmp/snapshots</code> or
	  <code class="filename">/archive/tmp/releases</code>,
	  respectively.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">On <code class="systemitem">ftp-master</code> in the FreeBSD
	    Project infrastructure, this step requires
	    <code class="literal">root</code> level access, as this step must
	    be executed as the <code class="literal">archive</code> user.</p></div></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-mirrors-publishing"></a>8.2. Publishing FreeBSD Installation Media</h3></div></div></div><p>Once the images are staged in <code class="filename">/archive/tmp/</code>, they are ready to
      be made public by putting them in <code class="filename">/archive/pub/FreeBSD</code>.  In order
      to reduce propagation time, <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">pax</span>(1)</span></a> is used to create hard
      links from <code class="filename">/archive/tmp</code>
      to <code class="filename">/archive/pub/FreeBSD</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">In order for this to be effective, both <code class="filename">/archive/tmp</code> and <code class="filename">/archive/pub</code> must reside on the
	same logical filesystem.</p></div><p>There is a caveat, however, where
      <span class="application">rsync</span> must be used after <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">pax</span>(1)</span></a>
      in order to correct the symbolic links in <code class="filename">pub/FreeBSD/<em class="replaceable"><code>snapshots</code></em>/ISO-IMAGES</code>
      which <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">pax</span>(1)</span></a> will replace with a hard link, increasing the
      propagation time.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">As with the staging steps, this requires
	<code class="literal">root</code> level access, as this step must be
	executed as the <code class="literal">archive</code> user.</p></div><p>As the <code class="literal">archive</code> user:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cd /archive/tmp/<em class="replaceable"><code>snapshots</code></em></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>pax -r -w -l . /archive/pub/FreeBSD/<em class="replaceable"><code>snapshots</code></em></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>/usr/local/bin/rsync -avH /archive/tmp/<em class="replaceable"><code>snapshots</code></em>/* /archive/pub/FreeBSD/<em class="replaceable"><code>snapshots</code></em>/</code></strong></pre><p>Replace <em class="replaceable"><code>snapshots</code></em> with
      <em class="replaceable"><code>releases</code></em> as appropriate.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-wrapup"></a>9. Wrapping up the Release Cycle</h2></div></div></div><p>This section describes general post-release tasks.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-wrapup-en"></a>9.1. Post-Release Errata Notices</h3></div></div></div><p>As the release cycle approaches conclusion, it is common
	to have several <acronym class="acronym">EN</acronym> (Errata Notice)
	candidates to address issues that were discovered late in the
	cycle.  Following the release, the FreeBSD Release Engineering Team and the
	FreeBSD Security Team revisit changes that were not approved prior to
	the final release, and depending on the scope of the change in
	question, may issue an <acronym class="acronym">EN</acronym>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The actual process of issuing <acronym class="acronym">EN</acronym>s is
	  handled by the FreeBSD Security Team.</p></div><p>To request an Errata Notice after a release cycle has
	completed, a developer should fill out the <a class="link" href="https://www.freebsd.org/security/errata-template.txt" target="_top">Errata
	  Notice template</a>, in particular the
	<code class="literal">Background</code>, <code class="literal">Problem
	  Description</code>, <code class="literal">Impact</code>, and if
	applicable, <code class="literal">Workaround</code> sections.</p><p>The completed Errata Notice template should be emailed
	together with either a patch against the <code class="literal">releng/</code>
	branch or a list of revisions from the <code class="literal">stable/</code>
	branch.</p><p>For Errata Notice requests immediately following the
	release, the request should be emailed to both the FreeBSD Release Engineering Team and
	the FreeBSD Security Team.  Once the <code class="literal">releng/</code> branch has been
	handed over to the FreeBSD Security Team as described in <a class="xref" href="#releng-wrapup-handoff" title="9.2. Handoff to the FreeBSD Security Team">Section 9.2, &#8220;Handoff to the FreeBSD Security Team&#8221;</a>, Errata Notice requests
	should be sent to the FreeBSD Security Team.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-wrapup-handoff"></a>9.2. Handoff to the FreeBSD Security Team</h3></div></div></div><p>Roughly two weeks following the release, the Release
	Engineer updates <code class="filename">svnadmin/conf/approvers</code>
	changing the approver column from <code class="literal">re</code> to
	<code class="literal">(so|security-officer)</code> for the
	<code class="literal">releng/<em class="replaceable"><code>12.0</code></em>/</code> branch.</p></div></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="releng-eol"></a>10. Release End-of-Life</h2></div></div></div><p>This section describes the website-related files to update
      when a release reaches <acronym class="acronym">EoL</acronym>
      (End-of-Life).</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="releng-eol-website"></a>10.1. Website Updates for End-of-Life</h3></div></div></div><p>When a release reaches End-of-Life, references to that
	release should be removed and/or updated on the
	website:</p><div class="informaltable"><table class="informaltable" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>File</th><th>What to Change</th></tr></thead><tbody><tr><td><code class="filename">head/en_US.ISO8859-1/htdocs/index.xsl</code></td><td>Remove <code class="literal">&amp;u.relXXX.announce;</code>
		and <code class="literal">&amp;u.relXXX.current;</code>
		references.</td></tr><tr><td><code class="filename">head/en_US.ISO8859-1/htdocs/releases/index.xml</code></td><td>Move the &amp;u.relXXX.*; macros from the
		supported release list to the Legacy Releases
		list.</td></tr><tr><td><code class="filename">head/en_US.ISO8859-1/htdocs/releng/index.xml</code></td><td>Update the appropriate releng branch to refelect
		the branch is no longer supported.</td></tr><tr><td><code class="filename">head/en_US.ISO8859-1/htdocs/security/security.xml</code></td><td>Remove the branch from the supported branch
		list.</td></tr><tr><td><code class="filename">head/en_US.ISO8859-1/htdocs/where.xml</code></td><td>Remove the URLs for the release.</td></tr><tr><td><code class="filename">head/share/xml/navibar.ent</code></td><td>Remove <code class="literal">&amp;u.relXXX.announce;</code>
		and <code class="literal">&amp;u.relXXX.current;</code>
		references.</td></tr><tr><td><code class="filename">head/en_US.ISO8859-1/htdocs/security/advisory-template.txt</code></td><td>Remove references to the release and releng
		branch.</td></tr><tr><td><code class="filename">head/en_US.ISO8859-1/htdocs/security/errata-template.txt</code></td><td>Remove references to the release and releng
		branch.</td></tr></tbody></table></div></div></div></div></body></html>