<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>FreeBSD Support for Leap Seconds</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="article"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="leapseconds"></a>FreeBSD Support for Leap Seconds</h1></div><div>Last modified on 2017-11-30 14:49:53 +0000 by ygy.</div></div><div class="docformatnavi">
      [
      <a href="index.html">Split HTML</a>
      /
      
	  Single HTML
	
      ]
    </div><hr /></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="sect1"><a href="#leapseconds-definition">1. Introduction</a></span></dt><dt><span class="sect1"><a href="#leapseconds-posix">2. Default Leap Second Handling on FreeBSD</a></span></dt><dt><span class="sect1"><a href="#leapseconds-cautions">3. Cautions</a></span></dt><dt><span class="sect1"><a href="#leapseconds-testing">4. Testing</a></span></dt><dt><span class="sect1"><a href="#leapseconds-conclusion">5. Conclusion</a></span></dt></dl></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="leapseconds-definition"></a>1. Introduction</h2></div></div></div><p>A <span class="emphasis"><em>leap second</em></span> is an one second
      adjustment made at specific times of year to UTC to synchronize
      atomic time scales with variations in the rotation of the Earth.
      This article describes how FreeBSD interacts with leap
      seconds.</p><p>As of this writing, the next leap second will occur at
      2015-Jun-30 23:59:60 UTC.  This leap second will occur during a
      business day for North and South America and the Asia/Pacific
      region.</p><p>Leap seconds are announced by <a class="link" href="http://datacenter.iers.org/" target="_top"><acronym class="acronym">IERS</acronym></a>
      on <a class="link" href="http://datacenter.iers.org/web/guest/bulletins/-/somos/5Rgv/product/16" target="_top">Bulletin
	C</a>.</p><p>Standard leap second behavior is described in <a class="link" href="https://tools.ietf.org/html/rfc7164#section-3" target="_top">RFC
	7164</a>.  Also see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=time2posix&amp;sektion=3&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">time2posix</span>(3)</span></a>.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="leapseconds-posix"></a>2. Default Leap Second Handling on FreeBSD</h2></div></div></div><p>The easiest way to handle leap seconds is with the
      <acronym class="acronym">POSIX</acronym> time rules FreeBSD uses by default,
      combined with <a class="link" href="../../../../doc/en_US.ISO8859-1/books/handbook/network-ntp.html" target="_top"><acronym class="acronym">NTP</acronym></a>.
      When <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> is running and the time is synchronized with
      upstream <acronym class="acronym">NTP</acronym> servers that handle leap seconds
      correctly, the leap second will cause the system time to
      automatically repeat the last second of the day.  No other
      adjustments are necessary.</p><p>If the upstream <acronym class="acronym">NTP</acronym> servers do not handle
      leap seconds correctly, <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">ntpd</span>(8)</span></a> will step the time by one
      second after the errant upstream server has noticed and stepped
      itself.</p><p>If <acronym class="acronym">NTP</acronym> is not being used, manual
      adjustment of the system clock will be required after the leap
      second has passed.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="leapseconds-cautions"></a>3. Cautions</h2></div></div></div><p>Leap seconds are inserted at the same instant all over the
      world: <acronym class="acronym">UTC</acronym> midnight.  In Japan that is
      mid-morning, in the Pacific mid-day, in the Americas late
      afternoon, and in Europe at night.</p><p>We believe and expect that FreeBSD, if provided correct and
      stable <acronym class="acronym">NTP</acronym> service, will work as designed
      during this leap second, as it did during the previous
      ones.</p><p>However, we caution that practically no applications have
      ever asked the kernel about leap seconds.  Our experience is
      that, as designed, leap seconds are essentially a replay of the
      second before the leap second, and this is a surprise to most
      application programmers.</p><p>Other operating systems and other computers may or may not
      handle the leap-second the same way as FreeBSD, and systems without
      correct and stable <acronym class="acronym">NTP</acronym> service will not know
      anything about leap seconds at all.</p><p>It is not unheard of for computers to crash because of
      leap seconds, and experience has shown that a large fraction
      of all public <acronym class="acronym">NTP</acronym> servers might handle and
      announce the leap second incorrectly.</p><p>Please try to make sure nothing horrible happens because of
      the leap second.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="leapseconds-testing"></a>4. Testing</h2></div></div></div><p>It is possible to test whether a leap second will be used.
      Due to the nature of <acronym class="acronym">NTP</acronym>, the test might work
      up to 24 hours before the leap second.  Some major reference
      clock sources only announce leap seconds one hour ahead of the
      event.  Query the <acronym class="acronym">NTP</acronym> daemon:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>ntpq -c 'rv 0 leap'</code></strong></pre><p>Output that includes <code class="literal">leap_add_sec</code>
      indicates proper support of the leap second.  Before the 24
      hours leading up to the leap second, or after the leap second
      has passed, <code class="literal">leap_none</code> will be shown.</p></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="leapseconds-conclusion"></a>5. Conclusion</h2></div></div></div><p>In practice, leap seconds are usually not a problem on FreeBSD.
      We hope that this overview helps clarify what to expect and how
      to make the leap second event proceed more smoothly.</p></div></div></body></html>