<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>6.2. Building and Installing the Web Pages</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Documentation Project Primer for New Contributors" /><link rel="up" href="the-website.html" title="Chapter 6. The Website" /><link rel="prev" href="the-website.html" title="Chapter 6. The Website" /><link rel="next" href="xml-primer.html" title="Chapter 7. XML Primer" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.2. Building and Installing the Web Pages</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="the-website.html">Prev</a> </td><th width="60%" align="center">Chapter 6. The Website</th><td width="20%" align="right"> <a accesskey="n" href="xml-primer.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="the-website-build"></a>6.2. Building and Installing the Web Pages</h2></div></div></div><p>Having obtained the documentation and web site source files,
      the web site can be built.</p><p>An actual installation of the web site is run as the
      <code class="systemitem">root</code> user because the
      permissions on the web server directory will not allow files to
      be installed by an unprivileged user.  For testing, it can be
      useful to install the files as a normal user to a temporary
      directory.</p><p>In these examples, the web site files are built by user
      <code class="systemitem">jru</code> in their home
      directory, <code class="filename">~/doc</code>, with a full path of
      <code class="filename">/usr/home/jru/doc</code>.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml">The web site build uses the <code class="filename">INDEX</code>
	from the Ports Collection and might fail if that file or
	<code class="filename">/usr/ports</code> is not present.  The simplest
	approach is to install the <a class="link" href="../../../../doc/en_US.ISO8859-1/books/handbook/ports.html#ports-tree" target="_top">Ports
	  Collection</a>.</p></div><div class="example"><a id="the-website-examples-build"></a><div class="example-title">Example 6.1. Build the Full Web Site and All Documents</div><div class="example-contents"><p>Build the web site and all documents.  The resulting files
	are left in the document tree:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cd ~/doc/en_US.ISO8859-1/htdocs/</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>make all</code></strong></pre></div></div><br class="example-break" /><div class="example"><a id="the-website-examples-buildinstall-englishonly"></a><div class="example-title">Example 6.2. Build Only the Web Site in English</div><div class="example-contents"><p>Build the web site only, in English, as user
	<code class="systemitem">jru</code>, and install
	the resulting files into <code class="filename">/tmp/www</code> for
	testing:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cd ~/doc/en_US.ISO8859-1/htdocs/</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>env DOCDIR=/tmp/www make ENGLISH_ONLY=yes WEB_ONLY=yes all install</code></strong></pre><p>Changes to static files can usually be tested by viewing
	the modified files directly with a web browser.  If the site
	has been built as shown above, a modified main page can be
	viewed with:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>firefox /tmp/www/data/index.html</code></strong></pre><p>Modifications to dynamic files can be tested with a web
	server running on the local system.  After building the site
	as shown above, this
	<code class="filename">/usr/local/etc/apache24/httpd.conf</code> can be
	used with <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/www/apache24/pkg-descr">www/apache24</a>:</p><pre class="programlisting"># httpd.conf for testing the FreeBSD website
Define TestRoot "/tmp/www/data"

# directory for configuration files
ServerRoot "/usr/local"

Listen 80

# minimum required modules
LoadModule authz_core_module libexec/apache24/mod_authz_core.so
LoadModule mime_module libexec/apache24/mod_mime.so
LoadModule unixd_module libexec/apache24/mod_unixd.so
LoadModule cgi_module libexec/apache24/mod_cgi.so
LoadModule dir_module libexec/apache24/mod_dir.so

# run the webserver as user and group
User www
Group www

ServerAdmin you@example.com
ServerName fbsdtest

# deny access to all files
&lt;Directory /&gt;
    AllowOverride none
    Require all denied
&lt;/Directory&gt;

# allow access to the website directory
DocumentRoot "${TestRoot}"
&lt;Directory "${TestRoot}"&gt;
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
&lt;/Directory&gt;

# prevent access to .htaccess and .htpasswd files
&lt;Files ".ht*"&gt;
    Require all denied
&lt;/Files&gt;

ErrorLog "/var/log/httpd-error.log"
LogLevel warn

# set up the CGI script directory
&lt;Directory "${TestRoot}/cgi"&gt;
    AllowOverride None
    Options None
    Require all granted
    Options +ExecCGI
    AddHandler cgi-script .cgi
&lt;/Directory&gt;

Include etc/apache24/Includes/*.conf</pre><p>Start the web server with</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>service apache24 onestart</code></strong></pre><p>The web site can be viewed at <a class="link" href="http://localhost" target="_top">http://localhost</a>.  Be aware that many links
	refer to the real FreeBSD site by name, and those links will
	still go to the external site instead of the local test
	version.  Fully testing the local site will require
	temporarily setting <acronym class="acronym">DNS</acronym> so
	<code class="literal">www.FreeBSD.org</code> resolves to
	<code class="literal">localhost</code> or the local
	<acronym class="acronym">IP</acronym> address.</p></div></div><br class="example-break" /><div class="example"><a id="the-website-examples-buildinstall"></a><div class="example-title">Example 6.3. Build and Install the Web Site</div><div class="example-contents"><p>Build the web site and all documents as user
	<code class="systemitem">jru</code>.  Install the
	resulting files as
	<code class="systemitem">root</code> into the
	default directory,
	<code class="filename">/root/public_html</code>:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cd ~/doc/en_US.ISO8859-1/htdocs</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>make all</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>su -</code></strong>
Password:
<code class="prompt">#</code> <strong class="userinput"><code>cd /usr/home/jru/doc/en_US.ISO8859-1/htdocs</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>make install</code></strong></pre></div></div><br class="example-break" /><p>The install process does not delete any old or outdated
      files that existed previously in the same directory.  If a new
      copy of the site is built and installed every day, this command
      will find and delete all files that have not been updated in
      three days:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>find <em class="replaceable"><code>/usr/local/www</code></em> -ctime 3 -delete</code></strong></pre></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="the-website.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="the-website.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="xml-primer.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 6. The Website </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 7. XML Primer</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>