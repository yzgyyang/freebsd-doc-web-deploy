<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>17.81. shebangfix</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="uses.html" title="Chapter 17. Using USES Macros" /><link rel="prev" href="uses-shared-mime-info.html" title="17.80. shared-mime-info" /><link rel="next" href="uses-sqlite.html" title="17.82. sqlite" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">17.81. <code class="literal">shebangfix</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="uses-shared-mime-info.html">Prev</a> </td><th width="60%" align="center">Chapter 17. Using <code class="varname">USES</code> Macros</th><td width="20%" align="right"> <a accesskey="n" href="uses-sqlite.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="uses-shebangfix"></a>17.81. <code class="literal">shebangfix</code></h2></div></div></div><p>Possible arguments: (none)</p><p>A lot of software uses incorrect locations for script
      interpreters, most notably <code class="filename">/usr/bin/perl</code>
      and <code class="filename">/bin/bash</code>.  The shebangfix macro fixes
      shebang lines in scripts listed in
      <code class="varname">SHEBANG_REGEX</code>,
      <code class="varname">SHEBANG_GLOB</code>, or
      <code class="varname">SHEBANG_FILES</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="varname">SHEBANG_REGEX</code></span></dt><dd><p>Contains <span class="emphasis"><em>one</em></span> extended regular
	    expressions, and is used with the
	    <code class="literal">-iregex</code> argument of <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=find&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">find</span>(1)</span></a>.  See
	    <a class="xref" href="uses-shebangfix.html#uses-shebangfix-ex-regex" title="Example 17.11. USES=shebangfix with SHEBANG_REGEX">Example 17.11, &#8220;<code class="literal">USES=shebangfix</code> with
	<code class="varname">SHEBANG_REGEX</code>&#8221;</a>.</p></dd><dt><span class="term"><code class="varname">SHEBANG_GLOB</code></span></dt><dd><p>Contains a list of patterns used with the
	    <code class="literal">-name</code> argument of <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=find&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">find</span>(1)</span></a>.  See
	    <a class="xref" href="uses-shebangfix.html#uses-shebangfix-ex-glob" title="Example 17.12. USES=shebangfix with SHEBANG_GLOB">Example 17.12, &#8220;<code class="literal">USES=shebangfix</code> with
	<code class="varname">SHEBANG_GLOB</code>&#8221;</a>.</p></dd><dt><span class="term"><code class="varname">SHEBANG_FILES</code></span></dt><dd><p>Contains a list of files or <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sh</span>(1)</span></a> globs.  The
	    shebangfix macro is run from <code class="literal">${WRKSRC}</code>,
	    so <code class="varname">SHEBANG_FILES</code> can contain paths that
	    are relative to <code class="literal">${WRKSRC}</code>.  It can also
	    deal with absolute paths if files outside of
	    <code class="literal">${WRKSRC}</code> require patching.  See <a class="xref" href="uses-shebangfix.html#uses-shebangfix-ex-files" title="Example 17.13. USES=shebangfix with SHEBANG_FILES">Example 17.13, &#8220;<code class="literal">USES=shebangfix</code> with
	<code class="varname">SHEBANG_FILES</code>&#8221;</a>.</p></dd></dl></div><p>Currently
      <span class="application">Bash</span>,
      <span class="application">Java</span>, <span class="application">Ksh</span>,
      <span class="application">Lua</span>,
      <span class="application">Perl</span>, <span class="application">PHP</span>,
      <span class="application">Python</span>,
      <span class="application">Ruby</span>, <span class="application">Tcl</span>,
      and <span class="application">Tk</span> are supported by
      default.</p><p>There are three configuration variables:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="varname">SHEBANG_LANG</code></span></dt><dd><p>The list of supported interpreters.</p></dd><dt><span class="term"><code class="varname"><em class="replaceable"><code>interp</code></em>_CMD</code></span></dt><dd><p>The path to the command interpreter on FreeBSD.  The
	    default value is
	    <code class="literal">${LOCALBASE}/bin/<em class="replaceable"><code>interp</code></em></code>.</p></dd><dt><span class="term"><code class="varname"><em class="replaceable"><code>interp</code></em>_OLD_CMD</code></span></dt><dd><p>The list of wrong invocations of interpreters.  These
	    are typically obsolete paths, or paths used on other
	    operating systems that are incorrect on FreeBSD.  They
	    will be replaced by the correct path in
	    <code class="varname"><em class="replaceable"><code>interp</code></em>_CMD</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">These will <span class="emphasis"><em>always</em></span> be part of
	      <code class="varname"><em class="replaceable"><code>interp</code></em>_OLD_CMD</code>:
	      <code class="literal">"/usr/bin/env
		<em class="replaceable"><code>interp</code></em>"
		/bin/<em class="replaceable"><code>interp</code></em>
		/usr/bin/<em class="replaceable"><code>interp</code></em>
		/usr/local/bin/<em class="replaceable"><code>interp</code></em></code>.</p></div><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname"><em class="replaceable"><code>interp</code></em>_OLD_CMD</code>
	      contain multiple values.  Any entry with spaces must be
	      quoted.  See <a class="xref" href="uses-shebangfix.html#uses-shebangfix-ex-ksh" title="Example 17.9. Specifying all the Paths When Adding an Interpreter to USES=shebangfix">Example 17.9, &#8220;Specifying all the Paths When Adding an Interpreter to
	<code class="literal">USES=shebangfix</code>&#8221;</a>.</p></div></dd></dl></div><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml">The fixing of shebangs is done during the
	<code class="buildtarget">patch</code> phase.  If scripts are
	created with incorrect shebangs during the
	<code class="buildtarget">build</code> phase, the build process (for
	example, the <code class="filename">configure</code> script, or the
	<code class="filename">Makefiles</code>) must be patched or given the
	right path (for example, with
	<code class="varname">CONFIGURE_ENV</code>,
	<code class="varname">CONFIGURE_ARGS</code>,
	<code class="varname">MAKE_ENV</code>, or <code class="varname">MAKE_ARGS</code>)
	to generate the right shebangs.</p><p xmlns="http://www.w3.org/1999/xhtml">Correct paths for supported interpreters
	are available in
	<code class="literal"><em class="replaceable"><code>interp</code></em>_CMD</code>.</p></div><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml">When used with <a class="link" href="uses-python.html" title="17.72. python"><code class="literal">USES=python</code></a>,
	and the aim is only to fix the shebangs but a dependency on
	<span class="application">Python</span> itself is not wanted, use
	<code class="literal">PYTHON_NO_DEPENDS=yes</code>.</p></div><div class="example"><a id="uses-shebangfix-ex-lua"></a><div class="example-title">Example 17.8. Adding Another Interpreter to
	<code class="literal">USES=shebangfix</code></div><div class="example-contents"><p>To add another interpreter, set
	<code class="varname">SHEBANG_LANG</code>.  For example:</p><pre class="programlisting">SHEBANG_LANG=	lua</pre></div></div><br class="example-break" /><div class="example"><a id="uses-shebangfix-ex-ksh"></a><div class="example-title">Example 17.9. Specifying all the Paths When Adding an Interpreter to
	<code class="literal">USES=shebangfix</code></div><div class="example-contents"><p>If it was not already defined, and there were no default
	values for
	<code class="varname"><em class="replaceable"><code>interp</code></em>_OLD_CMD</code>
	and <code class="varname"><em class="replaceable"><code>interp</code></em>_CMD</code>
	the <span class="application">Ksh</span> entry could be defined
	as:</p><pre class="programlisting">SHEBANG_LANG=	ksh
ksh_OLD_CMD=	"/usr/bin/env ksh" /bin/ksh /usr/bin/ksh
ksh_CMD=	${LOCALBASE}/bin/ksh</pre></div></div><br class="example-break" /><div class="example"><a id="uses-shebangfix-ex-strange"></a><div class="example-title">Example 17.10. Adding a Strange Location for an Interpreter</div><div class="example-contents"><p>Some software uses strange locations for an interpreter.
	For example, an application might expect
	<span class="application">Python</span> to be located in
	<code class="filename">/opt/bin/python2.7</code>.  The strange path to
	be replaced can be declared in the port
	<code class="filename">Makefile</code>:</p><pre class="programlisting">python_OLD_CMD=	/opt/bin/python2.7</pre></div></div><br class="example-break" /><div class="example"><a id="uses-shebangfix-ex-regex"></a><div class="example-title">Example 17.11. <code class="literal">USES=shebangfix</code> with
	<code class="varname">SHEBANG_REGEX</code></div><div class="example-contents"><p>To fix all the files in
	<code class="literal">${WRKSRC}/scripts</code> ending in
	<code class="filename">.pl</code>, <code class="filename">.sh</code>, or
	<code class="filename">.cgi</code> do:</p><pre class="programlisting">USES=	shebangfix
SHEBANG_REGEX=	./scripts/.*\.(sh|pl|cgi)</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">SHEBANG_REGEX</code> is used by running
	  <code class="command">find -E</code>, which uses modern regular
	  expressions also known as extended regular expressions.  See
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=re_format&amp;sektion=7&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">re_format</span>(7)</span></a> for more information.</p></div></div></div><br class="example-break" /><div class="example"><a id="uses-shebangfix-ex-glob"></a><div class="example-title">Example 17.12. <code class="literal">USES=shebangfix</code> with
	<code class="varname">SHEBANG_GLOB</code></div><div class="example-contents"><p>To fix all the files in <code class="literal">${WRKSRC}</code>
	ending in <code class="filename">.pl</code> or
	<code class="filename">.sh</code>, do:</p><pre class="programlisting">USES=	shebangfix
SHEBANG_GLOB=	*.sh *.pl</pre></div></div><br class="example-break" /><div class="example"><a id="uses-shebangfix-ex-files"></a><div class="example-title">Example 17.13. <code class="literal">USES=shebangfix</code> with
	<code class="varname">SHEBANG_FILES</code></div><div class="example-contents"><p>To fix the files <code class="filename">script/foobar.pl</code> and
	<code class="filename">script/*.sh</code> in
	<code class="literal">${WRKSRC}</code>, do:</p><pre class="programlisting">USES=	shebangfix
SHEBANG_FILES=	scripts/foobar.pl scripts/*.sh</pre></div></div><br class="example-break" /></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="uses-shared-mime-info.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="uses.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="uses-sqlite.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">17.80. <code class="literal">shared-mime-info</code> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 17.82. <code class="literal">sqlite</code></td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>