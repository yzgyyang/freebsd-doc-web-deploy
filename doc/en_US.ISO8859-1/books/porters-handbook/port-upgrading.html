<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>Chapter 11. Upgrading a Port</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="prev" href="testing-poudriere.html" title="10.5. Poudriere" /><link rel="next" href="moved-and-updating-files.html" title="11.2. UPDATING and MOVED" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 11. Upgrading a Port</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="testing-poudriere.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="moved-and-updating-files.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="port-upgrading"></a>Chapter 11. Upgrading a Port</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="sect1"><a href="port-upgrading.html#svn-diff">11.1. Using <span class="application">Subversion</span> to Make
      Patches</a></span></dt><dt><span class="sect1"><a href="moved-and-updating-files.html">11.2. <code class="filename">UPDATING</code> and
      <code class="filename">MOVED</code></a></span></dt></dl></div><p>When a port is not the most recent version available from the
    authors, update the local working copy of
    <code class="filename">/usr/ports</code>.  The port might have already been
    updated to the new version.</p><p>When working with more than a few ports, it will probably be
    easier to use <span class="application">Subversion</span> to keep
    the whole ports collection up-to-date, as described in the <a class="link" href="../../../../doc/en_US.ISO8859-1/books/handbook/ports-using.html" target="_top">Handbook</a>.
    This will have the added benefit of tracking all the port's
    dependencies.</p><p>The next step is to see if there is an update already pending.
    To do this, there are two options.  There is a searchable
    interface to the <a class="link" href="https://bugs.freebsd.org/search/" target="_top">FreeBSD Problem
      Report (PR) or bug database</a>.  Select <code class="literal">Ports &amp;
      Packages</code> in the <code class="literal">Product</code> multiple
    select menu, and
    enter the name of the port in the <code class="literal">Summary</code>
    field.</p><p>However, sometimes people forget to put the name of the port
    into the Summary field in an unambiguous fashion.  In that
    case, try searching in the <code class="literal">Comment</code> field in
    the <code class="literal">Detailled Bug Information</code> section, or try
    the
    <a class="link" href="portsmon.html" title="16.6. The FreeBSD Ports Monitoring System">FreeBSD Ports Monitoring System</a>
    (also known as <code class="literal">portsmon</code>).  This system
    attempts to classify port PRs by portname.  To search for PRs
    about a particular port, use the <a class="link" href="http://portsmon.FreeBSD.org/portoverview.py" target="_top">Overview
      of One Port</a>.</p><p>If there is no pending PR, the next step is to send an email
    to the port's maintainer, as shown by
    <code class="command">make maintainer</code>.  That person may already be
    working on an upgrade, or have a reason to not upgrade the port
    right now (because of, for example, stability problems of the
    new version), and there is no need to duplicate their work.  Note
    that unmaintained ports are listed with a maintainer of
    <code class="literal">ports@FreeBSD.org</code>, which is just the general
    ports mailing list, so sending mail there probably will not help
    in this case.</p><p>If the maintainer asks you to do the upgrade or there is
    no maintainer, then help out FreeBSD by
    preparing the update!  Please do this by using the
    <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> command in the base system.</p><p>To create a suitable <code class="command">diff</code> for a single
    patch, copy the file that needs patching to
    <code class="filename"><em class="replaceable"><code>something</code></em>.orig</code>,
    save the changes to
    <code class="filename"><em class="replaceable"><code>something</code></em></code> and then
    create the patch:</p><div class="informalexample"><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>diff -u <em class="replaceable"><code>something</code></em>.orig <em class="replaceable"><code>something</code></em> &gt; something.diff</code></strong></pre></div><p>Otherwise, either use the
    <code class="command">svn diff</code> method (<a class="xref" href="port-upgrading.html#svn-diff" title="11.1. Using Subversion to Make Patches">Section 11.1, &#8220;Using <span class="application">Subversion</span> to Make
      Patches&#8221;</a>)
    or copy the contents of the port to an entire different
    directory and use the result of the recursive <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>
    output of the new and old ports directories (for example, if the
    modified port directory is called <code class="filename">superedit</code>
    and the original is in our tree as
    <code class="filename">superedit.bak</code>, then save the result of
    <code class="command">diff -ruN superedit.bak superedit</code>).  Either
    unified or context diff is fine, but port committers generally
    prefer unified diffs.  Note the use of the <code class="literal">-N</code>
    option&#8212;this is the accepted way to force diff to properly
    deal with the case of new files being added or old files being
    deleted.  Before sending us the diff, please examine the output
    to make sure all the changes make sense.  (In particular, make
    sure to first clean out the work directories with
    <code class="command">make clean</code>).</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">If some files have been added, copied, moved, or removed,
      add this information to the problem report so that the committer
      picking up the patch will know what <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> commands to
      run.</p></div><p>To simplify common operations with patch files, use
    <code class="command">make makepatch</code> as described in <a class="xref" href="slow-patch.html" title="4.4. Patching">Section 4.4, &#8220;Patching&#8221;</a>.
    Other tools exists, like
    <code class="filename">/usr/ports/Tools/scripts/patchtool.py</code>.
    Before using it, please read
    <code class="filename">/usr/ports/Tools/scripts/README.patchtool</code>.</p><p>If the port is unmaintained, and you are actively using
    it, please consider volunteering to become its
    maintainer.  FreeBSD has over 4000 ports without maintainers, and
    this is an area where more volunteers are always needed.  (For a
    detailed description of the responsibilities of maintainers,
    refer to the section in the <a class="link" href="../../../../doc/en_US.ISO8859-1/books/developers-handbook/policies.html#POLICIES-MAINTAINER" target="_top">Developer's
      Handbook</a>.)</p><p>To submit the diff, use the <a class="link" href="https://bugs.freebsd.org/submit/" target="_top">bug submit
      form</a> (product <code class="literal">Ports &amp; Packages</code>,
    component <code class="literal">Individual Port(s)</code>).
    Always include the category
    with the port name, followed by colon, and brief descripton of the
    issue.  Examples:
    <code class="literal"><em class="replaceable"><code>category/portname</code></em>:
      <em class="replaceable"><code>add FOO option</code></em></code>;
    <code class="literal">
      <em class="replaceable"><code>category/portname</code></em>:
      <em class="replaceable"><code>Update to X.Y</code></em></code>.
    Please mention any added or
    deleted files in the message, as they have to be explicitly
    specified to <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> when doing a commit.  Do not compress or
    encode the diff.</p><p>Before submitting the bug, review the <a class="link" href="../../../../doc/en_US.ISO8859-1/articles/problem-reports/pr-writing.html" target="_top">
    Writing the problem report</a> section in the Problem
    Reports article.  It contains far more information about how to
    write useful problem reports.</p><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml">If the upgrade is motivated by security concerns or a
      serious fault in the currently committed port, please notify
      the Ports Management Team <code class="email">&lt;<a xmlns="" class="email" href="mailto:portmgr@FreeBSD.org">portmgr@FreeBSD.org</a>&gt;</code> to request immediate rebuilding and
      redistribution of the port's package.  Unsuspecting users
      of <code class="command">pkg</code> will otherwise continue to install
      the old version via <code class="command">pkg install</code> for several
      weeks.</p></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Please use <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a> or <code class="command">svn diff</code> to
      create updates to existing ports.  Other formats include the
      whole file and make it impossible to see just what has changed.
      When diffs are not included, the entire update might be
      ignored.</p></div><p>Now that all of that is done, read about
    how to keep up-to-date in <a class="xref" href="keeping-up.html" title="Chapter 16. Keeping Up">Chapter 16, <em>Keeping Up</em></a>.</p><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="svn-diff"></a>11.1. Using <span class="application">Subversion</span> to Make
      Patches</h2></div></div></div><p>When possible, please submit a <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> diff.  They
      are easier to handle than diffs between
      <span class="quote">&#8220;<span class="quote">new and old</span>&#8221;</span> directories.  It is easier
      to see what has changed, and to update the diff if
      something was modified in the Ports Collection since the
      work on it began, or if the
      committer asks for something to be fixed.  Also, a patch
      generated with <code class="command">svn diff</code> can be easily applied
      with <code class="command">svn patch</code> and will save some time to the
      committer.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>cd ~/my_wrkdir</code></strong> <a id="my-wrkdir"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
<code class="prompt">%</code> <strong class="userinput"><code>svn co <em class="replaceable"><code>https://svn.FreeBSD.org</code></em>/ports/head/dns/pdnsd</code></strong> <a id="svn-FreeBSD-org"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
<code class="prompt">%</code> <strong class="userinput"><code>cd ~/my_wrkdir/pdnsd</code></strong></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#my-wrkdir"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>This can be anywhere, of course.  Building
	  ports is not limited to within
	  <code class="filename">/usr/ports/</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#svn-FreeBSD-org"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p><a class="link" href="https://svn.FreeBSD.org/" target="_top">svn.FreeBSD.org</a>
	  is the FreeBSD public <span class="application">Subversion</span>
	  server.  See <a class="link" href="../../../../doc/en_US.ISO8859-1/books/handbook/svn.html#svn-mirrors" target="_top">Subversion
	    mirror sites</a> for more information.</p></td></tr></table></div><p>While in the port directory, make any changes that are
      needed.  If adding, copying, moving, or removing a
      file, use <code class="command">svn</code> to track these changes:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn add <em class="replaceable"><code>new_file</code></em></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn copy <em class="replaceable"><code>some_file</code></em> <em class="replaceable"><code>file_copy</code></em></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn move <em class="replaceable"><code>old_name</code></em> <em class="replaceable"><code>new_name</code></em></code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn remove <em class="replaceable"><code>deleted_file</code></em></code></strong></pre><p>Make sure to check the port using the checklist in
      <a class="xref" href="porting-testing.html" title="3.4. Testing the Port">Section 3.4, &#8220;Testing the Port&#8221;</a> and
      <a class="xref" href="porting-portlint.html" title="3.5. Checking the Port with portlint">Section 3.5, &#8220;Checking the Port with
      <code class="command">portlint</code>&#8221;</a>.</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn status</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>svn update</code></strong> <a id="svn-update"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#svn-update"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>This will attempt to merge the differences between the
	  patch and current repository version.  Watch the output
	  carefully.  The letter in front of each file name
	  indicates what was done with it.  See
	  <a class="xref" href="port-upgrading.html#table-svn-up" title="Table 11.1. Subversion Update File Prefixes">Table 11.1, &#8220;<span class="application">Subversion</span> Update File
	Prefixes&#8221;</a> for a complete list.</p></td></tr></table></div><div class="table"><a id="table-svn-up"></a><div class="table-title">Table 11.1. <span class="application">Subversion</span> Update File
	Prefixes</div><div class="table-contents"><table class="table" summary="Subversion Update File&#10;&#9;Prefixes" width="100%" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td>U</td><td>The file was updated without problems.</td></tr><tr><td>G</td><td>The file was updated without problems (only when
	      working against a remote
	      repository).</td></tr><tr><td>M</td><td>The file had been modified, and was merged
	      without conflicts.</td></tr><tr><td>C</td><td>The file had been modified, and was merged with
	      conflicts.</td></tr></tbody></table></div></div><br class="table-break" /><p>If <code class="literal">C</code> is displayed as a result of
      <code class="command">svn update</code>, it means something changed in
      the <span class="application">Subversion</span> repository and
      <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> was not able to merge the local changes with those
      from the repository.  It is always a good idea to inspect the
      changes anyway, since <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> does not know anything about
      the structure of a port, so it might (and probably will) merge
      things that do not make sense.</p><p>The last step is to make a unified <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">diff</span>(1)</span></a>
      of the changes:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>svn diff &gt; ../`make -VPKGNAME`.diff</code></strong></pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">If files have been added, copied, moved, or removed,
	include the <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=svn&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">svn</span>(1)</span></a> <code class="command">add</code>,
	<code class="command">copy</code>, <code class="command">move</code>, and
	<code class="command">remove</code> commands that were used.
	<code class="command">svn move</code> or <code class="command">svn copy</code>
	must be run before the patch can be applied.  <code class="command">svn
	  add</code> or <code class="command">svn remove</code> must be run
	after the patch is applied.</p></div><p>Send the patch following the <a class="link" href="../../../../doc/en_US.ISO8859-1/articles/problem-reports/pr-writing.html" target="_top">problem
	report submission guidelines</a>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="testing-poudriere.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="moved-and-updating-files.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">10.5. <span class="application">Poudriere</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 11.2. <code class="filename">UPDATING</code> and
      <code class="filename">MOVED</code></td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>