<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>5.10. Slave Ports and MASTERDIR</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="makefiles.html" title="Chapter 5. Configuring the Makefile" /><link rel="prev" href="makefile-depend.html" title="5.9. Dependencies" /><link rel="next" href="makefile-manpages.html" title="5.11. Man Pages" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.10. Slave Ports and <code class="varname">MASTERDIR</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="makefile-depend.html">Prev</a> </td><th width="60%" align="center">Chapter 5. Configuring the Makefile</th><td width="20%" align="right"> <a accesskey="n" href="makefile-manpages.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-masterdir"></a>5.10. Slave Ports and <code class="varname">MASTERDIR</code></h2></div></div></div><p>If the port needs to build slightly different versions of
      packages by having a variable (for instance, resolution, or
      paper size) take different values, create one subdirectory per
      package to make it easier for users to see what to do, but try
      to share as many files as possible between ports.  Typically, by
      using variables cleverly, only a very short
      <code class="filename">Makefile</code> is needed in all but one of the
      directories.  In the sole <code class="filename">Makefile</code>, use
      <code class="varname">MASTERDIR</code> to specify the directory where the
      rest of the files are.  Also, use a variable as part of <a class="link" href="makefile-naming.html#porting-pkgname" title="5.2.5. Package Naming Conventions"><code class="varname">PKGNAMESUFFIX</code></a>
      so the packages will have different names.</p><p>This will be best demonstrated by an example.  This is part
      of <code class="filename">print/pkfonts300/Makefile</code>;</p><pre class="programlisting">PORTNAME=	pkfonts${RESOLUTION}
PORTVERSION=	1.0
DISTFILES=	pk${RESOLUTION}.tar.gz

PLIST=		${PKGDIR}/pkg-plist.${RESOLUTION}

.if !defined(RESOLUTION)
RESOLUTION=	300
.else
.if ${RESOLUTION} != 118 &amp;&amp; ${RESOLUTION} != 240 &amp;&amp; \
	${RESOLUTION} != 300 &amp;&amp; ${RESOLUTION} != 360 &amp;&amp; \
	${RESOLUTION} != 400 &amp;&amp; ${RESOLUTION} != 600
.BEGIN:
	@${ECHO_MSG} "Error: invalid value for RESOLUTION: \"${RESOLUTION}\""
	@${ECHO_MSG} "Possible values are: 118, 240, 300, 360, 400 and 600."
	@${FALSE}
.endif
.endif</pre><p><a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/print/pkfonts300/pkg-descr">print/pkfonts300</a> also has all
      the regular patches, package files, etc.  Running
      <code class="command">make</code> there, it will take the default value
      for the resolution (300) and build the port normally.</p><p>As for other resolutions, this is the
      <span class="emphasis"><em>entire</em></span>
      <code class="filename">print/pkfonts360/Makefile</code>:</p><pre class="programlisting">RESOLUTION=	360
MASTERDIR=	${.CURDIR}/../pkfonts300

.include	"${MASTERDIR}/Makefile"</pre><p>(<code class="filename">print/pkfonts118/Makefile</code>,
      <code class="filename">print/pkfonts600/Makefile</code>, and all the
      other are similar).
      <code class="varname">MASTERDIR</code> definition tells
      <code class="filename">bsd.port.mk</code> that the regular set of
      subdirectories like <code class="varname">FILESDIR</code> and
      <code class="varname">SCRIPTDIR</code> are to be found under
      <code class="filename">pkfonts300</code>.  The
      <code class="literal">RESOLUTION=360</code> line will override the
      <code class="literal">RESOLUTION=300</code> line in
      <code class="filename">pkfonts300/Makefile</code> and the port will be
      built with resolution set to 360.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="makefile-depend.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="makefiles.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="makefile-manpages.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">5.9. Dependencies </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 5.11. Man Pages</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>