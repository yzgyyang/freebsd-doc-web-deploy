<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>6.10. Using GNOME</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="special.html" title="Chapter 6. Special Considerations" /><link rel="prev" href="using-x11.html" title="6.9. Using X11" /><link rel="next" href="gnome-components.html" title="6.11. GNOME Components" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.10. Using GNOME</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="using-x11.html">Prev</a> </td><th width="60%" align="center">Chapter 6. Special Considerations</th><td width="20%" align="right"> <a accesskey="n" href="gnome-components.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="using-gnome"></a>6.10. Using GNOME</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-gnome-introduction"></a>6.10.1. Introduction</h3></div></div></div><p>This chapter explains the <acronym class="acronym">GNOME</acronym>
	framework as used by ports.  The framework can be loosely
	divided into the base components, <acronym class="acronym">GNOME</acronym>
	desktop components, and a few special macros that simplify the
	work of port maintainers.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="use-gnome"></a>6.10.2. Using <code class="varname">USE_GNOME</code></h3></div></div></div><p>Adding this variable to the port allows the use of
	the macros and components defined in
	<code class="filename">bsd.gnome.mk</code>.  The code in
	<code class="filename">bsd.gnome.mk</code> adds the needed
	build-time, run-time or library dependencies
	or the handling of special files.
	<acronym class="acronym">GNOME</acronym> applications under FreeBSD use the
	<code class="varname">USE_GNOME</code> infrastructure.  Include all the
	needed components as a space-separated list.  The
	<code class="varname">USE_GNOME</code> components are divided into
	these virtual lists: basic components, GNOME 3 components
	and legacy components.  If the port needs only GTK3 libraries,
	this is the shortest way to define it:</p><pre class="programlisting">USE_GNOME=	gtk30</pre><p><code class="varname">USE_GNOME</code> components automatically
	add the dependencies they need.  Please see
	<a class="xref" href="gnome-components.html" title="6.11. GNOME Components">Section 6.11, &#8220;GNOME Components&#8221;</a> for an exhaustive
	list of all <code class="varname">USE_GNOME</code> components and which
	other components they imply and their dependencies.</p><p>Here is an example <code class="filename">Makefile</code> for a
	GNOME port that uses many of the techniques outlined in this
	document.  Please use it as a guide for creating new
	ports.</p><pre class="programlisting"># $FreeBSD$

PORTNAME=	regexxer
DISTVERSION=	0.10
CATEGORIES=	devel textproc gnome
MASTER_SITES=	GNOME

MAINTAINER=	kwm@FreeBSD.org
COMMENT=	Interactive tool for performing search and replace operations

USES=		gettext gmake localbase:ldflags pathfix pkgconfig tar:xz
GNU_CONFIGURE=	yes
USE_GNOME=	gnomeprefix intlhack gtksourceviewmm3
INSTALLS_ICONS=	yes

GLIB_SCHEMAS=	org.regexxer.gschema.xml

.include &lt;bsd.port.mk&gt;</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The <code class="varname">USE_GNOME</code> macro without any
	  arguments does not add any dependencies to the port.
	  <code class="varname">USE_GNOME</code> cannot be set after
	  <code class="filename">bsd.port.pre.mk</code>.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="using-gnome-variables"></a>6.10.3. Variables</h3></div></div></div><p>This section explains which macros are available and how
	they are used.  Like they are used in the above example.  The
	<a class="xref" href="gnome-components.html" title="6.11. GNOME Components">Section 6.11, &#8220;GNOME Components&#8221;</a> has a more in-depth
	explanation.  <code class="varname">USE_GNOME</code> has to be set for
	these macros to be of use.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><a id="gnome-icons"></a><code class="varname">INSTALLS_ICONS</code></span></dt><dd><p><span class="application">GTK+</span> ports which install
	      <span class="application">Freedesktop</span>-style icons to
	      <code class="filename">${LOCALBASE}/share/icons</code> should use
	      this macro to ensure that the icons are cached and will
	      display correctly.  The cache file is named
	      <code class="filename">icon-theme.cache</code>.  Do not include
	      that file in <code class="filename">pkg-plist</code>.  This macro
	      handles that automatically.  This macro is not needed
	      for <span class="application">Qt</span>, which uses an
	      internal method.</p></dd><dt><span class="term"><a id="gnome-glibschema"></a><code class="varname">GLIB_SCHEMAS</code></span></dt><dd><p>List of all the glib schema files the port installs.
	      The macro will add the files to the port plist and
	      handle the registration of these files on install and
	      deinstall.</p><p>The glib schema files are written in
	      <acronym class="acronym">XML</acronym> and end with the
	      <code class="filename">gschema.xml</code> extension.  They are
	      installed in the
	      <code class="filename">share/glib-2.0/schemas/</code> directory.
	      These schema files contain all application config values
	      with their default settings.  The actual database used
	      by the applications is built by
	      <span class="application">glib-compile-schema</span>, which is
	      run by the <code class="varname">GLIB_SCHEMAS</code> macro.</p><pre class="programlisting">GLIB_SCHEMAS=foo.gschema.xml</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Do not add glib schemas to the
		<code class="filename">pkg-plist</code>.  If they are listed in
		<code class="filename">pkg-plist</code>, they will not be
		registered and the applications might not work
		properly.</p></div></dd><dt><span class="term"><a id="gnome-gconfschema"></a><code class="varname">GCONF_SCHEMAS</code></span></dt><dd><p>List all the gconf schema files.  The macro will add
	      the schema files to the port plist and will handle their
	      registration on install and deinstall.</p><p>GConf is the <acronym class="acronym">XML</acronym>-based database
	      that virtually all GNOME applications use for storing
	      their settings.  These files are installed into the
	      <code class="filename">etc/gconf/schemas</code> directory.  This
	      database is defined by installed schema files that are
	      used to generate <code class="filename">%gconf.xml</code> key
	      files.  For each schema file installed by the port,
	      there must be an entry in the
	      <code class="filename">Makefile</code>:</p><pre class="programlisting">GCONF_SCHEMAS=my_app.schemas my_app2.schemas my_app3.schemas</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Gconf schemas are listed in the
		<code class="varname">GCONF_SCHEMAS</code> macro rather than
		<code class="filename">pkg-plist</code>.  If they are listed in
		<code class="filename">pkg-plist</code>, they will not be
		registered and the applications might not work
		properly.</p></div></dd><dt><span class="term"><a id="gnome-omf"></a><code class="varname">INSTALLS_OMF</code></span></dt><dd><p>Open Source Metadata Framework
	      (<acronym class="acronym">OMF</acronym>) files are commonly used by
	      GNOME 2 applications.  These files contain the
	      application help file information, and require special
	      processing by ScrollKeeper/rarian.  To properly register
	      <acronym class="acronym">OMF</acronym> files when installing GNOME
	      applications from packages, make sure that
	      <code class="varname">omf</code> files are listed in
	      <code class="varname">pkg-plist</code> and that the port
	      <code class="filename">Makefile</code> has
	      <code class="varname">INSTALLS_OMF</code> defined:</p><pre class="programlisting">INSTALLS_OMF=yes</pre><p>When set, <code class="filename">bsd.gnome.mk</code>
	      automatically scans <code class="filename">pkg-plist</code> and
	      adds appropriate <code class="literal">@exec</code> and
	      <code class="literal">@unexec</code> directives for each
	      <code class="filename">.omf</code> to track in the
	      <acronym class="acronym">OMF</acronym> registration database.</p></dd></dl></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="using-x11.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="special.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="gnome-components.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">6.9. Using X11 </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 6.11. GNOME Components</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>