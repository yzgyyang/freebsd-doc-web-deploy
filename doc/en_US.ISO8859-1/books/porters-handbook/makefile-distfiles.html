<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>5.4. The Distribution Files</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Porter's Handbook" /><link rel="up" href="makefiles.html" title="Chapter 5. Configuring the Makefile" /><link rel="prev" href="makefile-categories.html" title="5.3. Categorization" /><link rel="next" href="makefile-maintainer.html" title="5.5. MAINTAINER" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.4. The Distribution Files</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="makefile-categories.html">Prev</a> </td><th width="60%" align="center">Chapter 5. Configuring the Makefile</th><td width="20%" align="right"> <a accesskey="n" href="makefile-maintainer.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="makefile-distfiles"></a>5.4. The Distribution Files</h2></div></div></div><p>The second part of the <code class="filename">Makefile</code>
      describes the files that must be downloaded to build
      the port, and where they can be downloaded.</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-distname"></a>5.4.1. <code class="varname">DISTNAME</code></h3></div></div></div><p><code class="varname">DISTNAME</code> is the name of the port as
	called by the authors of the software.
	<code class="varname">DISTNAME</code> defaults to
	<code class="literal">${PORTNAME}-${DISTVERSIONPREFIX}${DISTVERSION}${DISTVERSIONSUFFIX}</code>,
	and if not set, <code class="varname">DISTVERSION</code> defaults to
	<code class="literal">${PORTVERSION}</code> so override
	<code class="varname">DISTNAME</code>
	only if necessary.  <code class="varname">DISTNAME</code> is only used
	in two places.  First, the distribution file list
	(<code class="varname">DISTFILES</code>) defaults to
	<code class="literal">${DISTNAME}</code><code class="literal">${EXTRACT_SUFX}</code>.
	Second, the distribution file is expected to extract into a
	subdirectory named <code class="varname">WRKSRC</code>, which defaults
	to <code class="filename">work/${DISTNAME}</code>.</p><p>Some vendor's distribution names which do not fit into the
	<code class="literal">${PORTNAME}-${PORTVERSION}</code>-scheme can be
	handled automatically by setting
	<code class="varname">DISTVERSIONPREFIX</code>,
	<code class="varname">DISTVERSION</code>, and
	<code class="varname">DISTVERSIONSUFFIX</code>.
	<code class="varname">PORTVERSION</code> will be derived from
	<code class="varname">DISTVERSION</code> automatically.</p><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml">Only one of <code class="varname">PORTVERSION</code> and
	  <code class="varname">DISTVERSION</code> can be set at a time.  If
	  <code class="varname">DISTVERSION</code> does not derive a correct
	  <code class="varname">PORTVERSION</code>, do not use
	  <code class="varname">DISTVERSION</code>.</p></div><p>If the upstream version scheme can be derived into a
	ports-compatible version scheme, set some variable to the
	upstream version, <span class="emphasis"><em>do not</em></span> use
	<code class="varname">DISTVERSION</code> as the variable name.  Set
	<code class="varname">PORTVERSION</code> to the computed version based
	on the variable you
	created, and set <code class="varname">DISTNAME</code>
	accordingly.</p><p>If the upstream version scheme cannot easily be coerced
	into a ports-compatible value, set
	<code class="varname">PORTVERSION</code> to a sensible value, and set
	<code class="varname">DISTNAME</code> with <code class="varname">PORTNAME</code>
	with the verbatim upstream version.</p><div class="example"><a id="makefile-distname-ex1"></a><div class="example-title">Example 5.6. Deriving <code class="varname">PORTVERSION</code>
	  Manually</div><div class="example-contents"><p><span class="application">BIND9</span> uses a version scheme
	  that is not compatible with the ports versions (it has
	  <code class="literal">-</code> in its versions) and cannot be derived
	  using <code class="varname">DISTVERSION</code> because after the 9.9.9
	  release, it will release a <span class="quote">&#8220;<span class="quote">patchlevels</span>&#8221;</span> in the
	  form of <code class="literal">9.9.9-P1</code>.  DISTVERSION would
	  translate that into <code class="literal">9.9.9.p1</code>, which, in
	  the ports versioning scheme means 9.9.9 pre-release 1, which
	  is before 9.9.9 and not after.  So
	  <code class="varname">PORTVERSION</code> is manually derived from an
	  <code class="varname">ISCVERSION</code> variable to output
	  <code class="literal">9.9.9p1</code>.</p><p>The order into which the ports framework, and pkg, will
	  sort versions is checked using the <code class="literal">-t</code>
	  argument of <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=pkg-version&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">pkg-version</span>(8)</span></a>:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>pkg version -t 9.9.9 9.9.9.p1</code></strong>
&gt; <a id="distversion-ex1-gt"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
<code class="prompt">%</code> <strong class="userinput"><code>pkg version -t 9.9.9 9.9.9p1</code></strong>
&lt; <a id="distversion-ex1-lt"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#distversion-ex1-gt"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>The <code class="literal">&gt;</code> sign means that the
	      first argument passed to <code class="literal">-t</code> is
	      greater than the second argument.
	      <code class="literal">9.9.9</code> is after
	      <code class="literal">9.9.9.p1</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#distversion-ex1-lt"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>The <code class="literal">&lt;</code> sign means that the
	      first argument passed to <code class="literal">-t</code> is less
	      than the second argument.  <code class="literal">9.9.9</code> is
	      before <code class="literal">9.9.9p1</code>.</p></td></tr></table></div><p>In the port <code class="filename">Makefile</code>, for example
	  <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/dns/bind99/pkg-descr">dns/bind99</a>, it is achieved
	  by:</p><pre class="programlisting">PORTNAME=	bind
PORTVERSION=	${ISCVERSION:S/-P/P/:S/b/.b/:S/a/.a/:S/rc/.rc/} <a id="distversion-ex1-portversion"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span>
CATEGORIES=	dns net
MASTER_SITES=	ISC/bind9/${ISCVERSION} <a id="distversion-ex1-master_sites"></a><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span>
PKGNAMESUFFIX=	99
DISTNAME=	${PORTNAME}-${ISCVERSION} <a id="distversion-ex1-distname"></a><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span>

MAINTAINER=	mat@FreeBSD.org
COMMENT=	BIND DNS suite with updated DNSSEC and DNS64

LICENSE=	ISCL

# ISC releases things like 9.8.0-P1 or 9.8.1rc1, which our versioning does not like
ISCVERSION=	9.9.9-P6 <a id="distversion-ex1-iscversion"></a><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#distversion-ex1-iscversion"><span><img src="./imagelib/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Define upstream version in
	      <code class="varname">ISCVERSION</code>, with a comment saying
	      <span class="emphasis"><em>why</em></span> it is needed.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#distversion-ex1-portversion"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Use <code class="varname">ISCVERSION</code> to get a
	      ports-compatible <code class="varname">PORTVERSION</code>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#distversion-ex1-master_sites"><span><img src="./imagelib/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Use <code class="varname">ISCVERSION</code> directly to get
	      the correct <acronym class="acronym">URL</acronym> for fetching the
	      distribution file.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#distversion-ex1-distname"><span><img src="./imagelib/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Use <code class="varname">ISCVERSION</code> directly to name
	      the distribution file.</p></td></tr></table></div></div></div><br class="example-break" /><div class="example"><a id="makefile-distname-ex2"></a><div class="example-title">Example 5.7. Derive <code class="varname">DISTNAME</code> from
	  <code class="varname">PORTVERSION</code></div><div class="example-contents"><p>From time to time, the distribution file name has little
	  or no relation to the version of the software.</p><p>In <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/comms/kermit/pkg-descr">comms/kermit</a>, only the
	  last element of the version is present in the distribution
	  file:</p><pre class="programlisting">PORTNAME=	kermit
PORTVERSION=	9.0.304
CATEGORIES=	comms ftp net
MASTER_SITES=	ftp://ftp.kermitproject.org/kermit/test/tar/
DISTNAME=	cku${PORTVERSION:E}-dev20 <a id="distversion-ex2-distname"></a><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#distversion-ex2-distname"><span><img src="./imagelib/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>The <code class="literal">:E</code> <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> modifier
	      returns the suffix of the variable, in this case,
	      <code class="literal">304</code>.  The distribution file is
	      correctly generated as
	      <code class="literal">cku304-dev20.tar.gz</code>.</p></td></tr></table></div></div></div><br class="example-break" /><div class="example"><a id="makefile-distname-ex3"></a><div class="example-title">Example 5.8. Exotic Case 1</div><div class="example-contents"><p>Sometimes, there is no relation between the software
	  name, its version, and the distribution file it is
	  distributed in.</p><p>From <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/audio/libworkman/pkg-descr">audio/libworkman</a>:</p><pre class="programlisting">PORTNAME=       libworkman
PORTVERSION=    1.4
CATEGORIES=     audio
MASTER_SITES=   LOCAL/jim
DISTNAME=       ${PORTNAME}-1999-06-20</pre></div></div><br class="example-break" /><div class="example"><a id="makefile-distname-ex4"></a><div class="example-title">Example 5.9. Exotic Case 2</div><div class="example-contents"><p>In <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/comms/librs232/pkg-descr">comms/librs232</a>, the
	  distribution file is not versioned, so using <a class="link" href="makefile-distfiles.html#makefile-dist_subdir" title="5.4.10. DIST_SUBDIR"><code class="varname">DIST_SUBDIR</code></a>
	  is needed:</p><pre class="programlisting">PORTNAME=       librs232
PORTVERSION=    20160710
CATEGORIES=     comms
MASTER_SITES=   http://www.teuniz.net/RS-232/
DISTNAME=       RS-232
DIST_SUBDIR=	${PORTNAME}-${PORTVERSION}</pre></div></div><br class="example-break" /><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">PKGNAMEPREFIX</code> and
	  <code class="varname">PKGNAMESUFFIX</code> do not affect
	  <code class="varname">DISTNAME</code>.  Also note that if
	  <code class="varname">WRKSRC</code> is equal to
	  <code class="filename">${WRKDIR}/${DISTNAME}</code> while
	  the original source archive is named something other than
	  <code class="literal">${PORTNAME}-${PORTVERSION}${EXTRACT_SUFX}</code>,
	  leave <code class="varname">DISTNAME</code>
	  alone&#8212; defining only
	  <code class="varname">DISTFILES</code> is easier than both
	  <code class="varname">DISTNAME</code> and <code class="varname">WRKSRC</code>
	  (and possibly <code class="varname">EXTRACT_SUFX</code>).</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites"></a>5.4.2. <code class="varname">MASTER_SITES</code></h3></div></div></div><p>Record the directory part of the FTP/HTTP-URL pointing at
	the original tarball in <code class="varname">MASTER_SITES</code>.  Do
	not forget the trailing slash (<code class="filename">/</code>)!</p><p>The <code class="command">make</code> macros will try to use this
	specification for grabbing the distribution file with
	<code class="varname">FETCH</code> if they cannot find it already on the
	system.</p><p>It is recommended that multiple sites are included on this
	list, preferably from different continents.  This will
	safeguard against wide-area network problems.</p><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">MASTER_SITES</code> must not be blank.  It
	  must point to the actual site hosting the distribution
	  files.  It cannot point to web archives, or the FreeBSD
	  distribution files cache sites.  The only exception to this
	  rule is ports that do not have any distribution files.  For
	  example, meta-ports do not have any distribution files, so
	  <code class="varname">MASTER_SITES</code> does not need to be
	  set.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-shorthand"></a>5.4.2.1. Using
	  <code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	  Variables</h4></div></div></div><p>Shortcut abbreviations are available for popular
	  archives like SourceForge (<code class="literal">SOURCEFORGE</code>),
	  GNU (<code class="literal">GNU</code>), or Perl CPAN
	  (<code class="literal">PERL_CPAN</code>).
	  <code class="varname">MASTER_SITES</code> can use them
	  directly:</p><pre class="programlisting">MASTER_SITES=	GNU/make</pre><p>The older expanded format still works, but all ports
	  have been converted to the compact format.  The expanded
	  format looks like this:</p><pre class="programlisting">MASTER_SITES=		${MASTER_SITE_GNU}
MASTER_SITE_SUBDIR=	make</pre><p>These values and variables are defined in <a class="link" href="https://svnweb.freebsd.org/ports/head/Mk/bsd.sites.mk?view=markup" target="_top"><code class="filename">Mk/bsd.sites.mk</code></a>.
	  New entries are added often, so make sure to check the
	  latest version of this file before submitting a port.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml">For any
	    <code class="varname">MASTER_SITE_<em class="replaceable"><code>FOO</code></em></code>
	    variable, the shorthand
	    <code class="literal"><em class="replaceable"><code>FOO</code></em></code> can be
	    used.  For example, use:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">MASTER_SITES=	<em class="replaceable"><code>FOO</code></em></pre><p xmlns="http://www.w3.org/1999/xhtml">If <code class="varname">MASTER_SITE_SUBDIR</code> is needed,
	    use this:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">MASTER_SITES=	<em class="replaceable"><code>FOO</code></em>/<em class="replaceable"><code>bar</code></em></pre></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Some
	    <code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	    names are quite long, and for ease of use, shortcuts have
	    been defined:</p><div xmlns="http://www.w3.org/1999/xhtml" class="table"><a id="makefile-master_sites-shortcut"></a><div class="table-title">Table 5.3. Shortcuts for
	      <code class="varname">MASTER_SITE_<em class="replaceable"><code>*</code></em></code>
	      Macros</div><div class="table-contents"><table class="table" summary="Shortcuts for&#10;&#9;      MASTER_SITE_*&#10;&#9;      Macros" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Macro</th><th>Shortcut</th></tr></thead><tbody><tr><td><code class="varname">PERL_CPAN</code></td><td><code class="varname">CPAN</code></td></tr><tr><td><code class="varname">GITHUB</code></td><td><code class="varname">GH</code></td></tr><tr><td><code class="varname">GITHUB_CLOUD</code></td><td><code class="varname">GHC</code></td></tr><tr><td><code class="varname">LIBREOFFICE_DEV</code></td><td><code class="varname">LODEV</code></td></tr><tr><td><code class="varname">NETLIB</code></td><td><code class="varname">NL</code></td></tr><tr><td><code class="varname">RUBYGEMS</code></td><td><code class="varname">RG</code></td></tr><tr><td><code class="varname">SOURCEFORGE</code></td><td><code class="varname">SF</code></td></tr></tbody></table></div></div><br xmlns="http://www.w3.org/1999/xhtml" class="table-break" /></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-magic"></a>5.4.2.2. Magic MASTER_SITES Macros</h4></div></div></div><p>Several <span class="quote">&#8220;<span class="quote">magic</span>&#8221;</span> macros exist for
	  popular sites with a predictable directory structure.  For
	  these, just use the abbreviation and the system will choose
	  a subdirectory automatically.  For a port
	  named <code class="literal">Stardict</code>, of version
	  <code class="literal">1.2.3</code>, and hosted on SourceForge, adding
	  this line:</p><pre class="programlisting">MASTER_SITES=	SF</pre><p>infers a subdirectory named
	  <code class="literal">/project/stardict/stardict/1.2.3</code>.  If the
	  inferred directory is incorrect, it can be
	  overridden:</p><pre class="programlisting">MASTER_SITES=	SF/stardict/WyabdcRealPeopleTTS/${PORTVERSION}</pre><p>This can also be written as</p><pre class="programlisting">MASTER_SITES=	SF
MASTER_SITE_SUBDIR=	stardict/WyabdcRealPeopleTTS/${PORTVERSION}</pre><div class="table"><a id="makefile-master_sites-popular"></a><div class="table-title">Table 5.4. Magic <code class="varname">MASTER_SITES</code>
	    Macros</div><div class="table-contents"><table class="table" summary="Magic MASTER_SITES&#10;&#9;    Macros" border="0"><colgroup><col /><col /></colgroup><thead><tr><th>Macro</th><th>Assumed subdirectory</th></tr></thead><tbody><tr><td><code class="varname">APACHE_COMMONS_BINARIES</code></td><td><code class="literal">${PORTNAME:S,commons-,,}</code></td></tr><tr><td><code class="varname">APACHE_COMMONS_SOURCE</code></td><td><code class="literal">${PORTNAME:S,commons-,,}</code></td></tr><tr><td><code class="varname">APACHE_JAKARTA</code></td><td><code class="literal">${PORTNAME:S,-,/,}/source</code></td></tr><tr><td><code class="varname">BERLIOS</code></td><td><code class="literal">${PORTNAME:tl}.berlios</code></td></tr><tr><td><code class="varname">CHEESESHOP</code></td><td><code class="literal">source/${DISTNAME:C/(.).*/\1/}/${DISTNAME:C/(.*)-[0-9].*/\1/}</code></td></tr><tr><td><code class="varname">CPAN</code></td><td><code class="literal">${PORTNAME:C/-.*//}</code></td></tr><tr><td><code class="varname">DEBIAN</code></td><td><code class="literal">pool/main/${PORTNAME:C/^((lib)?.).*$/\1/}/${PORTNAME}</code></td></tr><tr><td><code class="varname">FARSIGHT</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">FESTIVAL</code></td><td><code class="literal">${PORTREVISION}</code></td></tr><tr><td><code class="varname">GCC</code></td><td><code class="literal">releases/${DISTNAME}</code></td></tr><tr><td><code class="varname">GENTOO</code></td><td><code class="literal">distfiles</code></td></tr><tr><td><code class="varname">GIMP</code></td><td><code class="literal">${PORTNAME}/${PORTVERSION:R}/</code></td></tr><tr><td><code class="varname">GH</code></td><td><code class="literal">${GH_ACCOUNT}/${GH_PROJECT}/tar.gz/${GH_TAGNAME}?dummy=/</code></td></tr><tr><td><code class="varname">GHC</code></td><td><code class="literal">${GH_ACCOUNT}/${GH_PROJECT}/</code></td></tr><tr><td><code class="varname">GNOME</code></td><td><code class="literal">sources/${PORTNAME}/${PORTVERSION:C/^([0-9]+\.[0-9]+).*/\1/}</code></td></tr><tr><td><code class="varname">GNU</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GNUPG</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GNU_ALPHA</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">HORDE</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">LODEV</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">MATE</code></td><td><code class="literal">${PORTVERSION:C/^([0-9]+\.[0-9]+).*/\1/}</code></td></tr><tr><td><code class="varname">MOZDEV</code></td><td><code class="literal">${PORTNAME:tl}</code></td></tr><tr><td><code class="varname">NL</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">QT</code></td><td><code class="literal">archive/qt/${PORTVERSION:R}</code></td></tr><tr><td><code class="varname">SAMBA</code></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">SAVANNAH</code></td><td><code class="literal">${PORTNAME:tl}</code></td></tr><tr><td><code class="varname">SF</code></td><td><code class="literal">${PORTNAME:tl}/${PORTNAME:tl}/${PORTVERSION}</code></td></tr></tbody></table></div></div><br class="table-break" /></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-github"></a>5.4.3. <code class="varname">USE_GITHUB</code></h3></div></div></div><p>If the distribution file comes from a specific commit or
	tag on <a class="link" href="https://github.com" target="_top">GitHub</a>
	for which there is no officially released file, there is an
	easy way to set the right <code class="varname">DISTNAME</code> and
	<code class="varname">MASTER_SITES</code> automatically.  These
	variables are available:</p><div class="table"><a id="makefile-master_sites-github-description"></a><div class="table-title">Table 5.5. <code class="varname">USE_GITHUB</code> Description</div><div class="table-contents"><table class="table" summary="USE_GITHUB Description" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Variable</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code class="varname">GH_ACCOUNT</code></td><td>Account name of the GitHub user hosting the
		project</td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GH_PROJECT</code></td><td>Name of the project on GitHub</td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GH_TAGNAME</code></td><td>Name of the tag to download (2.0.1, hash, ...)
		Using the name of a branch here is incorrect.  It is
		also possible to use the hash of a commit id to do a
		snapshot.</td><td><code class="literal">${DISTVERSIONPREFIX}${DISTVERSION}${DISTVERSIONSUFFIX}</code></td></tr><tr><td><code class="varname">GH_SUBDIR</code></td><td>When the software needs an additional
		distribution file to be extracted within
		<code class="varname">${WRKSRC}</code>, this variable can be
		used.  See the examples in <a class="xref" href="makefile-distfiles.html#makefile-master_sites-github-multiple" title="5.4.3.1. Fetching Multiple Files from GitHub">Section 5.4.3.1, &#8220;Fetching Multiple Files from GitHub&#8221;</a>
		for more information.</td><td>(none)</td></tr><tr><td><code class="varname">GH_TUPLE</code></td><td><code class="varname">GH_TUPLE</code> allows putting
		<code class="varname">GH_ACCOUNT</code>,
		<code class="varname">GH_PROJECT</code>,
		<code class="varname">GH_TAGNAME</code>, and
		<code class="varname">GH_SUBDIR</code> into a single variable.
		The format is
		<em class="replaceable"><code>account</code></em><code class="literal">:</code><em class="replaceable"><code>project</code></em><code class="literal">:</code><em class="replaceable"><code>tagname</code></em><code class="literal">:</code><em class="replaceable"><code>group</code></em><code class="literal">/</code><em class="replaceable"><code>subdir</code></em>.
		The
		<code class="literal">/</code><em class="replaceable"><code>subdir</code></em>
		part is optional.  It is helpful when there is more
		than one GitHub project from which to fetch.</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break" /><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml">Do not use <code class="varname">GH_TUPLE</code> for the default
	  distribution file, as it has no default.</p></div><div class="example"><a id="makefile-master_sites-github-ex1"></a><div class="example-title">Example 5.10. Simple Use of <code class="varname">USE_GITHUB</code></div><div class="example-contents"><p>While trying to make a port for version
	  <code class="literal">1.2.7</code> of <span class="application">pkg</span>
	  from the FreeBSD user on github, at <a class="link" href="https://github.com/freebsd/pkg" target="_top">https://github.com/freebsd/pkg</a>, The
	  <code class="filename">Makefile</code> would end up looking like
	  this (slightly stripped for the example):</p><pre class="programlisting">PORTNAME=	pkg
DISTVERSION=	1.2.7

USE_GITHUB=	yes
GH_ACCOUNT=	freebsd</pre><p>It will automatically have
	  <code class="varname">MASTER_SITES</code> set to <code class="literal">GH
	    GHC</code> and <code class="varname">WRKSRC</code> to
	  <code class="literal">${WRKDIR}/pkg-1.2.7</code>.</p></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-ex2"></a><div class="example-title">Example 5.11. More Complete Use of
	  <code class="varname">USE_GITHUB</code></div><div class="example-contents"><p>While trying to make a port for the bleeding edge
	  version of <span class="application">pkg</span> from the FreeBSD
	  user on github, at <a class="link" href="https://github.com/freebsd/pkg" target="_top">https://github.com/freebsd/pkg</a>, the
	  <code class="filename">Makefile</code> ends up looking like
	  this (slightly stripped for the example):</p><pre class="programlisting">PORTNAME=	pkg-devel
DISTVERSION=	1.3.0.a.20140411

USE_GITHUB=	yes
GH_ACCOUNT=	freebsd
GH_PROJECT=	pkg
GH_TAGNAME=	6dbb17b</pre><p>It will automatically have
	  <code class="varname">MASTER_SITES</code> set to <code class="literal">GH
	    GHC</code> and <code class="varname">WRKSRC</code> to
	  <code class="literal">${WRKDIR}/pkg-6dbb17b</code>.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="literal">20140411</code> is the date of the
	    commit referenced in <code class="varname">GH_TAGNAME</code>, not
	    the date the <code class="filename">Makefile</code> is edited, or
	    the date the commit is made.</p></div></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-ex3"></a><div class="example-title">Example 5.12. Use of <code class="varname">USE_GITHUB</code> with
	  <code class="varname">DISTVERSIONPREFIX</code></div><div class="example-contents"><p>From time to time, <code class="varname">GH_TAGNAME</code> is a
	  slight variation from <code class="varname">DISTVERSION</code>.
	  For example, if the version is <code class="literal">1.0.2</code>,
	  the tag is <code class="literal">v1.0.2</code>.  In those cases, it
	  is possible to use <code class="varname">DISTVERSIONPREFIX</code> or
	  <code class="varname">DISTVERSIONSUFFIX</code>:</p><pre class="programlisting">PORTNAME=	foo
DISTVERSIONPREFIX=	v
DISTVERSION=	1.0.2

USE_GITHUB=	yes</pre><p>It will automatically set
	  <code class="varname">GH_TAGNAME</code> to
	  <code class="literal">v1.0.2</code>, while <code class="varname">WRKSRC</code>
	  will be kept to
	  <code class="varname">${WRKDIR}/foo-1.0.2</code>.</p></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-ex4"></a><div class="example-title">Example 5.13. Using <code class="varname">USE_GITHUB</code> When Upstream Does
	  Not Use Versions</div><div class="example-contents"><p>If there never was a version upstream, do not invent one
	  like <code class="literal">0.1</code> or <code class="literal">1.0</code>.
	  Create the port with a <code class="varname">DISTVERSION</code> of
	  <code class="literal">g<em class="replaceable"><code>YYYY</code></em><em class="replaceable"><code>MM</code></em><em class="replaceable"><code>DD</code></em></code>,
	  where <code class="literal">g</code> is for
	  <span class="application">Git</span>, and
	  <code class="literal"><em class="replaceable"><code>YYYY</code></em><em class="replaceable"><code>MM</code></em><em class="replaceable"><code>DD</code></em></code>
	  represents the date the commit referenced in
	  <code class="varname">GH_TAGNAME</code>.</p><pre class="programlisting">PORTNAME=	bar
DISTVERSION=	g20140411

USE_GITHUB=	yes
GH_TAGNAME=	c472d66b</pre><p>This creates a versioning scheme that increases over
	  time, and that is still before version <code class="literal">0</code>
	  (see <a class="xref" href="makefile-naming.html#makefile-versions-ex-pkg-version" title="Example 5.1. Using pkg-version(8) to Compare Versions.">Example 5.1, &#8220;Using pkg-version(8) to Compare Versions.&#8221;</a> for
	  details on <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=pkg-version&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">pkg-version</span>(8)</span></a>):</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>pkg version -t g20140411 0</code></strong>
&lt;</pre><p>Which means using <code class="varname">PORTEPOCH</code> will not
	  be needed in case upstream decides to cut versions in the
	  future.</p></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-ex5"></a><div class="example-title">Example 5.14. Using <code class="varname">USE_GITHUB</code> to Access
	  a Commit Between Two Versions</div><div class="example-contents"><p>If the current version of the software uses a
	  <span class="application">Git</span> tag, and the port needs to be
	  updated to a newer, intermediate version, without a tag, use
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=git-describe&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">git-describe</span>(1)</span></a> to find out the version to use:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>git describe --tags <em class="replaceable"><code>f0038b1</code></em></code></strong>
v0.7.3-14-gf0038b1</pre><p><code class="literal">v0.7.3-14-gf0038b1</code> can be split into
	  three parts:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">v0.7.3</code></span></dt><dd><p>This is the last <span class="application">Git</span>
		tag that appears in the commit history before the
		requested commit.</p></dd><dt><span class="term"><code class="literal">-14</code></span></dt><dd><p>This means that the requested commit,
		<code class="literal">f0038b1</code>, is the 14th commit after
		the <code class="literal">v0.7.3</code> tag.</p></dd><dt><span class="term"><code class="literal">-gf0038b1</code></span></dt><dd><p>The <code class="literal">-g</code> means
		<span class="quote">&#8220;<span class="quote"><span class="application">Git</span></span>&#8221;</span>, and
		the <code class="literal">f0038b1</code> is the commit hash
		that this reference points to.</p></dd></dl></div><pre class="programlisting">PORTNAME=	bar
DISTVERSIONPREFIX=  v
DISTVERSION=	0.7.3-14
DISTVERSIONSUFFIX=  -gf0038b1

USE_GITHUB=	yes</pre><p>This creates a versioning scheme that increases over
	  time (well, over commits), and does not conflict with the
	  creation of a <code class="literal">0.7.4</code> version.
	  (See <a class="xref" href="makefile-naming.html#makefile-versions-ex-pkg-version" title="Example 5.1. Using pkg-version(8) to Compare Versions.">Example 5.1, &#8220;Using pkg-version(8) to Compare Versions.&#8221;</a> for
	  details on <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=pkg-version&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">pkg-version</span>(8)</span></a>):</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>pkg version -t 0.7.3 0.7.3.14</code></strong>
&lt;
<code class="prompt">%</code> <strong class="userinput"><code>pkg version -t 0.7.3.14 0.7.4</code></strong>
&lt;</pre><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">If the requested commit is the same as a tag, a
	    shorter description is shown by default.  The longer
	    version is equivalent:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="screen"><code class="prompt">%</code> <strong class="userinput"><code>git describe --tags <em class="replaceable"><code>c66c71d</code></em></code></strong>
v0.7.3
<code class="prompt">%</code> <strong class="userinput"><code>git describe --tags --long <em class="replaceable"><code>c66c71d</code></em></code></strong>
v0.7.3-0-gc66c71d</pre></div></div></div><br class="example-break" /><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-github-multiple"></a>5.4.3.1. Fetching Multiple Files from GitHub</h4></div></div></div><p>The <code class="varname">USE_GITHUB</code> framework also
	  supports fetching multiple distribution files from
	  different places in GitHub.  It works in a way very
	  similar to <a class="xref" href="makefile-distfiles.html#porting-master-sites-n" title="5.4.9. Multiple Distribution or Patches Files from Multiple Locations">Section 5.4.9, &#8220;Multiple Distribution or Patches Files from Multiple
	Locations&#8221;</a>.</p><p>Multiple values are added to
	  <code class="varname">GH_ACCOUNT</code>,
	  <code class="varname">GH_PROJECT</code>, and
	  <code class="varname">GH_TAGNAME</code>.  Each different value is
	  assigned a group.  The main value can either have no group,
	  or the <code class="literal">:DEFAULT</code> group.  A value can be
	  omitted if it is the same as the default as listed in
	  <a class="xref" href="makefile-distfiles.html#makefile-master_sites-github-description" title="Table 5.5. USE_GITHUB Description">Table 5.5, &#8220;<code class="varname">USE_GITHUB</code> Description&#8221;</a>.</p><p><code class="varname">GH_TUPLE</code> can also be used when there
	  are a lot of distribution files.  It helps keep the account,
	  project, tagname, and group information at the same
	  place.</p><p>For each group, a
	  <code class="varname">${WRKSRC_<em class="replaceable"><code>group</code></em>}</code>
	  helper variable is created, containing the directory into
	  which the file has been extracted.  The
	  <code class="varname">${WRKSRC_<em class="replaceable"><code>group</code></em>}</code>
	  variables can be used to move directories around during
	  <code class="buildtarget">post-extract</code>, or add to
	  <code class="varname">CONFIGURE_ARGS</code>, or whatever is needed
	  so that the software builds correctly.</p><div xmlns="" class="caution"><h3 class="admontitle">Caution: </h3><p xmlns="http://www.w3.org/1999/xhtml">The
	    <code class="literal">:<em class="replaceable"><code>group</code></em></code> part
	    <span class="emphasis"><em>must</em></span> be used for <span class="emphasis"><em>only
	      one</em></span> distribution file.  It is used as a
	    unique key and using it more than once will overwrite the
	    previous values.</p></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">As this is only syntactic sugar above
	    <code class="varname">DISTFILES</code> and
	    <code class="varname">MASTER_SITES</code>, the group names must
	    adhere to the restrictions on group names outlined in
	    <a class="xref" href="makefile-distfiles.html#porting-master-sites-n" title="5.4.9. Multiple Distribution or Patches Files from Multiple Locations">Section 5.4.9, &#8220;Multiple Distribution or Patches Files from Multiple
	Locations&#8221;</a></p></div><p>When fetching multiple files from GitHub, sometimes the
	  default distribution file is not fetched from GitHub.  To disable
	  fetching the default distribution, set:</p><pre class="programlisting">USE_GITHUB=	nodefault</pre><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml">When using <code class="literal">USE_GITHUB=nodefault</code>,
	    the <code class="filename">Makefile</code> must set
	    <code class="varname">DISTFILES</code> in its
	    <a class="link" href="porting-order.html#porting-order-portname" title="15.1. PORTNAME Block">top block</a>.
	    The definition should be:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">DISTFILES=    ${DISTNAME}${EXTRACT_SUFX}</pre></div><div class="example"><a id="makefile-master_sites-github-multi"></a><div class="example-title">Example 5.15. Use of <code class="varname">USE_GITHUB</code> with Multiple
	    Distribution Files</div><div class="example-contents"><p>From time to time, there is a need to fetch more
	    than one distribution file.  For example, when the
	    upstream git repository uses submodules.  This can be
	    done easily using groups in the
	    <code class="varname">GH_<em class="replaceable"><code>*</code></em></code>
	    variables:</p><pre class="programlisting">PORTNAME=	foo
DISTVERSION=	1.0.2

USE_GITHUB=	yes
GH_ACCOUNT=	bar:icons,contrib
GH_PROJECT=	foo-icons:icons foo-contrib:contrib
GH_TAGNAME=	1.0:icons fa579bc:contrib
GH_SUBDIR=	ext/icons:icons

CONFIGURE_ARGS=	--with-contrib=${WRKSRC_contrib}</pre><p>This will fetch three distribution files from
	    github.  The default one comes from
	    <code class="filename">foo/foo</code> and is version
	    <code class="literal">1.0.2</code>.  The second one, with the
	    <code class="literal">icons</code> group, comes from
	    <code class="filename">bar/foo-icons</code> and is in version
	    <code class="literal">1.0</code>.  The third one comes from
	    <code class="filename">bar/foo-contrib</code> and uses the
	    <span class="application">Git</span> commit
	    <code class="literal">fa579bc</code>.  The distribution files are
	    named <code class="filename">foo-foo-1.0.2_GH0.tar.gz</code>,
	    <code class="filename">bar-foo-icons-1.0_GH0.tar.gz</code>, and
	    <code class="filename">bar-foo-contrib-fa579bc_GH0.tar.gz</code>.</p><p>All the distribution files are extracted in
	    <code class="varname">${WRKDIR}</code> in their respective
	    subdirectories.  The default file is still extracted in
	    <code class="varname">${WRKSRC}</code>, in this case,
	    <code class="filename">${WRKDIR}/foo-1.0.2</code>.  Each
	    additional distribution file is extracted in
	    <code class="varname">${WRKSRC_<em class="replaceable"><code>group</code></em>}</code>.
	    Here, for the <code class="literal">icons</code> group, it is called
	    <code class="varname">${WRKSRC_icons}</code> and it contains
	    <code class="filename">${WRKDIR}/foo-icons-1.0</code>.  The file
	    with the <code class="literal">contrib</code> group is called
	    <code class="varname">${WRKSRC_contrib}</code> and contains
	    <code class="literal">${WRKDIR}/foo-contrib-fa579bc</code>.</p><p>The software's build system expects to find the icons
	    in a <code class="filename">ext/icons</code> subdirectory in its
	    sources, so <code class="varname">GH_SUBDIR</code> is used.
	    <code class="varname">GH_SUBDIR</code> makes sure that
	    <code class="filename">ext</code> exists, but that
	    <code class="filename">ext/icons</code> does not already exist.
	    Then it does this:</p><pre class="programlisting">post-extract:
      @${MV} ${WRKSRC_icons} ${WRKSRC}/ext/icons</pre></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-multi2"></a><div class="example-title">Example 5.16. Use of <code class="varname">USE_GITHUB</code> with Multiple
	    Distribution Files Using
	    <code class="varname">GH_TUPLE</code></div><div class="example-contents"><p>This is functionally equivalent to <a class="xref" href="makefile-distfiles.html#makefile-master_sites-github-multi" title="Example 5.15. Use of USE_GITHUB with Multiple Distribution Files">Example 5.15, &#8220;Use of <code class="varname">USE_GITHUB</code> with Multiple
	    Distribution Files&#8221;</a>, but
	    using <code class="varname">GH_TUPLE</code>:</p><pre class="programlisting">PORTNAME=	foo
DISTVERSION=	1.0.2

USE_GITHUB=	yes
GH_TUPLE=	bar:foo-icons:1.0:icons/ext/icons \
		bar:foo-contrib:fa579bc:contrib

CONFIGURE_ARGS=	--with-contrib=${WRKSRC_contrib}</pre><p>Grouping was used in the previous example with
	    <code class="literal">bar:icons,contrib</code>.  Some redundant
	    information is present with <code class="varname">GH_TUPLE</code>
	    because grouping is not possible.</p></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-github-submodules"></a><div class="example-title">Example 5.17. How to Use <code class="varname">USE_GITHUB</code> with
	    <span class="application">Git</span> Submodules?</div><div class="example-contents"><p>Ports with GitHub as an upstream repository sometimes
	    use submodules.  See <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=git-submodule&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">git-submodule</span>(1)</span></a> for more
	    information.</p><p>The problem with submodules is that each is a separate
	    repository.  As such, they each must be fetched
	    separately.</p><p>Using <a xmlns="" class="package" href="https://www.freebsd.org/cgi/url.cgi?ports/finance/moneymanagerex/pkg-descr">finance/moneymanagerex</a> as an
	    example, its GitHub repository is <a class="link" href="https://github.com/moneymanagerex/moneymanagerex" target="_top">https://github.com/moneymanagerex/moneymanagerex</a>.
	    It has a <a class="link" href="https://github.com/moneymanagerex/moneymanagerex/blob/master/.gitmodules" target="_top"><code class="filename">.gitmodules</code></a>
	    file at the root.  This file describes all the submodules
	    used in this repository, and lists additional repositories
	    needed.  This file will tell what additional repositories
	    are needed:</p><pre class="programlisting">[submodule "lib/wxsqlite3"]
	path = lib/wxsqlite3
	url = https://github.com/utelle/wxsqlite3.git
[submodule "3rd/mongoose"]
	path = 3rd/mongoose
	url = https://github.com/cesanta/mongoose.git
[submodule "3rd/LuaGlue"]
	path = 3rd/LuaGlue
	url = https://github.com/moneymanagerex/LuaGlue.git
[submodule "3rd/cgitemplate"]
	path = 3rd/cgitemplate
	url = https://github.com/moneymanagerex/html-template.git
[...]</pre><p>The only information missing from that file is the
	    commit hash or tag to use as a version.  This information
	    is found after cloning the repository:</p><pre class="screen"><code class="prompt">%</code> <strong class="userinput"><code>git clone --recurse-submodules https://github.com/moneymanagerex/moneymanagerex.git</code></strong>
Cloning into 'moneymanagerex'...
remote: Counting objects: 32387, done.
[...]
Submodule '3rd/LuaGlue' (https://github.com/moneymanagerex/LuaGlue.git) registered for path '3rd/LuaGlue'
Submodule '3rd/cgitemplate' (https://github.com/moneymanagerex/html-template.git) registered for path '3rd/cgitemplate'
Submodule '3rd/mongoose' (https://github.com/cesanta/mongoose.git) registered for path '3rd/mongoose'
Submodule 'lib/wxsqlite3' (https://github.com/utelle/wxsqlite3.git) registered for path 'lib/wxsqlite3'
[...]
Cloning into '/home/mat/work/freebsd/ports/finance/moneymanagerex/moneymanagerex/3rd/LuaGlue'...
Cloning into '/home/mat/work/freebsd/ports/finance/moneymanagerex/moneymanagerex/3rd/cgitemplate'...
Cloning into '/home/mat/work/freebsd/ports/finance/moneymanagerex/moneymanagerex/3rd/mongoose'...
Cloning into '/home/mat/work/freebsd/ports/finance/moneymanagerex/moneymanagerex/lib/wxsqlite3'...
[...]
Submodule path '3rd/LuaGlue': checked out 'c51d11a247ee4d1e9817dfa2a8da8d9e2f97ae3b'
Submodule path '3rd/cgitemplate': checked out 'cd434eeeb35904ebcd3d718ba29c281a649b192c'
Submodule path '3rd/mongoose': checked out '2140e5992ab9a3a9a34ce9a281abf57f00f95cda'
Submodule path 'lib/wxsqlite3': checked out 'fb66eb230d8aed21dec273b38c7c054dcb7d6b51'
[...]
<code class="prompt">%</code> <strong class="userinput"><code>cd moneymanagerex</code></strong>
<code class="prompt">%</code> <strong class="userinput"><code>git submodule status</code></strong>
 c51d11a247ee4d1e9817dfa2a8da8d9e2f97ae3b 3rd/LuaGlue (heads/master)
 cd434eeeb35904ebcd3d718ba29c281a649b192c 3rd/cgitemplate (cd434ee)
 2140e5992ab9a3a9a34ce9a281abf57f00f95cda 3rd/mongoose (6.2-138-g2140e59)
 fb66eb230d8aed21dec273b38c7c054dcb7d6b51 lib/wxsqlite3 (v3.4.0)
[...]</pre><p>It can also be found on GitHub.  Each subdirectory
	    that is a submodule is shown as
	    <em class="replaceable"><code>directory</code></em><code class="literal"> @ </code><em class="replaceable"><code>hash</code></em>,
	    for example,
	    <code class="literal">mongoose @ 2140e59</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">While getting the information from GitHub seems more
	      straightforward, the information found using
	      <code class="command">git submodule status</code> will provide
	      more meaningful information.  For example, here,
	      <code class="literal">lib/wxsqlite3</code>'s commit hash
	      <code class="literal">fb66eb2</code> correspond to
	      <code class="literal">v3.4.0</code>.  Both can be used
	      interchangeably, but when a tag is available, use
	      it.</p></div><p>Now that all the required information has been
	    gathered, the <code class="filename">Makefile</code> can be written
	    (only GitHub-related lines are shown):</p><pre class="programlisting">PORTNAME=	moneymanagerex
DISTVERSIONPREFIX=	v
DISTVERSION=	1.3.0

USE_GITHUB=	yes
GH_TUPLE=	utelle:wxsqlite3:v3.4.0:wxsqlite3/lib/wxsqlite3 \
		moneymanagerex:LuaGlue:c51d11a:lua_glue/3rd/LuaGlue \
		moneymanagerex:html-template:cd434ee:html_template/3rd/cgitemplate \
		cesanta:mongoose:2140e59:mongoose/3rd/mongoose \
		[...]</pre></div></div><br class="example-break" /></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-gitlab"></a>5.4.4. <code class="varname">USE_GITLAB</code></h3></div></div></div><p>Similar to GitHub, if the distribution file comes from
        <a class="link" href="https://gitlab.com" target="_top">gitlab.com</a>
        or is hosting the <span class="application">GitLab</span>
        software, these variables are available for use and might
        need to be set.</p><div class="table"><a id="makefile-master_sites-gitlab-description"></a><div class="table-title">Table 5.6. <code class="varname">USE_GITLAB</code> Description</div><div class="table-contents"><table class="table" summary="USE_GITLAB Description" border="1"><colgroup><col /><col /><col /></colgroup><thead><tr><th>Variable</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code class="varname">GL_SITE</code></td><td>Site name hosting the <span class="application">GitLab</span>
              project</td><td>https://gitlab.com</td></tr><tr><td><code class="varname">GL_ACCOUNT</code></td><td>Account name of the <span class="application">GitLab</span>
              user hosting the project</td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GL_PROJECT</code></td><td>Name of the project on <span class="application">GitLab</span></td><td><code class="literal">${PORTNAME}</code></td></tr><tr><td><code class="varname">GL_COMMIT</code></td><td>The commit hash to download. Must be the full
                160 bit, 40 character hex sha1 hash. This is a required
                variable for <span class="application">GitLab</span>.</td><td><code class="literal">(none)</code></td></tr><tr><td><code class="varname">GL_SUBDIR</code></td><td>When the software needs an additional
                distribution file to be extracted within
                <code class="varname">${WRKSRC}</code>, this variable can be
                used.  See the examples in <a class="xref" href="makefile-distfiles.html#makefile-master_sites-gitlab-multiple" title="5.4.4.1. Fetching Multiple Files from GitLab">Section 5.4.4.1, &#8220;Fetching Multiple Files from <span class="application">GitLab</span>&#8221;</a>
                for more information.</td><td>(none)</td></tr><tr><td><code class="varname">GL_TUPLE</code></td><td><code class="varname">GL_TUPLE</code> allows putting
                <code class="varname">GL_SITE</code>,
                <code class="varname">GL_ACCOUNT</code>,
                <code class="varname">GL_PROJECT</code>,
                <code class="varname">GL_COMMIT</code>, and
                <code class="varname">GL_SUBDIR</code> into a single variable.
                The format is
                <em class="replaceable"><code>site</code></em><code class="literal">:</code><em class="replaceable"><code>account</code></em><code class="literal">:</code><em class="replaceable"><code>project</code></em><code class="literal">:</code><em class="replaceable"><code>commit</code></em><code class="literal">:</code><em class="replaceable"><code>group</code></em><code class="literal">/</code><em class="replaceable"><code>subdir</code></em>.
                The <em class="replaceable"><code>site</code></em><code class="literal">:</code> and
                <code class="literal">/</code><em class="replaceable"><code>subdir</code></em>
                part is optional. It is helpful when there are more
                than one <span class="application">GitLab</span> project from
                which to fetch.</td><td class="auto-generated"> </td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="makefile-master_sites-gitlab-ex1"></a><div class="example-title">Example 5.18. Simple Use of <code class="varname">USE_GITLAB</code></div><div class="example-contents"><p>While trying to make a port for version
          <code class="literal">1.14</code> of <span class="application">libsignon-glib</span>
          from the accounts-sso user on gitlab.com, at <a class="link" href="https://gitlab.com/accounts-sso/libsignon-glib" target="_top">https://gitlab.com/accounts-sso/libsignon-glib</a>, The
          <code class="filename">Makefile</code> would end up looking like
          this for fetching the distribution files:</p><pre class="programlisting">PORTNAME=	libsignon-glib
DISTVERSION=	1.14

USE_GITLAB=	yes
GL_ACCOUNT=	accounts-sso
GL_COMMIT=	e90302e342bfd27bc8c9132ab9d0ea3d8723fd03</pre><p>It will automatically have
          <code class="varname">MASTER_SITES</code> set to <a class="link" href="https://gitlab.com" target="_top">gitlab.com</a>
          and <code class="varname">WRKSRC</code> to
          <code class="literal">${WRKDIR}/libsignon-glib-e90302e342bfd27bc8c9132ab9d0ea3d8723fd03-e90302e342bfd27bc8c9132ab9d0ea3d8723fd03</code>.</p></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-gitlab-ex2"></a><div class="example-title">Example 5.19. More Complete Use of
          <code class="varname">USE_GITLAB</code></div><div class="example-contents"><p>A more complete use of the above if
          port had no versioning and <span class="application">foobar</span>
          from the foo user on project bar on a self hosted <span class="application">GitLab</span>
          site <code class="literal">https://gitlab.example.com</code>, the <code class="filename">Makefile</code>
          ends up looking like this for fetching distribution files:</p><pre class="programlisting">PORTNAME=	foobar
DISTVERSION=	g20170906

USE_GITLAB=	yes
GL_SITE=	https://gitlab.example.com
GL_ACCOUNT=	foo
GL_PROJECT=	bar
GL_COMMIT=	9c1669ce60c3f4f5eb43df874d7314483fb3f8a6</pre><p>It will have <code class="varname">MASTER_SITES</code> set to
          "<code class="literal">https://gitlab.example.com</code>" and <code class="varname">WRKSRC</code> to
          <code class="literal">${WRKDIR}/bar-9c1669ce60c3f4f5eb43df874d7314483fb3f8a6-9c1669ce60c3f4f5eb43df874d7314483fb3f8a6</code>.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="literal">20170906</code> is the date of the
            commit referenced in <code class="varname">GL_COMMIT</code>, not
            the date the <code class="filename">Makefile</code> is edited, or
            the date the commit to the FreeBSD ports tree is made.</p></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml"><code class="varname">GL_SITE</code>'s protocol, port and
            webroot can all be modified in the same variable.</p></div></div></div><br class="example-break" /><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-master_sites-gitlab-multiple"></a>5.4.4.1. Fetching Multiple Files from <span class="application">GitLab</span></h4></div></div></div><p>The <code class="varname">USE_GITLAB</code> framework also
            supports fetching multiple distribution files from
            different places from <span class="application">GitLab</span>
            and <span class="application">GitLab</span> hosted sites. It
            works in a way very similar to <a class="xref" href="makefile-distfiles.html#porting-master-sites-n" title="5.4.9. Multiple Distribution or Patches Files from Multiple Locations">Section 5.4.9, &#8220;Multiple Distribution or Patches Files from Multiple
	Locations&#8221;</a> and <a class="xref" href="makefile-distfiles.html#makefile-master_sites-gitlab-multiple" title="5.4.4.1. Fetching Multiple Files from GitLab">Section 5.4.4.1, &#8220;Fetching Multiple Files from <span class="application">GitLab</span>&#8221;</a>.</p><p>Multiple values are added to
            <code class="varname">GL_SITE</code>,
            <code class="varname">GL_ACCOUNT</code>,
            <code class="varname">GL_PROJECT</code> and
            <code class="varname">GL_COMMIT</code>.  Each different value is
            assigned a group.
            <a class="xref" href="makefile-distfiles.html#makefile-master_sites-gitlab-description" title="Table 5.6. USE_GITLAB Description">Table 5.6, &#8220;<code class="varname">USE_GITLAB</code> Description&#8221;</a>.</p><p><code class="varname">GL_TUPLE</code> can also be used when there
            are a lot of distribution files.  It helps keep the site,
            account, project, commit, and group information at the same
            place.</p><p>For each group, a
            <code class="varname">${WRKSRC_<em class="replaceable"><code>group</code></em>}</code>
            helper variable is created, containing the directory into
            which the file has been extracted.  The
            <code class="varname">${WRKSRC_<em class="replaceable"><code>group</code></em>}</code>
            variables can be used to move directories around during
            <code class="buildtarget">post-extract</code>, or add to
            <code class="varname">CONFIGURE_ARGS</code>, or whatever is needed
            so that the software builds correctly.</p><div xmlns="" class="caution"><h3 class="admontitle">Caution: </h3><p xmlns="http://www.w3.org/1999/xhtml">The
              <code class="literal">:<em class="replaceable"><code>group</code></em></code> part
              <span class="emphasis"><em>must</em></span> be used for <span class="emphasis"><em>only
              one</em></span> distribution file.  It is used as a
              unique key and using it more than once will overwrite the
              previous values.</p></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">As this is only syntactic sugar above
              <code class="varname">DISTFILES</code> and
              <code class="varname">MASTER_SITES</code>, the group names must
              adhere to the restrictions on group names outlined in
              <a class="xref" href="makefile-distfiles.html#porting-master-sites-n" title="5.4.9. Multiple Distribution or Patches Files from Multiple Locations">Section 5.4.9, &#8220;Multiple Distribution or Patches Files from Multiple
	Locations&#8221;</a></p></div><p>When fetching multiple files using <span class="application">GitLab</span>,
	  sometimes the default distribution file is not fetched from a <span class="application">GitLab</span>
	  site.  To disable fetching the default distribution, set:</p><pre class="programlisting">USE_GITLAB=	nodefault</pre><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml">When using <code class="literal">USE_GITLAB=nodefault</code>,
	    the <code class="filename">Makefile</code> must set
	    <code class="varname">DISTFILES</code> in its
	    <a class="link" href="porting-order.html#porting-order-portname" title="15.1. PORTNAME Block">top block</a>.
	    The definition should be:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">DISTFILES=    ${DISTNAME}${EXTRACT_SUFX}</pre></div><div class="example"><a id="makefile-master_sites-gitlab-multi"></a><div class="example-title">Example 5.20. Use of <code class="varname">USE_GITLAB</code> with Multiple
            Distribution Files</div><div class="example-contents"><p>From time to time, there is a need to fetch more
              than one distribution file.  For example, when the
              upstream git repository uses submodules.  This can be
              done easily using groups in the
              <code class="varname">GL_<em class="replaceable"><code>*</code></em></code>
              variables:</p><pre class="programlisting">PORTNAME=	foo
DISTVERSION=	1.0.2

USE_GITLAB=	yes
GL_SITE=	https://gitlab.example.com:9434/gitlab:icons
GL_ACCOUNT=	bar:icons,contrib
GL_PROJECT=	foo-icons:icons foo-contrib:contrib
GL_COMMIT=	c189207a55da45305c884fe2b50e086fcad4724b ae7368cab1ca7ca754b38d49da064df87968ffe4:icons 9e4dd76ad9b38f33fdb417a4c01935958d5acd2a:contrib
GL_SUBDIR=	ext/icons:icons

CONFIGURE_ARGS= --with-contrib=${WRKSRC_contrib}</pre><p>This will fetch two distribution files from
              gitlab.com and one from <code class="literal">gitlab.example.com</code>
              hosting <span class="application">GitLab</span>. The default one comes
              from <code class="filename">https://gitlab.com/foo/foo</code> and commit is
              <code class="literal">c189207a55da45305c884fe2b50e086fcad4724b</code>. The
              second one, with the <code class="literal">icons</code> group, comes from
              <code class="filename">https://gitlab.example.com:9434/gitlab/bar/foo-icons</code>
              and commit is <code class="literal">ae7368cab1ca7ca754b38d49da064df87968ffe4</code>.
              The third one comes from <code class="filename">https://gitlab.com/bar/foo-contrib</code>
              and is commit <code class="literal">9e4dd76ad9b38f33fdb417a4c01935958d5acd2a</code>.
              The distribution files are named <code class="filename">foo-foo-c189207a55da45305c884fe2b50e086fcad4724b_GL0.tar.gz</code>,
              <code class="filename">bar-foo-icons-ae7368cab1ca7ca754b38d49da064df87968ffe4_GL0.tar.gz</code>, and
              <code class="filename">bar-foo-contrib-9e4dd76ad9b38f33fdb417a4c01935958d5acd2a_GL0.tar.gz</code>.</p><p>All the distribution files are extracted in
              <code class="varname">${WRKDIR}</code> in their respective
              subdirectories.  The default file is still extracted in
              <code class="varname">${WRKSRC}</code>, in this case,
              <code class="filename">${WRKDIR}/foo-c189207a55da45305c884fe2b50e086fcad4724b-c189207a55da45305c884fe2b50e086fcad4724b</code>.
              Each additional distribution file is extracted in
              <code class="varname">${WRKSRC_<em class="replaceable"><code>group</code></em>}</code>.
              Here, for the <code class="literal">icons</code> group, it is called
              <code class="varname">${WRKSRC_icons}</code> and it contains
              <code class="filename">${WRKDIR}/foo-icons-ae7368cab1ca7ca754b38d49da064df87968ffe4-ae7368cab1ca7ca754b38d49da064df87968ffe4</code>.
              The file with the <code class="literal">contrib</code> group is
              called <code class="varname">${WRKSRC_contrib}</code> and contains
              <code class="literal">${WRKDIR}/foo-contrib-9e4dd76ad9b38f33fdb417a4c01935958d5acd2a-9e4dd76ad9b38f33fdb417a4c01935958d5acd2a</code>.</p><p>The software's build system expects to find the icons
              in a <code class="filename">ext/icons</code> subdirectory in its
              sources, so <code class="varname">GL_SUBDIR</code> is used.
              <code class="varname">GL_SUBDIR</code> makes sure that
              <code class="filename">ext</code> exists, but that
              <code class="filename">ext/icons</code> does not already exist.
              Then it does this:</p><pre class="programlisting">post-extract:
        @${MV} ${WRKSRC_icons} ${WRKSRC}/ext/icons</pre></div></div><br class="example-break" /><div class="example"><a id="makefile-master_sites-gitlab-multi2"></a><div class="example-title">Example 5.21. Use of <code class="varname">USE_GITLAB</code> with Multiple
            Distribution Files Using
            <code class="varname">GL_TUPLE</code></div><div class="example-contents"><p>This is functionally equivalent to <a class="xref" href="makefile-distfiles.html#makefile-master_sites-gitlab-multi" title="Example 5.20. Use of USE_GITLAB with Multiple Distribution Files">Example 5.20, &#8220;Use of <code class="varname">USE_GITLAB</code> with Multiple
            Distribution Files&#8221;</a>, but
              using <code class="varname">GL_TUPLE</code>:</p><pre class="programlisting">PORTNAME=	foo
DISTVERSION=	1.0.2

USE_GITLAB=	yes
GL_COMMIT=	c189207a55da45305c884fe2b50e086fcad4724b
GL_TUPLE=	https://gitlab.example.com:9434/gitlab:bar:foo-icons:ae7368cab1ca7ca754b38d49da064df87968ffe4:icons/ext/icons \
		bar:foo-contrib:9e4dd76ad9b38f33fdb417a4c01935958d5acd2a:contrib

CONFIGURE_ARGS= --with-contrib=${WRKSRC_contrib}</pre><p>Grouping was used in the previous example with
              <code class="literal">bar:icons,contrib</code>.  Some redundant
              information is present with <code class="varname">GL_TUPLE</code>
              because grouping is not possible.</p></div></div><br class="example-break" /></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-extract_sufx"></a>5.4.5. <code class="varname">EXTRACT_SUFX</code></h3></div></div></div><p>If there is one distribution file, and it uses an odd
	suffix to indicate the compression mechanism, set
	<code class="varname">EXTRACT_SUFX</code>.</p><p>For example, if the distribution file was named
	<code class="filename">foo.tar.gzip</code> instead of the more normal
	<code class="filename">foo.tar.gz</code>, write:</p><pre class="programlisting">DISTNAME=	foo
EXTRACT_SUFX=	.tar.gzip</pre><p>The
	<code class="literal">USES=tar[:<em class="replaceable"><code>xxx</code></em>]</code>,
	<code class="literal">USES=lha</code> or <code class="literal">USES=zip</code>
	automatically set <code class="varname">EXTRACT_SUFX</code> to the most
	common archives extensions as necessary, see <a class="xref" href="uses.html" title="Chapter 17. Using USES Macros">Chapter 17, <em>Using <code class="varname">USES</code> Macros</em></a> for more details.  If neither of
	these are set then <code class="varname">EXTRACT_SUFX</code> defaults to
	<code class="literal">.tar.gz</code>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">As <code class="varname">EXTRACT_SUFX</code> is only used in
	  <code class="varname">DISTFILES</code>, only set one of them..</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-distfiles-definition"></a>5.4.6. <code class="varname">DISTFILES</code></h3></div></div></div><p>Sometimes the names of the files to be downloaded have no
	resemblance to the name of the port.  For example, it might be
	called <code class="filename">source.tar.gz</code> or similar.  In
	other cases the application's source code might be in several
	different archives, all of which must be downloaded.</p><p>If this is the case, set <code class="varname">DISTFILES</code> to
	be a space separated list of all the files that must be
	downloaded.</p><pre class="programlisting">DISTFILES=	source1.tar.gz source2.tar.gz</pre><p>If not explicitly set, <code class="varname">DISTFILES</code>
	defaults to
	<code class="literal">${DISTNAME}${EXTRACT_SUFX}</code>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-extract_only"></a>5.4.7. <code class="varname">EXTRACT_ONLY</code></h3></div></div></div><p>If only some of the <code class="varname">DISTFILES</code> must be
	extracted&#8212;for example, one of them is the source code,
	while another is an uncompressed document&#8212;list the
	filenames that must be extracted in
	<code class="varname">EXTRACT_ONLY</code>.</p><pre class="programlisting">DISTFILES=	source.tar.gz manual.html
EXTRACT_ONLY=	source.tar.gz</pre><p>When none of the <code class="varname">DISTFILES</code> need to be
	uncompressed, set <code class="varname">EXTRACT_ONLY</code> to the empty
	string.</p><pre class="programlisting">EXTRACT_ONLY=</pre></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-patchfiles"></a>5.4.8. <code class="varname">PATCHFILES</code></h3></div></div></div><p>If the port requires some additional patches that are
	available by <acronym class="acronym">FTP</acronym> or
	<acronym class="acronym">HTTP</acronym>, set <code class="varname">PATCHFILES</code> to
	the names of the files and <code class="varname">PATCH_SITES</code> to
	the URL of the directory that contains them (the format is the
	same as <code class="varname">MASTER_SITES</code>).</p><p>If the patch is not relative to the top of the source tree
	(that is, <code class="varname">WRKSRC</code>) because it contains some
	extra pathnames, set <code class="varname">PATCH_DIST_STRIP</code>
	accordingly.  For instance, if all the pathnames in the patch
	have an extra <code class="literal">foozolix-1.0/</code> in front of the
	filenames, then set
	<code class="literal">PATCH_DIST_STRIP=-p1</code>.</p><p>Do not worry if the patches are compressed; they will be
	decompressed automatically if the filenames end with
	<code class="filename">.Z</code>, <code class="filename">.gz</code>,
	<code class="filename">.bz2</code> or <code class="filename">.xz</code>.</p><p>If the patch is distributed with some other files, such as
	documentation, in a compressed tarball, using
	<code class="varname">PATCHFILES</code> is not possible.  If that is the
	case, add the name and the location of the patch tarball to
	<code class="varname">DISTFILES</code> and
	<code class="varname">MASTER_SITES</code>.  Then, use
	<code class="varname">EXTRA_PATCHES</code> to point to those
	files and <code class="filename">bsd.port.mk</code> will automatically
	apply them.  In particular, do
	<span class="emphasis"><em>not</em></span> copy patch files into
	<code class="filename">${PATCHDIR}</code>.  That directory may
	not be writable.</p><div xmlns="" class="tip"><h3 class="admontitle">Tip: </h3><p xmlns="http://www.w3.org/1999/xhtml">If there are multiple patches and they need mixed values
	  for the strip parameter, it can be added alongside the patch
	  name in <code class="varname">PATCHFILES</code>, e.g:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">PATCHFILES=	patch1 patch2:-p1</pre><p xmlns="http://www.w3.org/1999/xhtml">This does not conflict with <a class="link" href="makefile-distfiles.html#porting-master-sites-n" title="5.4.9. Multiple Distribution or Patches Files from Multiple Locations">the master site grouping
	    feature</a>, adding a group also works:</p><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting">PATCHFILES=	patch2:-p1:source2</pre></div><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The tarball will have been extracted alongside the
	  regular source by then, so there is no need to explicitly
	  extract it if it is a regular compressed tarball.  Take extra
	  care not to overwrite something that already exists in that
	  directory if extracting it manually.  Also, do not forget to
	  add a command to remove the copied patch in the
	  <code class="buildtarget">pre-clean</code> target.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-master-sites-n"></a>5.4.9. Multiple Distribution or Patches Files from Multiple
	Locations</h3></div></div></div><p>(Consider this to be a somewhat
	<span class="quote">&#8220;<span class="quote">advanced topic</span>&#8221;</span>; those new to this document
	may wish to skip this section at first).</p><p>This section has information on the fetching mechanism
	known as both <code class="literal">MASTER_SITES:n</code> and
	<code class="literal">MASTER_SITES_NN</code>.  We will refer to this
	mechanism as <code class="literal">MASTER_SITES:n</code>.</p><p>A little background first.  OpenBSD has a neat feature
	inside <code class="varname">DISTFILES</code> and
	<code class="varname">PATCHFILES</code> which allows files and
	patches to be postfixed with <code class="literal">:n</code>
	identifiers.  Here, <code class="literal">n</code> can be any word
	containing <code class="literal">[0-9a-zA-Z_]</code> and denote a group
	designation.  For example:</p><pre class="programlisting">DISTFILES=	alpha:0 beta:1</pre><p>In OpenBSD, distribution file <code class="filename">alpha</code>
	will be associated with variable
	<code class="varname">MASTER_SITES0</code> instead of our common
	<code class="varname">MASTER_SITES</code> and
	<code class="filename">beta</code> with
	<code class="varname">MASTER_SITES1</code>.</p><p>This is a very interesting feature which can decrease
	that endless search for the correct download site.</p><p>Just picture 2 files in <code class="varname">DISTFILES</code> and
	20 sites in <code class="varname">MASTER_SITES</code>, the sites slow as
	hell where <code class="filename">beta</code> is carried by all sites
	in <code class="varname">MASTER_SITES</code>, and
	<code class="filename">alpha</code> can only be found in the 20th site.
	It would be such a waste to check all of them if the
	maintainer knew this beforehand, would it not?  Not a good
	start for that lovely weekend!</p><p>Now that you have the idea, just imagine more
	<code class="varname">DISTFILES</code> and more
	<code class="varname">MASTER_SITES</code>.  Surely our
	<span class="quote">&#8220;<span class="quote">distfiles survey meister</span>&#8221;</span> would appreciate the
	relief to network strain that this would bring.</p><p>In the next sections, information will follow on the
	FreeBSD implementation of this idea.  We improved a bit on
	OpenBSD's concept.</p><div xmlns="" class="important"><h3 class="admontitle">Important: </h3><p xmlns="http://www.w3.org/1999/xhtml">The group names cannot have dashes in them
	  (<code class="literal">-</code>), in fact, they cannot have any
	  characters out of the <code class="literal">[a-zA-Z0-9_]</code> range.
	  This is because, while <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=make&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">make</span>(1)</span></a> is ok with variable
	  names containing dashes, <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sh</span>(1)</span></a> is not.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="porting-master-sites-n-simplified"></a>5.4.9.1. Simplified Information</h4></div></div></div><p>This section explains how to quickly prepare fine
	  grained fetching of multiple distribution files and patches
	  from different sites and subdirectories.  We describe here a
	  case of simplified <code class="literal">MASTER_SITES:n</code> usage.
	  This will be sufficient for most scenarios.  More detailed
	  information are available in <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-detailed" title="5.4.9.2. Detailed Information">Section 5.4.9.2, &#8220;Detailed Information&#8221;</a>.</p><p>Some applications consist of multiple distribution files
	  that must be downloaded from a number of different sites.
	  For example, <span class="application">Ghostscript</span> consists
	  of the core of the program, and then a large number of
	  driver files that are used depending on the user's printer.
	  Some of these driver files are supplied with the core, but
	  many others must be downloaded from a variety of different
	  sites.</p><p>To support this, each entry in
	  <code class="varname">DISTFILES</code> may be followed by a colon and
	  a <span class="quote">&#8220;<span class="quote">group name</span>&#8221;</span>.  Each site listed in
	  <code class="varname">MASTER_SITES</code> is then followed by a colon,
	  and the group that indicates which distribution files are
	  downloaded from this site.</p><p>For example, consider an application with the source
	  split in two parts, <code class="filename">source1.tar.gz</code> and
	  <code class="filename">source2.tar.gz</code>, which must be
	  downloaded from two different sites.  The port's
	  <code class="filename">Makefile</code> would include lines like <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-simple-use-one-file-per-site" title="Example 5.22. Simplified Use of MASTER_SITES:n with One File Per Site">Example 5.22, &#8220;Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with One File Per Site&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-simple-use-one-file-per-site"></a><div class="example-title">Example 5.22. Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with One File Per Site</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	ftp://ftp1.example.com/:source1 \
		http://www.example.com/:source2
DISTFILES=	source1.tar.gz:source1 \
		source2.tar.gz:source2</pre></div></div><br class="example-break" /><p>Multiple distribution files can have the same group.
	  Continuing the previous example, suppose that there was a
	  third distfile, <code class="filename">source3.tar.gz</code>, that
	  is downloaded from
	  <code class="systemitem">ftp.example2.com</code>.  The
	  <code class="filename">Makefile</code> would then be written like
	  <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-simple-use-more-than-one-file-per-site" title="Example 5.23. Simplified Use of MASTER_SITES:n with More Than One File Per Site">Example 5.23, &#8220;Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with More Than One File Per Site&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-simple-use-more-than-one-file-per-site"></a><div class="example-title">Example 5.23. Simplified Use of <code class="literal">MASTER_SITES:n</code>
	    with More Than One File Per Site</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	ftp://ftp.example.com/:source1 \
		http://www.example.com/:source2
DISTFILES=	source1.tar.gz:source1 \
		source2.tar.gz:source2 \
		source3.tar.gz:source2</pre></div></div><br class="example-break" /></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="ports-master-sites-n-detailed"></a>5.4.9.2. Detailed Information</h4></div></div></div><p>Okay, so the previous example did not reflect the new
	  port's needs?  In this section we will explain in detail how
	  the fine grained fetching mechanism
	  <code class="literal">MASTER_SITES:n</code> works and how it can
	  be used.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Elements can be postfixed with
	      <code class="literal">:<em class="replaceable"><code>n</code></em></code> where
	      <em class="replaceable"><code>n</code></em> is
	      <code class="literal">[^:,]+</code>, that is,
	      <em class="replaceable"><code>n</code></em> could conceptually be any
	      alphanumeric string but we will limit it to
	      <code class="literal">[a-zA-Z_][0-9a-zA-Z_]+</code> for
	      now.</p><p>Moreover, string matching is case sensitive; that
	      is, <code class="literal">n</code> is different from
	      <code class="literal">N</code>.</p><p>However, these words cannot be used for
	      postfixing purposes since they yield special meaning:
	      <code class="literal">default</code>, <code class="literal">all</code> and
	      <code class="literal">ALL</code> (they are used internally in
	      item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-what-changes-in-port-targets">ii</a>).
	      Furthermore, <code class="literal">DEFAULT</code> is a special
	      purpose word (check item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-DEFAULT-group">3</a>).</p></li><li class="listitem"><p>Elements postfixed with <code class="literal">:n</code>
	      belong to the group <code class="literal">n</code>,
	      <code class="literal">:m</code> belong to group
	      <code class="literal">m</code> and so forth.</p></li><li class="listitem"><p><a id="porting-master-sites-n-DEFAULT-group"></a>Elements without a postfix are groupless, they
	      all belong to the special group
	      <code class="literal">DEFAULT</code>.  Any elements postfixed
	      with <code class="literal">DEFAULT</code>, is just being
	      redundant unless an element belongs
	      to both <code class="literal">DEFAULT</code> and other groups at
	      the same time (check item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-comma-operator">5</a>).</p><p>These examples are equivalent but the first
	      one is preferred:</p><pre class="programlisting">MASTER_SITES=	alpha</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT</pre></li><li class="listitem"><p>Groups are not exclusive, an element may belong to
	      several different groups at the same time and a group
	      can either have either several different elements or
	      none at all.</p></li><li class="listitem"><p><a id="porting-master-sites-n-comma-operator"></a>When an element belongs to several groups
	      at the same time, use the comma operator
	      (<code class="literal">,</code>).</p><p>Instead of repeating it several times, each time
	      with a different postfix, we can list several groups at
	      once in a single postfix.  For instance,
	      <code class="literal">:m,n,o</code> marks an element that belongs
	      to group <code class="literal">m</code>, <code class="literal">n</code> and
	      <code class="literal">o</code>.</p><p>All these examples are equivalent but the
	      last one is preferred:</p><pre class="programlisting">MASTER_SITES=	alpha alpha:SOME_SITE</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT alpha:SOME_SITE</pre><pre class="programlisting">MASTER_SITES=	alpha:SOME_SITE,DEFAULT</pre><pre class="programlisting">MASTER_SITES=	alpha:DEFAULT,SOME_SITE</pre></li><li class="listitem"><p>All sites within a given group are sorted according
	      to <code class="varname">MASTER_SORT_AWK</code>.  All groups
	      within <code class="varname">MASTER_SITES</code> and
	      <code class="varname">PATCH_SITES</code> are sorted as
	      well.</p></li><li class="listitem"><p><a id="porting-master-sites-n-group-semantics"></a>Group semantics can be used in any of the
	      variables <code class="varname">MASTER_SITES</code>,
	      <code class="varname">PATCH_SITES</code>,
	      <code class="varname">MASTER_SITE_SUBDIR</code>,
	      <code class="varname">PATCH_SITE_SUBDIR</code>,
	      <code class="varname">DISTFILES</code>, and
	      <code class="varname">PATCHFILES</code> according to this
	      syntax:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>All <code class="varname">MASTER_SITES</code>,
		  <code class="varname">PATCH_SITES</code>,
		  <code class="varname">MASTER_SITE_SUBDIR</code> and
		  <code class="varname">PATCH_SITE_SUBDIR</code> elements must
		  be terminated with the forward slash
		  <code class="literal">/</code> character.  If any elements
		  belong to any groups, the group postfix
		  <code class="literal">:<em class="replaceable"><code>n</code></em></code>
		  must come right after the terminator
		  <code class="literal">/</code>.  The
		  <code class="literal">MASTER_SITES:n</code> mechanism relies
		  on the existence of the terminator
		  <code class="literal">/</code> to avoid confusing elements
		  where a <code class="literal">:n</code> is a valid part of the
		  element with occurrences where <code class="literal">:n</code>
		  denotes group <code class="literal">n</code>.  For
		  compatibility purposes, since the
		  <code class="literal">/</code> terminator was not required
		  before in both <code class="varname">MASTER_SITE_SUBDIR</code>
		  and <code class="varname">PATCH_SITE_SUBDIR</code> elements,
		  if the postfix immediate preceding character is not
		  a <code class="literal">/</code> then <code class="literal">:n</code>
		  will be considered a valid part of the element
		  instead of a group postfix even if an element is
		  postfixed with <code class="literal">:n</code>.  See both
		  <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-master-site-subdir" title="Example 5.24. Detailed Use of MASTER_SITES:n in MASTER_SITE_SUBDIR">Example 5.24, &#8220;Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> in
		    <code class="varname">MASTER_SITE_SUBDIR</code>&#8221;</a>
		  and <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="Example 5.25. Detailed Use of MASTER_SITES:n with Comma Operator, Multiple Files, Multiple Sites and Multiple Subdirectories">Example 5.25, &#8220;Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> with Comma
		    Operator, Multiple Files, Multiple Sites and
		    Multiple Subdirectories&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-subdir"></a><div class="example-title">Example 5.24. Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> in
		    <code class="varname">MASTER_SITE_SUBDIR</code></div><div class="example-contents"><pre class="programlisting">MASTER_SITE_SUBDIR=	old:n new/:NEW</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Directories within group
			<code class="literal">DEFAULT</code> -&gt;
			old:n</p></li><li class="listitem"><p>Directories within group
			<code class="literal">NEW</code> -&gt; new</p></li></ul></div></div></div><br class="example-break" /><div class="example"><a id="ports-master-sites-n-example-detailed-use-complete-example-master-sites"></a><div class="example-title">Example 5.25. Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> with Comma
		    Operator, Multiple Files, Multiple Sites and
		    Multiple Subdirectories</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	http://site1/%SUBDIR%/ http://site2/:DEFAULT \
		http://site3/:group3 http://site4/:group4 \
		http://site5/:group5 http://site6/:group6 \
		http://site7/:DEFAULT,group6 \
		http://site8/%SUBDIR%/:group6,group7 \
		http://site9/:group8
DISTFILES=	file1 file2:DEFAULT file3:group3 \
		file4:group4,group5,group6 file5:grouping \
		file6:group7
MASTER_SITE_SUBDIR=	directory-trial:1 directory-n/:groupn \
		directory-one/:group6,DEFAULT \
		directory</pre><p>The previous example results in this
		    fine grained fetching.  Sites are listed in the
		    exact order they will be used.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="filename">file1</code> will be
			fetched from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file2</code> will be fetched
			exactly as <code class="filename">file1</code> since
			they both belong to the same group</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site1/directory-trial:1/</p></li><li class="listitem"><p>http://site1/directory-one/</p></li><li class="listitem"><p>http://site1/directory/</p></li><li class="listitem"><p>http://site2/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file3</code> will be fetched
			from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site3/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file4</code> will be
			fetched from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site4/</p></li><li class="listitem"><p>http://site5/</p></li><li class="listitem"><p>http://site6/</p></li><li class="listitem"><p>http://site7/</p></li><li class="listitem"><p>http://site8/directory-one/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file5</code> will be fetched
			from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li><li class="listitem"><p><code class="filename">file6</code> will be fetched
			from</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><code class="varname">MASTER_SITE_OVERRIDE</code></p></li><li class="listitem"><p>http://site8/</p></li><li class="listitem"><p><code class="varname">MASTER_SITE_BACKUP</code></p></li></ul></div></li></ul></div></div></div><br class="example-break" /></li></ol></div></li><li class="listitem"><p>How do I group one of the special macros from
	      <code class="filename">bsd.sites.mk</code>, for example,
	      SourceForge (<code class="literal">SF</code>)?</p><p>This has been simplified as much as possible.  See
	      <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-master-site-sourceforge" title="Example 5.26. Detailed Use of MASTER_SITES:n with SourceForge (SF)">Example 5.26, &#8220;Detailed Use of <code class="literal">MASTER_SITES:n</code>
		with SourceForge (<code class="literal">SF</code>)&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-master-site-sourceforge"></a><div class="example-title">Example 5.26. Detailed Use of <code class="literal">MASTER_SITES:n</code>
		with SourceForge (<code class="literal">SF</code>)</div><div class="example-contents"><pre class="programlisting">MASTER_SITES=	http://site1/ SF/something/1.0:sourceforge,TEST
DISTFILES=	something.tar.gz:sourceforge</pre><p><code class="filename">something.tar.gz</code> will be
		fetched from all sites within SourceForge.</p></div></div><br class="example-break" /></li><li class="listitem"><p>How do I use this with
	      <code class="varname">PATCH<em class="replaceable"><code>*</code></em></code>?</p><p>All examples were done with
	      <code class="varname">MASTER<em class="replaceable"><code>*</code></em></code>
	      but they work exactly the same for
	      <code class="varname">PATCH<em class="replaceable"><code>*</code></em></code>
	      ones as can be seen in <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-patch-sites" title="Example 5.27. Simplified Use of MASTER_SITES:n with PATCH_SITES">Example 5.27, &#8220;Simplified Use of
		<code class="literal">MASTER_SITES:n</code> with
		<code class="varname">PATCH_SITES</code>&#8221;</a>.</p><div class="example"><a id="ports-master-sites-n-example-detailed-use-patch-sites"></a><div class="example-title">Example 5.27. Simplified Use of
		<code class="literal">MASTER_SITES:n</code> with
		<code class="varname">PATCH_SITES</code></div><div class="example-contents"><pre class="programlisting">PATCH_SITES=	http://site1/ http://site2/:test
PATCHFILES=	patch1:test</pre></div></div><br class="example-break" /></li></ol></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="port-master-sites-n-what-changed"></a>5.4.9.3. What Does Change for Ports?  What Does Not?</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem"><p>All current ports remain the same.  The
	      <code class="literal">MASTER_SITES:n</code> feature code is only
	      activated if there are elements postfixed with
	      <code class="literal">:<em class="replaceable"><code>n</code></em></code> like
	      elements according to the aforementioned syntax rules,
	      especially as shown in item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-group-semantics">7</a>.</p></li><li class="listitem"><p><a id="porting-master-sites-n-what-changes-in-port-targets"></a>The port targets remain the same:
	      <code class="buildtarget">checksum</code>,
	      <code class="buildtarget">makesum</code>,
	      <code class="buildtarget">patch</code>,
	      <code class="buildtarget">configure</code>,
	      <code class="buildtarget">build</code>, etc.  With the obvious
	      exceptions of <code class="buildtarget">do-fetch</code>,
	      <code class="buildtarget">fetch-list</code>,
	      <code class="buildtarget">master-sites</code> and
	      <code class="buildtarget">patch-sites</code>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="buildtarget">do-fetch</code>: deploys
		  the new grouping postfixed
		  <code class="varname">DISTFILES</code> and
		  <code class="varname">PATCHFILES</code> with their matching
		  group elements within both
		  <code class="varname">MASTER_SITES</code> and
		  <code class="varname">PATCH_SITES</code> which use matching
		  group elements within both
		  <code class="varname">MASTER_SITE_SUBDIR</code> and
		  <code class="varname">PATCH_SITE_SUBDIR</code>.  Check <a class="xref" href="makefile-distfiles.html#ports-master-sites-n-example-detailed-use-complete-example-master-sites" title="Example 5.25. Detailed Use of MASTER_SITES:n with Comma Operator, Multiple Files, Multiple Sites and Multiple Subdirectories">Example 5.25, &#8220;Detailed Use of
		    <code class="literal">MASTER_SITES:n</code> with Comma
		    Operator, Multiple Files, Multiple Sites and
		    Multiple Subdirectories&#8221;</a>.</p></li><li class="listitem"><p><code class="buildtarget">fetch-list</code>: works
		  like old <code class="buildtarget">fetch-list</code> with
		  the exception that it groups just like
		  <code class="buildtarget">do-fetch</code>.</p></li><li class="listitem"><p><code class="buildtarget">master-sites</code> and
		  <code class="buildtarget">patch-sites</code>:
		  (incompatible with older versions) only return the
		  elements of group <code class="literal">DEFAULT</code>; in
		  fact, they execute targets
		  <code class="buildtarget">master-sites-default</code> and
		  <code class="buildtarget">patch-sites-default</code>
		  respectively.</p><p>Furthermore, using target either
		  <code class="buildtarget">master-sites-all</code> or
		  <code class="buildtarget">patch-sites-all</code> is
		  preferred to directly checking either
		  <code class="buildtarget">MASTER_SITES</code> or
		  <code class="buildtarget">PATCH_SITES</code>.  Also,
		  directly checking is not guaranteed to work in any
		  future versions.  Check item <a class="xref" href="makefile-distfiles.html#porting-master-sites-n-new-port-targets-master-sites-all">B</a>
		  for more information on these new port
		  targets.</p></li></ul></div></li><li class="listitem"><p>New port targets</p><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem"><p>There are
		  <code class="buildtarget">master-sites-<em class="replaceable"><code>n</code></em></code>
		  and
		  <code class="buildtarget">patch-sites-<em class="replaceable"><code>n</code></em></code>
		  targets which will list the elements of the
		  respective group <em class="replaceable"><code>n</code></em>
		  within <code class="varname">MASTER_SITES</code> and
		  <code class="varname">PATCH_SITES</code> respectively.  For
		  instance, both
		  <code class="buildtarget">master-sites-DEFAULT</code>
		  and <code class="buildtarget">patch-sites-DEFAULT</code>
		  will return the elements of group
		  <code class="literal">DEFAULT</code>,
		  <code class="buildtarget">master-sites-test</code> and
		  <code class="buildtarget">patch-sites-test</code> of
		  group <code class="literal">test</code>, and thereon.</p></li><li class="listitem"><p><a id="porting-master-sites-n-new-port-targets-master-sites-all"></a>There are new targets
		  <code class="buildtarget">master-sites-all</code> and
		  <code class="buildtarget">patch-sites-all</code> which do
		  the work of the old
		  <code class="buildtarget">master-sites</code> and
		  <code class="buildtarget">patch-sites</code> ones.  They
		  return the elements of all groups as if they all
		  belonged to the same group with the caveat that it
		  lists as many <code class="varname">MASTER_SITE_BACKUP</code>
		  and <code class="varname">MASTER_SITE_OVERRIDE</code> as there
		  are groups defined within either
		  <code class="varname">DISTFILES</code> or
		  <code class="varname">PATCHFILES</code>; respectively for
		  <code class="buildtarget">master-sites-all</code> and
		  <code class="buildtarget">patch-sites-all</code>.</p></li></ol></div></li></ol></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="makefile-dist_subdir"></a>5.4.10. <code class="varname">DIST_SUBDIR</code></h3></div></div></div><p>Do not let the port clutter
	<code class="filename">/usr/ports/distfiles</code>.  If the port
	requires a lot of files to be fetched, or contains a file that
	has a name that might conflict with other ports (for example,
	<code class="filename">Makefile</code>), set
	<code class="varname">DIST_SUBDIR</code> to the name of the port
	(<code class="literal">${PORTNAME}</code> or
	<code class="literal">${PKGNAMEPREFIX}${PORTNAME}</code> are
	fine).  This will change <code class="varname">DISTDIR</code> from the
	default <code class="filename">/usr/ports/distfiles</code> to
	<code class="filename">/usr/ports/distfiles/${DIST_SUBDIR}</code>, and
	in effect puts everything that is required for the port into
	that subdirectory.</p><p>It will also look at the subdirectory with the same name
	on the backup master site at <a class="link" href="http://distcache.FreeBSD.org" target="_top">http://distcache.FreeBSD.org</a>
	(Setting
	<code class="varname">DISTDIR</code> explicitly in
	<code class="filename">Makefile</code> will not accomplish this, so
	please use <code class="varname">DIST_SUBDIR</code>.)</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">This does not affect
	  <code class="varname">MASTER_SITES</code> defined in the
	  <code class="filename">Makefile</code>.</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="makefile-categories.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="makefiles.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="makefile-maintainer.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">5.3. Categorization </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 5.5. <code class="varname">MAINTAINER</code></td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>