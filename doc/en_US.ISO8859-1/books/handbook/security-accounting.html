<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>13.12. Process Accounting</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Handbook" /><link rel="up" href="security.html" title="Chapter 13. Security" /><link rel="prev" href="security-advisories.html" title="13.11. FreeBSD Security Advisories" /><link rel="next" href="security-resourcelimits.html" title="13.13. Resource Limits" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">13.12. Process Accounting</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="security-advisories.html">Prev</a> </td><th width="60%" align="center">Chapter 13. Security</th><td width="20%" align="right"> <a accesskey="n" href="security-resourcelimits.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="security-accounting"></a>13.12. Process Accounting</h2></div><div><span class="authorgroup">Contributed
	  by <span xmlns="http://www.w3.org/1999/xhtml" class="author"><span class="firstname">Tom</span> <span class="surname">Rhodes</span></span>. </span></div></div></div><a id="idp59844344" class="indexterm"></a><p>Process accounting is a security method in which an
      administrator may keep track of system resources used and
      their allocation among users, provide for system monitoring,
      and minimally track a user's commands.</p><p>Process accounting has both positive and negative points.
      One of the positives is that an intrusion may be narrowed down
      to the point of entry.  A negative is the amount of logs
      generated by process accounting, and the disk space they may
      require.  This section walks an administrator through the basics
      of process accounting.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">If more fine-grained accounting is needed, refer to
	<a class="xref" href="audit.html" title="Chapter 16. Security Event Auditing">Chapter 16, <em>Security Event Auditing</em></a>.</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp59847032"></a>13.12.1. Enabling and Utilizing Process Accounting</h3></div></div></div><p>Before using process accounting, it must be enabled using
	the following commands:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>sysrc accounting_enable=yes</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>service accounting start</code></strong></pre><p>The accounting information is stored in files located in
	<code class="filename">/var/account</code>, which is automatically created,
	if necessary, the first time the accounting service starts.
	These files contain sensitive information, including all the
	commands issued by all users.  Write access to the files is
	limited to <code class="systemitem">root</code>,
	and read access is limited to <code class="systemitem">root</code> and members of the
	<code class="systemitem">wheel</code> group.
	To also prevent	members of <code class="systemitem">wheel</code> from reading the files,
	change the mode of the <code class="filename">/var/account</code>
	directory to allow access only by <code class="systemitem">root</code>.</p><p>Once enabled, accounting will begin to track information
	such as <acronym class="acronym">CPU</acronym> statistics and executed
	commands.  All accounting logs are in a non-human readable
	format which can be viewed using <code class="command">sa</code>.  If
	issued without any options, <code class="command">sa</code> prints
	information relating to the number of per-user calls, the
	total elapsed time in minutes, total <acronym class="acronym">CPU</acronym>
	and user time in minutes, and the average number of
	<acronym class="acronym">I/O</acronym> operations.  Refer to <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sa</span>(8)</span></a> for
	the list of available options which control the output.</p><p>To display the commands issued by users, use
	<code class="command">lastcomm</code>.  For example, this command
	prints out all usage of <code class="command">ls</code> by <code class="systemitem">trhodes</code> on the
	<code class="literal">ttyp1</code> terminal:</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>lastcomm ls trhodes ttyp1</code></strong></pre><p>Many other useful options exist and are explained in
	<a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=lastcomm&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">lastcomm</span>(1)</span></a>, <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=acct&amp;sektion=5&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">acct</span>(5)</span></a>, and <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sa</span>(8)</span></a>.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="security-advisories.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="security.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="security-resourcelimits.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">13.11. FreeBSD Security Advisories </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 13.13. Resource Limits</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>