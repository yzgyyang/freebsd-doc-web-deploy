<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>Chapter 7. Kernel Configuration</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Frequently Asked Questions for FreeBSD 11.X and 12.X" /><link rel="up" href="index.html" title="Frequently Asked Questions for FreeBSD 11.X and 12.X" /><link rel="prev" href="applications.html" title="Chapter 6. User Applications" /><link rel="next" href="disks.html" title="Chapter 8. Disks, File Systems, and Boot Loaders" /><link rel="copyright" href="legalnotice.html" title="Copyright" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 7. Kernel Configuration</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="applications.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="disks.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="kernelconfig"></a>Chapter 7. Kernel Configuration</h1></div></div></div><div class="qandaset"><a id="idp50869368"></a><dl><dt>7.1. <a href="kernelconfig.html#idp50869624">I would like to customize my kernel.  Is it
	    difficult?</a></dt><dt>7.2. <a href="kernelconfig.html#idp50874360">Why is my kernel so big?</a></dt><dt>7.3. <a href="kernelconfig.html#idp51054328">Why does every kernel I try to build fail to compile,
	    even GENERIC?</a></dt><dt>7.4. <a href="kernelconfig.html#idp51062520">Which scheduler is in use on a
	    running system?</a></dt><dt>7.5. <a href="kernelconfig.html#idp51065976">What is kern.sched.quantum?</a></dt></dl><table border="0" style="width: 100%;"><colgroup><col align="left" width="1%" /><col /></colgroup><tbody><tr class="question"><td align="left" valign="top"><a id="idp50869624"></a><a id="make-kernel"></a><p><strong>7.1.</strong></p></td><td align="left" valign="top"><p>I would like to customize my kernel.  Is it
	    difficult?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>Not at all!  Check out the <a class="link" href="../../../../doc/en_US.ISO8859-1/books/handbook/kernelconfig.html" target="_top">kernel
	      config section of the Handbook</a>.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">The new <code class="filename">kernel</code> will be
	      installed to the <code class="filename">/boot/kernel</code>
	      directory along with its modules, while the old kernel
	      and its modules will be moved to the
	      <code class="filename">/boot/kernel.old</code> directory.  If
	      a mistake is made in the
	      configuration, simply boot the previous version of the
	      kernel.</p></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp50874360"></a><a id="why-kernel-big"></a><p><strong>7.2.</strong></p></td><td align="left" valign="top"><p>Why is my kernel so big?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><code class="literal">GENERIC</code> kernels shipped with FreeBSD
	    are compiled in <span class="emphasis"><em>debug mode</em></span>.
	    Kernels built in debug mode contain debug data in
	    separate files that are used for debugging.
	    FreeBSD releases prior to 11.0 store these debug files in
	    the same directory as the kernel itself,
	    <code class="filename">/boot/kernel/</code>.
	    In FreeBSD 11.0 and later the debug files are stored in
	    <code class="filename">/usr/lib/debug/boot/kernel/</code>.
	    Note that there will be little or no performance loss from
	    running a debug kernel, and it is useful to keep one
	    around in case of a system panic.</p><p>When running low on disk space, there
	    are different options to reduce the size of
	    <code class="filename">/boot/kernel/</code> and
	    <code class="filename">/usr/lib/debug/</code>.</p><p>To not install the symbol files,
	    make sure the following line exists in
	    <code class="filename">/etc/src.conf</code>:</p><pre class="programlisting">WITHOUT_KERNEL_SYMBOLS=yes</pre><p>For more information see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=src.conf&amp;sektion=5&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">src.conf</span>(5)</span></a>.</p><p>If you want to avoid building debug files altogether,
	    make sure that both of the following are true:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>This line does not exist in the kernel
		configuration file:</p><pre class="programlisting">makeoptions DEBUG=-g</pre></li><li class="listitem"><p>Do not run <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=config&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">config</span>(8)</span></a> with
		<code class="option">-g</code>.</p></li></ul></div><p>Either of the above settings will cause the kernel to
	    be built in debug mode.</p><p>To build and install only the specified modules, list
	    them in
	    <code class="filename">/etc/make.conf</code>:</p><pre class="programlisting">MODULES_OVERRIDE= <em class="replaceable"><code>accf_http ipfw</code></em></pre><p>Replace <span class="emphasis"><em>accf_httpd ipfw</em></span> with a
	    list of needed modules.  Only the listed modules will be
	    built.  This reduces the size of the kernel
	    directory and decreases the amount of time needed to
	    build the kernel.  For more information, read
	    <code class="filename">/usr/share/examples/etc/make.conf</code>.</p><p>Unneeded devices can be removed from the kernel
	    to further reduce the size.  See <a class="xref" href="kernelconfig.html#make-kernel" title="7.1.">Q: 7.1</a> for more information.</p><p>To put any of these options into effect, follow the
	    instructions to <a class="link" href="../../../../doc/en_US.ISO8859-1/books/handbook/kernelconfig-building.html" target="_top">build
	      and install</a> the new kernel.</p><p>For reference, the FreeBSD 11 amd64 kernel
	    (<code class="filename">/boot/kernel/kernel</code>) is
	    approximately 25 MB.</p></td></tr><tr class="question"><td align="left" valign="top"><a id="idp51054328"></a><a id="generic-kernel-build-failure"></a><p><strong>7.3.</strong></p></td><td align="left" valign="top"><p>Why does every kernel I try to build fail to compile,
	    even <code class="filename">GENERIC</code>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>There are a number of possible causes for this
	    problem:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The source
		tree is different from the one used to build the
		currently running system.  When attempting an upgrade,
		read <code class="filename">/usr/src/UPDATING</code>, paying
		particular attention to the <span class="quote">&#8220;<span class="quote">COMMON
		  ITEMS</span>&#8221;</span> section at the end.</p></li><li class="listitem"><p>The <code class="command">make buildkernel</code> did not
		complete successfully.  The <code class="command">make
		  buildkernel</code> target relies on files
		generated by the <code class="command">make buildworld</code>
		target to complete its job correctly.</p></li><li class="listitem"><p>Even when building <a class="link" href="introduction.html#stable" title="1.9.">FreeBSD-STABLE</a>, it is possible
		that the source tree was fetched at a time when it was
		either being modified or it was broken.
		Only releases are guaranteed to be
		buildable, although <a class="link" href="introduction.html#stable" title="1.9.">FreeBSD-STABLE</a> builds fine the
		majority of the time.  Try re-fetching the source tree
		and see if the problem goes away.  Try using a
		different mirror in case the previous one is having
		problems.</p></li></ul></div></td></tr><tr class="question"><td align="left" valign="top"><a id="idp51062520"></a><a id="scheduler-in-use"></a><p><strong>7.4.</strong></p></td><td align="left" valign="top"><p>Which scheduler is in use on a
	    running system?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>The name of the scheduler currently being used is
	    directly available as the value of the
	    <code class="varname">kern.sched.name</code> sysctl:</p><pre class="screen"><code class="prompt">%</code> sysctl <em class="replaceable"><code>kern.sched.name</code></em>
kern.sched.name: ULE</pre></td></tr><tr class="question"><td align="left" valign="top"><a id="idp51065976"></a><a id="scheduler-kern-quantum"></a><p><strong>7.5.</strong></p></td><td align="left" valign="top"><p>What is <code class="varname">kern.sched.quantum</code>?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><code class="varname">kern.sched.quantum</code> is the maximum
	    number of ticks a process can run without being preempted
	    in the 4BSD scheduler.</p></td></tr></tbody></table></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="applications.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="disks.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 6. User Applications </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 8. Disks, File Systems, and Boot Loaders</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>