<?xml version="1.0" encoding="iso-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>6.7. MAC Policy Entry Point Reference</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="mailto:doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="FreeBSD Architecture Handbook" /><link rel="up" href="mac.html" title="Chapter 6. The TrustedBSD MAC Framework" /><link rel="prev" href="mac-policy-architecture.html" title="6.6. MAC Policy Architecture" /><link rel="next" href="mac-userland-arch.html" title="6.8. Userland Architecture" /><link rel="copyright" href="trademarks.html" title="Legal Notice" /><script xmlns="" type="text/javascript" src="/layout/js/google.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">6.7. MAC Policy Entry Point Reference</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mac-policy-architecture.html">Prev</a> </td><th width="60%" align="center">Chapter 6. The TrustedBSD MAC Framework</th><td width="20%" align="right"> <a accesskey="n" href="mac-userland-arch.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="mac-entry-point-reference"></a>6.7. MAC Policy Entry Point Reference</h2></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-general"></a>6.7.1. General-Purpose Module Entry Points</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init"></a>6.7.1.1. <code class="function">mpo_init</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init</strong>(</code></td><td><var class="pdparam">conf</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mac_policy_conf
	      *<var class="pdparam">conf</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>conf</code></em></td><td>MAC policy definition</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Policy load event.  The policy list mutex is held, so
	  sleep operations cannot be performed, and calls out to other
	  kernel subsystems must be made with caution.  If potentially
	  sleeping memory allocations are required during policy
	  initialization, they should be made using a separate module
	  SYSINIT().</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-destroy"></a>6.7.1.2. <code class="function">mpo_destroy</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy</strong>(</code></td><td><var class="pdparam">conf</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mac_policy_conf
	      *<var class="pdparam">conf</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>conf</code></em></td><td>MAC policy definition</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Policy load event.  The policy list mutex is held, so
	  caution should be applied.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-syscall"></a>6.7.1.3. <code class="function">mpo_syscall</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_syscall</strong>(</code></td><td><var class="pdparam">td</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">call</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">arg</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct thread
	      *<var class="pdparam">td</var></code>;<br /><code>int <var class="pdparam">call</var></code>;<br /><code>void *<var class="pdparam">arg</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>td</code></em></td><td>Calling thread</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>call</code></em></td><td>Policy-specific syscall number</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>arg</code></em></td><td>Pointer to syscall arguments</td><td class="auto-generated"> </td></tr></tbody></table></div><p>This entry point provides a policy-multiplexed system
	  call so that policies may provide additional services to
	  user processes without registering specific system calls.
	  The policy name provided during registration is used to
	  demux calls from userland, and the arguments will be
	  forwarded to this entry point.  When implementing new
	  services, security modules should be sure to invoke
	  appropriate access control checks from the MAC framework as
	  needed.  For example, if a policy implements an augmented
	  signal functionality, it should call the necessary signal
	  access control checks to invoke the MAC framework and other
	  registered policies.</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">Modules must currently perform the
	    <code class="function">copyin()</code> of the syscall data on their
	    own.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-thread-userret"></a>6.7.1.4. <code class="function">mpo_thread_userret</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_thread_userret</strong>(</code></td><td><var class="pdparam">td</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct thread
	      *<var class="pdparam">td</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>td</code></em></td><td>Returning thread</td><td class="auto-generated"> </td></tr></tbody></table></div><p>This entry point permits policy modules to perform
	  MAC-related events when a thread returns to user space, via
	  a system call return, trap return, or otherwise.  This is
	  required for policies that have floating process labels, as
	  it is not always possible to acquire the process lock at
	  arbitrary points in the stack during system call processing;
	  process labels might represent traditional authentication
	  data, process history information, or other data.  To employ
	  this mechanism, intended changes to the process credential
	  label may be stored in the <code class="literal">p_label</code>
	  protected by a per-policy spin lock, and then set the
	  per-thread <code class="literal">TDF_ASTPENDING</code> flag and
	  per-process <code class="literal">PS_MACPENDM</code> flag to schedule
	  a call to the userret entry point.  From this entry point,
	  the policy may create a replacement credential with less
	  concern about the locking context.  Policy writers are
	  cautioned that event ordering relating to scheduling an AST
	  and the AST being performed may be complex and interlaced in
	  multithreaded applications.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-label-ops"></a>6.7.2. Label Operations</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-bpfdesc"></a>6.7.2.1. <code class="function">mpo_init_bpfdesc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_bpfdesc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to apply</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label on a newly instantiated bpfdesc
	  (BPF descriptor).  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-cred-label"></a>6.7.2.2. <code class="function">mpo_init_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_cred_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to initialize</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label for a newly instantiated user
	  credential.  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-devfsdirent"></a>6.7.2.3. <code class="function">mpo_init_devfsdirent_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_devfsdirent_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to apply</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label on a newly instantiated devfs
	  entry.  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-ifnet"></a>6.7.2.4. <code class="function">mpo_init_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to apply</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label on a newly instantiated network
	  interface.  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-ipq"></a>6.7.2.5. <code class="function">mpo_init_ipq_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_ipq_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flag</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flag</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to apply</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flag</code></em></td><td>Sleeping/non-sleeping <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a>; see
		  below</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label on a newly instantiated IP fragment
	  reassembly queue.  The <em class="parameter"><code>flag</code></em> field may
	  be one of <span class="symbol">M_WAITOK</span> and
	  <span class="symbol">M_NOWAIT</span>, and should be employed to avoid
	  performing a sleeping <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> during this
	  initialization call.  IP fragment reassembly queue
	  allocation frequently occurs in performance sensitive
	  environments, and the implementation should be careful to
	  avoid sleeping or long-lived operations.  This entry point
	  is permitted to fail resulting in the failure to allocate
	  the IP fragment reassembly queue.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-mbuf"></a>6.7.2.6. <code class="function">mpo_init_mbuf_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_mbuf_label</strong>(</code></td><td><var class="pdparam">flag</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>int <var class="pdparam">flag</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>flag</code></em></td><td>Sleeping/non-sleeping <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a>; see
		  below</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label to initialize</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label on a newly instantiated mbuf packet
	  header (<em class="parameter"><code>mbuf</code></em>).  The
	  <em class="parameter"><code>flag</code></em> field may be one of
	  <span class="symbol">M_WAITOK</span> and <span class="symbol">M_NOWAIT</span>, and
	  should be employed to avoid performing a sleeping
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> during this initialization call.  Mbuf
	  allocation frequently occurs in performance sensitive
	  environments, and the implementation should be careful to
	  avoid sleeping or long-lived operations.  This entry point
	  is permitted to fail resulting in the failure to allocate
	  the mbuf header.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-mount"></a>6.7.2.7. <code class="function">mpo_init_mount_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_mount_label</strong>(</code></td><td><var class="pdparam">mntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">mntlabel</var></code>;<br /><code>struct label
	      *<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>mntlabel</code></em></td><td>Policy label to be initialized for the mount
		  itself</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>Policy label to be initialized for the file
		  system</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the labels on a newly instantiated mount
	  point.  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-mount-fs-label"></a>6.7.2.8. <code class="function">mpo_init_mount_fs_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_mount_fs_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be initialized</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label on a newly mounted file system.
	  Sleeping is permitted</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-pipe-label"></a>6.7.2.9. <code class="function">mpo_init_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_pipe_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct
	      label*<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be filled in</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize a label for a newly instantiated pipe.
	  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-socket"></a>6.7.2.10. <code class="function">mpo_init_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_socket_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flag</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flag</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to initialize</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flag</code></em></td><td><a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> flags</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize a label for a newly instantiated socket.  The
	  <em class="parameter"><code>flag</code></em> field may be one of
	  <span class="symbol">M_WAITOK</span> and <span class="symbol">M_NOWAIT</span>, and
	  should be employed to avoid performing a sleeping
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> during this initialization call.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-socket-peer-label"></a>6.7.2.11. <code class="function">mpo_init_socket_peer_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_socket_peer_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flag</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flag</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to initialize</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flag</code></em></td><td><a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> flags</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the peer label for a newly instantiated
	  socket.  The <em class="parameter"><code>flag</code></em> field may be one of
	  <span class="symbol">M_WAITOK</span> and <span class="symbol">M_NOWAIT</span>, and
	  should be employed to avoid performing a sleeping
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">malloc</span>(9)</span></a> during this initialization call.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-proc-label"></a>6.7.2.12. <code class="function">mpo_init_proc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_proc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to initialize</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label for a newly instantiated process.
	  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-init-vnode"></a>6.7.2.13. <code class="function">mpo_init_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_init_vnode_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>New label to initialize</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Initialize the label on a newly instantiated vnode.
	  Sleeping is permitted.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-bpfdesc"></a>6.7.2.14. <code class="function">mpo_destroy_bpfdesc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_bpfdesc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>bpfdesc label</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a BPF descriptor.  In this entry
	  point a policy should free any internal storage associated
	  with <em class="parameter"><code>label</code></em> so that it may be
	  destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-cred"></a>6.7.2.15. <code class="function">mpo_destroy_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_cred_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a credential.  In this entry point,
	  a policy module should free any internal storage associated
	  with <em class="parameter"><code>label</code></em> so that it may be
	  destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-devfsdirent"></a>6.7.2.16. <code class="function">mpo_destroy_devfsdirent_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_devfsdirent_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a devfs entry.  In this entry
	  point, a policy module should free any internal storage
	  associated with <em class="parameter"><code>label</code></em> so that it may
	  be destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-ifnet-label"></a>6.7.2.17. <code class="function">mpo_destroy_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a removed interface.  In this entry
	  point, a policy module should free any internal storage
	  associated with <em class="parameter"><code>label</code></em> so that it may
	  be destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-ipq-label"></a>6.7.2.18. <code class="function">mpo_destroy_ipq_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_ipq_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on an IP fragment queue.  In this
	  entry point, a policy module should free any internal
	  storage associated with <em class="parameter"><code>label</code></em> so that
	  it may be destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-mbuf-label"></a>6.7.2.19. <code class="function">mpo_destroy_mbuf_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_mbuf_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on an mbuf header.  In this entry
	  point, a policy module should free any internal storage
	  associated with <em class="parameter"><code>label</code></em> so that it may
	  be destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-mount-label"></a>6.7.2.20. <code class="function">mpo_destroy_mount_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_mount_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Mount point label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the labels on a mount point.  In this entry
	  point, a policy module should free the internal storage
	  associated with <em class="parameter"><code>mntlabel</code></em> so that they
	  may be destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-mount"></a>6.7.2.21. <code class="function">mpo_destroy_mount_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_mount_label</strong>(</code></td><td><var class="pdparam">mntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">mntlabel</var></code>;<br /><code>struct label
	      *<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>mntlabel</code></em></td><td>Mount point label being destroyed</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>File system label being destroyed&gt;</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the labels on a mount point.  In this entry
	  point, a policy module should free the internal storage
	  associated with <em class="parameter"><code>mntlabel</code></em> and
	  <em class="parameter"><code>fslabel</code></em> so that they may be
	  destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-socket"></a>6.7.2.22. <code class="function">mpo_destroy_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_socket_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Socket label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a socket.  In this entry point, a
	  policy module should free any internal storage associated
	  with <em class="parameter"><code>label</code></em> so that it may be
	  destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-socket-peer-label"></a>6.7.2.23. <code class="function">mpo_destroy_socket_peer_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_socket_peer_label</strong>(</code></td><td><var class="pdparam">peerlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">peerlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>peerlabel</code></em></td><td>Socket peer label being destroyed</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the peer label on a socket.  In this entry
	  point, a policy module should free any internal storage
	  associated with <em class="parameter"><code>label</code></em> so that it may
	  be destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-pipe-label"></a>6.7.2.24. <code class="function">mpo_destroy_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_pipe_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Pipe label</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a pipe.  In this entry point, a
	  policy module should free any internal storage associated
	  with <em class="parameter"><code>label</code></em> so that it may be
	  destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-proc-label"></a>6.7.2.25. <code class="function">mpo_destroy_proc_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_proc_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Process label</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a process.  In this entry point, a
	  policy module should free any internal storage associated
	  with <em class="parameter"><code>label</code></em> so that it may be
	  destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-destroy-vnode-label"></a>6.7.2.26. <code class="function">mpo_destroy_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_destroy_vnode_label</strong>(</code></td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Process label</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Destroy the label on a vnode.  In this entry point, a
	  policy module should free any internal storage associated
	  with <em class="parameter"><code>label</code></em> so that it may be
	  destroyed.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-copy-mbuf-label"></a>6.7.2.27. <code class="function">mpo_copy_mbuf_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_copy_mbuf_label</strong>(</code></td><td><var class="pdparam">src</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dest</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">src</var></code>;<br /><code>struct label
	      *<var class="pdparam">dest</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>src</code></em></td><td>Source label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dest</code></em></td><td>Destination label</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Copy the label information in <em class="parameter"><code>src</code></em>
	  into <em class="parameter"><code>dest</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-copy-pipe-label"></a>6.7.2.28. <code class="function">mpo_copy_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_copy_pipe_label</strong>(</code></td><td><var class="pdparam">src</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dest</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">src</var></code>;<br /><code>struct label
	      *<var class="pdparam">dest</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>src</code></em></td><td>Source label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dest</code></em></td><td>Destination label</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Copy the label information in <em class="parameter"><code>src</code></em>
	  into <em class="parameter"><code>dest</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-copy-vnode-label"></a>6.7.2.29. <code class="function">mpo_copy_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_copy_vnode_label</strong>(</code></td><td><var class="pdparam">src</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dest</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label
	      *<var class="pdparam">src</var></code>;<br /><code>struct label
	      *<var class="pdparam">dest</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>src</code></em></td><td>Source label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dest</code></em></td><td>Destination label</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Copy the label information in <em class="parameter"><code>src</code></em>
	  into <em class="parameter"><code>dest</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-cred-label"></a>6.7.2.30. <code class="function">mpo_externalize_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_externalize_cred_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>String buffer to be filled with a text representation of
	label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when <em class="parameter"><code>element_data</code></em>
	can be filled in.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an externalized label based on the label structure passed.
    An externalized label consists of a text representation of the label
    contents that can be used with userland applications and read by the
    user.  Currently, all policies' <code class="function">externalize</code> entry
    points will be called, so the implementation should check the contents
    of <em class="parameter"><code>element_name</code></em> before attempting to fill in
    <em class="parameter"><code>sb</code></em>.  If
    <em class="parameter"><code>element_name</code></em> does not match the name of your
    policy, simply return <span class="returnvalue">0</span>.  Only return nonzero
    if an error occurs while externalizing the label data.  Once the policy
    fills in <em class="parameter"><code>element_data</code></em>, <code class="varname">*claimed</code>
    should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-ifnet-label"></a>6.7.2.31. <code class="function">mpo_externalize_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_externalize_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>String buffer to be filled with a text representation of
	label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when <em class="parameter"><code>element_data</code></em>
	can be filled in.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an externalized label based on the label structure passed.
    An externalized label consists of a text representation of the label
    contents that can be used with userland applications and read by the
    user.  Currently, all policies' <code class="function">externalize</code> entry
    points will be called, so the implementation should check the contents
    of <em class="parameter"><code>element_name</code></em> before attempting to fill in
    <em class="parameter"><code>sb</code></em>.  If
    <em class="parameter"><code>element_name</code></em> does not match the name of your
    policy, simply return <span class="returnvalue">0</span>.  Only return nonzero
    if an error occurs while externalizing the label data.  Once the policy
    fills in <em class="parameter"><code>element_data</code></em>, <code class="varname">*claimed</code>
    should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-pipe-label"></a>6.7.2.32. <code class="function">mpo_externalize_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_externalize_pipe_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>String buffer to be filled with a text representation of
	label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when <em class="parameter"><code>element_data</code></em>
	can be filled in.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an externalized label based on the label structure passed.
    An externalized label consists of a text representation of the label
    contents that can be used with userland applications and read by the
    user.  Currently, all policies' <code class="function">externalize</code> entry
    points will be called, so the implementation should check the contents
    of <em class="parameter"><code>element_name</code></em> before attempting to fill in
    <em class="parameter"><code>sb</code></em>.  If
    <em class="parameter"><code>element_name</code></em> does not match the name of your
    policy, simply return <span class="returnvalue">0</span>.  Only return nonzero
    if an error occurs while externalizing the label data.  Once the policy
    fills in <em class="parameter"><code>element_data</code></em>, <code class="varname">*claimed</code>
    should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-socket-label"></a>6.7.2.33. <code class="function">mpo_externalize_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_externalize_socket_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>String buffer to be filled with a text representation of
	label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when <em class="parameter"><code>element_data</code></em>
	can be filled in.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an externalized label based on the label structure passed.
    An externalized label consists of a text representation of the label
    contents that can be used with userland applications and read by the
    user.  Currently, all policies' <code class="function">externalize</code> entry
    points will be called, so the implementation should check the contents
    of <em class="parameter"><code>element_name</code></em> before attempting to fill in
    <em class="parameter"><code>sb</code></em>.  If
    <em class="parameter"><code>element_name</code></em> does not match the name of your
    policy, simply return <span class="returnvalue">0</span>.  Only return nonzero
    if an error occurs while externalizing the label data.  Once the policy
    fills in <em class="parameter"><code>element_data</code></em>, <code class="varname">*claimed</code>
    should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-socket-peer-label"></a>6.7.2.34. <code class="function">mpo_externalize_socket_peer_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_externalize_socket_peer_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>String buffer to be filled with a text representation of
	label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when <em class="parameter"><code>element_data</code></em>
	can be filled in.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an externalized label based on the label structure passed.
    An externalized label consists of a text representation of the label
    contents that can be used with userland applications and read by the
    user.  Currently, all policies' <code class="function">externalize</code> entry
    points will be called, so the implementation should check the contents
    of <em class="parameter"><code>element_name</code></em> before attempting to fill in
    <em class="parameter"><code>sb</code></em>.  If
    <em class="parameter"><code>element_name</code></em> does not match the name of your
    policy, simply return <span class="returnvalue">0</span>.  Only return nonzero
    if an error occurs while externalizing the label data.  Once the policy
    fills in <em class="parameter"><code>element_data</code></em>, <code class="varname">*claimed</code>
    should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-externalize-vnode-label"></a>6.7.2.35. <code class="function">mpo_externalize_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_externalize_vnode_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">*claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>struct sbuf *<var class="pdparam">sb</var></code>;<br /><code>int <var class="pdparam">*claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be externalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sb</code></em></td><td>String buffer to be filled with a text representation of
	label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when <em class="parameter"><code>element_data</code></em>
	can be filled in.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an externalized label based on the label structure passed.
    An externalized label consists of a text representation of the label
    contents that can be used with userland applications and read by the
    user.  Currently, all policies' <code class="function">externalize</code> entry
    points will be called, so the implementation should check the contents
    of <em class="parameter"><code>element_name</code></em> before attempting to fill in
    <em class="parameter"><code>sb</code></em>.  If
    <em class="parameter"><code>element_name</code></em> does not match the name of your
    policy, simply return <span class="returnvalue">0</span>.  Only return nonzero
    if an error occurs while externalizing the label data.  Once the policy
    fills in <em class="parameter"><code>element_data</code></em>, <code class="varname">*claimed</code>
    should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-cred-label"></a>6.7.2.36. <code class="function">mpo_internalize_cred_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_internalize_cred_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be filled in</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>Text data to be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when data can be successfully
	internalized.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an internal label structure based on externalized label data
    in text format.  Currently, all policies' <code class="function">internalize</code>
    entry points are called when internalization is requested, so the
    implementation should compare the contents of
    <em class="parameter"><code>element_name</code></em> to its own name in order to be sure
    it should be internalizing the data in <em class="parameter"><code>element_data</code></em>.
    Just as in the <code class="function">externalize</code> entry points, the entry
    point should return <span class="returnvalue">0</span> if
    <em class="parameter"><code>element_name</code></em> does not match its own name, or when
    data can successfully be internalized, in which case
    <code class="varname">*claimed</code> should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-ifnet-label"></a>6.7.2.37. <code class="function">mpo_internalize_ifnet_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_internalize_ifnet_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be filled in</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>Text data to be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when data can be successfully
	internalized.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an internal label structure based on externalized label data
    in text format.  Currently, all policies' <code class="function">internalize</code>
    entry points are called when internalization is requested, so the
    implementation should compare the contents of
    <em class="parameter"><code>element_name</code></em> to its own name in order to be sure
    it should be internalizing the data in <em class="parameter"><code>element_data</code></em>.
    Just as in the <code class="function">externalize</code> entry points, the entry
    point should return <span class="returnvalue">0</span> if
    <em class="parameter"><code>element_name</code></em> does not match its own name, or when
    data can successfully be internalized, in which case
    <code class="varname">*claimed</code> should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-pipe-label"></a>6.7.2.38. <code class="function">mpo_internalize_pipe_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_internalize_pipe_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be filled in</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>Text data to be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when data can be successfully
	internalized.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an internal label structure based on externalized label data
    in text format.  Currently, all policies' <code class="function">internalize</code>
    entry points are called when internalization is requested, so the
    implementation should compare the contents of
    <em class="parameter"><code>element_name</code></em> to its own name in order to be sure
    it should be internalizing the data in <em class="parameter"><code>element_data</code></em>.
    Just as in the <code class="function">externalize</code> entry points, the entry
    point should return <span class="returnvalue">0</span> if
    <em class="parameter"><code>element_name</code></em> does not match its own name, or when
    data can successfully be internalized, in which case
    <code class="varname">*claimed</code> should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-socket-label"></a>6.7.2.39. <code class="function">mpo_internalize_socket_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_internalize_socket_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be filled in</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>Text data to be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when data can be successfully
	internalized.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an internal label structure based on externalized label data
    in text format.  Currently, all policies' <code class="function">internalize</code>
    entry points are called when internalization is requested, so the
    implementation should compare the contents of
    <em class="parameter"><code>element_name</code></em> to its own name in order to be sure
    it should be internalizing the data in <em class="parameter"><code>element_data</code></em>.
    Just as in the <code class="function">externalize</code> entry points, the entry
    point should return <span class="returnvalue">0</span> if
    <em class="parameter"><code>element_name</code></em> does not match its own name, or when
    data can successfully be internalized, in which case
    <code class="varname">*claimed</code> should be incremented.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-internalize-vnode-label"></a>6.7.2.40. <code class="function">mpo_internalize_vnode_label</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_internalize_vnode_label</strong>(</code></td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">element_data</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">claimed</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct label *<var class="pdparam">label</var></code>;<br /><code>char *<var class="pdparam">element_name</var></code>;<br /><code>char *<var class="pdparam">element_data</var></code>;<br /><code>int *<var class="pdparam">claimed</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>label</code></em></td><td>Label to be filled in</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_name</code></em></td><td>Name of the policy whose label should be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>element_data</code></em></td><td>Text data to be internalized</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>claimed</code></em></td><td>Should be incremented when data can be successfully
	internalized.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Produce an internal label structure based on externalized label data
    in text format.  Currently, all policies' <code class="function">internalize</code>
    entry points are called when internalization is requested, so the
    implementation should compare the contents of
    <em class="parameter"><code>element_name</code></em> to its own name in order to be sure
    it should be internalizing the data in <em class="parameter"><code>element_data</code></em>.
    Just as in the <code class="function">externalize</code> entry points, the entry
    point should return <span class="returnvalue">0</span> if
    <em class="parameter"><code>element_name</code></em> does not match its own name, or when
    data can successfully be internalized, in which case
    <code class="varname">*claimed</code> should be incremented.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-label-events"></a>6.7.3. Label Events</h3></div></div></div><p>This class of entry points is used by the MAC framework to
	permit policies to maintain label information on kernel
	objects.  For each labeled kernel object of interest to a MAC
	policy, entry points may be registered for relevant life cycle
	events.  All objects implement initialization, creation, and
	destruction hooks.  Some objects will also implement
	relabeling, allowing user processes to change the labels on
	objects.  Some objects will also implement object-specific
	events, such as label events associated with IP reassembly.  A
	typical labeled object will have the following life cycle of
	entry points:</p><pre class="programlisting">Label initialization          o
(object-specific wait)         \
Label creation                  o
                                 \
Relabel events,                   o--&lt;--.
Various object-specific,          |     |
Access control events             ~--&gt;--o
                                         \
Label destruction                         o</pre><p>Label initialization permits policies to allocate memory
	and set initial values for labels without context for the use
	of the object.  The label slot allocated to a policy will be
	zeroed by default, so some policies may not need to perform
	initialization.</p><p>Label creation occurs when the kernel structure is
	associated with an actual kernel object.  For example, Mbufs
	may be allocated and remain unused in a pool until they are
	required.  mbuf allocation causes label initialization on the
	mbuf to take place, but mbuf creation occurs when the mbuf is
	associated with a datagram.  Typically, context will be
	provided for a creation event, including the circumstances of
	the creation, and labels of other relevant objects in the
	creation process.  For example, when an mbuf is created from a
	socket, the socket and its label will be presented to
	registered policies in addition to the new mbuf and its label.
	Memory allocation in creation events is discouraged, as it may
	occur in performance sensitive ports of the kernel; in
	addition, creation calls are not permitted to fail so a
	failure to allocate memory cannot be reported.</p><p>Object specific events do not generally fall into the
	other broad classes of label events, but will generally
	provide an opportunity to modify or update the label on an
	object based on additional context.  For example, the label on
	an IP fragment reassembly queue may be updated during the
	<span class="symbol">MAC_UPDATE_IPQ</span> entry point as a result of the
	acceptance of an additional mbuf to that queue.</p><p>Access control events are discussed in detail in the
	following section.</p><p>Label destruction permits policies to release storage or
	state associated with a label during its association with an
	object so that the kernel data structures supporting the
	object may be reused or released.</p><p>In addition to labels associated with specific kernel
	objects, an additional class of labels exists: temporary
	labels.  These labels are used to store update information
	submitted by user processes.  These labels are initialized and
	destroyed as with other label types, but the creation event is
	<span class="symbol">MAC_INTERNALIZE</span>, which accepts a user label
	to be converted to an in-kernel representation.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-fs-label-event-ops"></a>6.7.3.1. File System Object Labeling Event Operations</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-associate-vnode-devfs"></a>6.7.3.1.1. <code class="function">mpo_associate_vnode_devfs</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_associate_vnode_devfs</strong>(</code></td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">de</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">delabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mount
		*<var class="pdparam">mp</var></code>;<br /><code>struct label
		*<var class="pdparam">fslabel</var></code>;<br /><code>struct devfs_dirent
		*<var class="pdparam">de</var></code>;<br /><code>struct label
		*<var class="pdparam">delabel</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>mp</code></em></td><td>Devfs mount point</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>Devfs file system label
		    (<code class="varname">mp-&gt;mnt_fslabel</code>)</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>de</code></em></td><td>Devfs directory entry</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>delabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>de</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>vnode associated with
		    <em class="parameter"><code>de</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Fill in the label (<em class="parameter"><code>vlabel</code></em>) for
	    a newly created devfs vnode based on the devfs directory
	    entry passed in <em class="parameter"><code>de</code></em> and its
	    label.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-associate-vnode-extattr"></a>6.7.3.1.2. <code class="function">mpo_associate_vnode_extattr</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
		<strong class="fsfunc">mpo_associate_vnode_extattr</strong>(</code></td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mount
		*<var class="pdparam">mp</var></code>;<br /><code>struct label
		*<var class="pdparam">fslabel</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>mp</code></em></td><td>File system mount point</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>File system label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Vnode to label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Attempt to retrieve the label for
	    <em class="parameter"><code>vp</code></em> from the file system extended
	    attributes.  Upon success, the value <code class="literal">0</code>
	    is returned.  Should extended attribute retrieval not be
	    supported, an accepted fallback is to copy
	    <em class="parameter"><code>fslabel</code></em> into
	    <em class="parameter"><code>vlabel</code></em>.  In the event of an error,
	    an appropriate value for <code class="varname">errno</code> should
	    be returned.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-associate-vnode-singlelabel"></a>6.7.3.1.3. <code class="function">mpo_associate_vnode_singlelabel</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_associate_vnode_singlelabel</strong>(</code></td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mount
		*<var class="pdparam">mp</var></code>;<br /><code>struct label
		*<var class="pdparam">fslabel</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>mp</code></em></td><td>File system mount point</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>File system label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Vnode to label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>On non-multilabel file systems, this entry point is
	    called to set the policy label for
	    <em class="parameter"><code>vp</code></em> based on the file system label,
	    <em class="parameter"><code>fslabel</code></em>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-devfs-device"></a>6.7.3.1.4. <code class="function">mpo_create_devfs_device</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_devfs_device</strong>(</code></td><td><var class="pdparam">dev</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">devfs_dirent</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>dev_t <var class="pdparam">dev</var></code>;<br /><code>struct devfs_dirent
		*<var class="pdparam">devfs_dirent</var></code>;<br /><code>struct label
		*<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>dev</code></em></td><td>Device corresponding with
		    <em class="parameter"><code>devfs_dirent</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>devfs_dirent</code></em></td><td>Devfs directory entry to be labeled.</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Label for <em class="parameter"><code>devfs_dirent</code></em>
		    to be filled in.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Fill out the label on a devfs_dirent being created for
	    the passed device.  This call will be made when the device
	    file system is mounted, regenerated, or a new device is
	    made available.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-devfs-directory"></a>6.7.3.1.5. <code class="function">mpo_create_devfs_directory</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_devfs_directory</strong>(</code></td><td><var class="pdparam">dirname</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dirnamelen</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">devfs_dirent</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>char
		*<var class="pdparam">dirname</var></code>;<br /><code>int
		<var class="pdparam">dirnamelen</var></code>;<br /><code>struct devfs_dirent
		*<var class="pdparam">devfs_dirent</var></code>;<br /><code>struct label
		*<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>dirname</code></em></td><td>Name of directory being created</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>namelen</code></em></td><td>Length of string
		    <em class="parameter"><code>dirname</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>devfs_dirent</code></em></td><td>Devfs directory entry for directory being
		    created.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Fill out the label on a devfs_dirent being created for
	    the passed directory.  This call will be made when the
	    device file system is mounted, regenerated, or a new
	    device requiring a specific directory hierarchy is made
	    available.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-devfs-symlink"></a>6.7.3.1.6. <code class="function">mpo_create_devfs_symlink</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_devfs_symlink</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dd</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ddlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">de</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">delabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct mount
		*<var class="pdparam">mp</var></code>;<br /><code>struct devfs_dirent
		*<var class="pdparam">dd</var></code>;<br /><code>struct label
		*<var class="pdparam">ddlabel</var></code>;<br /><code>struct devfs_dirent
		*<var class="pdparam">de</var></code>;<br /><code>struct label
		*<var class="pdparam">delabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mp</code></em></td><td>Devfs mount point</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dd</code></em></td><td>Link destination</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ddlabel</code></em></td><td>Label associated with
		    <em class="parameter"><code>dd</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>de</code></em></td><td>Symlink entry</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>delabel</code></em></td><td>Label associated with
		    <em class="parameter"><code>de</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Fill in the label (<em class="parameter"><code>delabel</code></em>) for
	    a newly created <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">devfs</span>(5)</span></a> symbolic link entry.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-vnode-extattr"></a>6.7.3.1.7. <code class="function">mpo_create_vnode_extattr</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
		<strong class="fsfunc">mpo_create_vnode_extattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct mount
		*<var class="pdparam">mp</var></code>;<br /><code>struct label
		*<var class="pdparam">fslabel</var></code>;<br /><code>struct vnode
		*<var class="pdparam">dvp</var></code>;<br /><code>struct label
		*<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vlabel</var></code>;<br /><code>struct componentname
		*<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mount</code></em></td><td>File system mount point</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>File system label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Parent directory vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Label associated with
		    <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Newly created vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>Component name for
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Write out the label for <em class="parameter"><code>vp</code></em> to
	    the appropriate extended attribute.  If the write
	    succeeds, fill in <em class="parameter"><code>vlabel</code></em> with the
	    label, and return <span class="returnvalue">0</span>.
	    Otherwise, return an appropriate error.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mount"></a>6.7.3.1.8. <code class="function">mpo_create_mount</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mount</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mnt</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct mount
		*<var class="pdparam">mp</var></code>;<br /><code>struct
		label *<var class="pdparam">mnt</var></code>;<br /><code>struct label
		*<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mp</code></em></td><td>Object; file system being mounted</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mntlabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>mp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fslabel</code></em></td><td>Policy label for the file system
		    <em class="parameter"><code>mp</code></em> mounts.</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Fill out the labels on the mount point being created
	    by the passed subject credential.  This call will be made
	    when a new file system is mounted.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-root-mount"></a>6.7.3.1.9. <code class="function">mpo_create_root_mount</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_root_mount</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fslabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct mount
		*<var class="pdparam">mp</var></code>;<br /><code>struct label
		*<var class="pdparam">mntlabel</var></code>;<br /><code>struct label
		*<var class="pdparam">fslabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td colspan="3">See <a class="xref" href="mac-entry-point-reference.html#mac-mpo-create-mount" title="6.7.3.1.8. mpo_create_mount">Section 6.7.3.1.8, &#8220;<code class="function">mpo_create_mount</code>&#8221;</a>.</td></tr></tbody></table></div><p>Fill out the labels on the mount point being created
	    by the passed subject credential.  This call will be made
	    when the root file system is mounted, after
	    mpo_create_mount;.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-vnode"></a>6.7.3.1.10. <code class="function">mpo_relabel_vnode</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_relabel_vnode</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vnodelabel</var></code>;<br /><code>struct label
		*<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>vnode to relabel</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td>Existing policy label for
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>New, possibly partial label to replace
		    <em class="parameter"><code>vnodelabel</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Update the label on the passed vnode given the passed
	    update vnode label and the passed subject
	    credential.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-setlabel-vnode-extattr"></a>6.7.3.1.11. <code class="function">mpo_setlabel_vnode_extattr</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
		<strong class="fsfunc">mpo_setlabel_vnode_extattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">intlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vlabel</var></code>;<br /><code>struct label
		*<var class="pdparam">intlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Vnode for which the label is being
		    written</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>intlabel</code></em></td><td>Label to write out</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Write out the policy from
	    <em class="parameter"><code>intlabel</code></em> to an extended attribute.
	    This is called from
	    <code class="function">vop_stdcreatevnode_ea</code>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-update-devfsdirent"></a>6.7.3.1.12. <code class="function">mpo_update_devfsdirent</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_update_devfsdirent</strong>(</code></td><td><var class="pdparam">devfs_dirent</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">direntlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct devfs_dirent
		*<var class="pdparam">devfs_dirent</var></code>;<br /><code>struct label
		*<var class="pdparam">direntlabel</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vnodelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>devfs_dirent</code></em></td><td>Object; devfs directory entry</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>direntlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>devfs_dirent</code></em> to be
		    updated.</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Parent vnode</td><td>Locked</td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Update the <em class="parameter"><code>devfs_dirent</code></em> label
	    from the passed devfs vnode label.  This call will be made
	    when a devfs vnode has been successfully relabeled to
	    commit the label change such that it lasts even if the
	    vnode is recycled.  It will also be made when a symlink is
	    created in devfs, following a call to
	    <code class="function">mac_vnode_create_from_vnode</code> to
	    initialize the vnode label.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-ipc-label-ops"></a>6.7.3.2. IPC Object Labeling Event Operations</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-socket"></a>6.7.3.2.1. <code class="function">mpo_create_mbuf_from_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mbuf_from_socket</strong>(</code></td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">m</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct socket
		*<var class="pdparam">so</var></code>;<br /><code>struct label
		*<var class="pdparam">socketlabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">m</var></code>;<br /><code>struct label
		*<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>socket</code></em></td><td>Socket</td><td>Socket locking WIP</td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>m</code></em></td><td>Object; mbuf</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Policy label to fill in for
		    <em class="parameter"><code>m</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on a newly created mbuf header from the
	    passed socket label.  This call is made when a new
	    datagram or message is generated by the socket and stored
	    in the passed mbuf.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-pipe"></a>6.7.3.2.2. <code class="function">mpo_create_pipe</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_pipe</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct pipe
		*<var class="pdparam">pipe</var></code>;<br /><code>struct label
		*<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on a newly created pipe from the passed
	    subject credential.  This call is made when a new pipe is
	    created.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-socket"></a>6.7.3.2.3. <code class="function">mpo_create_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_socket</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct socket
		*<var class="pdparam">so</var></code>;<br /><code>struct label
		*<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>Object; socket to label</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Label to fill in for
		    <em class="parameter"><code>so</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on a newly created socket from the
	    passed subject credential.  This call is made when a
	    socket is created.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-socket-from-socket"></a>6.7.3.2.4. <code class="function">mpo_create_socket_from_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_socket_from_socket</strong>(</code></td><td><var class="pdparam">oldsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldsocketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct socket
		*<var class="pdparam">oldsocket</var></code>;<br /><code>struct label
		*<var class="pdparam">oldsocketlabel</var></code>;<br /><code>struct socket
		*<var class="pdparam">newsocket</var></code>;<br /><code>struct label
		*<var class="pdparam">newsocketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldsocket</code></em></td><td>Listening socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldsocketlabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>oldsocket</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocket</code></em></td><td>New socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocketlabel</code></em></td><td>Policy label associated with
		    <em class="parameter"><code>newsocketlabel</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Label a socket, <em class="parameter"><code>newsocket</code></em>,
	    newly <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=accept&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>ed, based on the <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=listen&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">listen</span>(2)</span></a>
	    socket, <em class="parameter"><code>oldsocket</code></em>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-pipe"></a>6.7.3.2.5. <code class="function">mpo_relabel_pipe</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_relabel_pipe</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct pipe
		*<var class="pdparam">pipe</var></code>;<br /><code>struct label
		*<var class="pdparam">oldlabel</var></code>;<br /><code>struct label
		*<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlabel</code></em></td><td>Current policy label associated with
		    <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Policy label update to apply to
		    <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Apply a new label, <em class="parameter"><code>newlabel</code></em>, to
	    <em class="parameter"><code>pipe</code></em>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-socket"></a>6.7.3.2.6. <code class="function">mpo_relabel_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_relabel_socket</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct socket
		*<var class="pdparam">so</var></code>;<br /><code>struct label
		*<var class="pdparam">oldlabel</var></code>;<br /><code>struct label
		*<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>Object; socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlabel</code></em></td><td>Current label for
		    <em class="parameter"><code>so</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Label update for
		    <em class="parameter"><code>so</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Update the label on a socket from the passed socket
	    label update.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-set-socket-peer-from-mbuf"></a>6.7.3.2.7. <code class="function">mpo_set_socket_peer_from_mbuf</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_set_socket_peer_from_mbuf</strong>(</code></td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">mbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">mbuflabel</var></code>;<br /><code>struct label
		*<var class="pdparam">oldlabel</var></code>;<br /><code>struct label
		*<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>mbuf</code></em></td><td>First datagram received over socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Label for <em class="parameter"><code>mbuf</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlabel</code></em></td><td>Current label for the socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Policy label to be filled out for the
		    socket</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the peer label on a stream socket from the passed
	    mbuf label.  This call will be made when the first
	    datagram is received by the stream socket, with the
	    exception of Unix domain sockets.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-set-socket-peer-from-socket"></a>6.7.3.2.8. <code class="function">mpo_set_socket_peer_from_socket</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_set_socket_peer_from_socket</strong>(</code></td><td><var class="pdparam">oldsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldsocketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newsocketpeerlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct socket
		*<var class="pdparam">oldsocket</var></code>;<br /><code>struct label
		*<var class="pdparam">oldsocketlabel</var></code>;<br /><code>struct socket
		*<var class="pdparam">newsocket</var></code>;<br /><code>struct label
		*<var class="pdparam">newsocketpeerlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldsocket</code></em></td><td>Local socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldsocketlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>oldsocket</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocket</code></em></td><td>Peer socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newsocketpeerlabel</code></em></td><td>Policy label to fill in for
		    <em class="parameter"><code>newsocket</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the peer label on a stream UNIX domain socket from
	    the passed remote socket endpoint.  This call will be made
	    when the socket pair is connected, and will be made for
	    both endpoints.</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-net-labeling-event-ops"></a>6.7.3.3. Network Object Labeling Event Operations</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-bpfdesc"></a>6.7.3.3.1. <code class="function">mpo_create_bpfdesc</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_bpfdesc</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpf_d</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct bpf_d
		*<var class="pdparam">bpf_d</var></code>;<br /><code>struct label
		*<var class="pdparam">bpflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>bpf_d</code></em></td><td>Object; bpf descriptor</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>bpf</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>bpf_d</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on a newly created BPF descriptor from
	    the passed subject credential.  This call will be made
	    when a BPF device node is opened by a process with the
	    passed subject credential.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-ifnet"></a>6.7.3.3.2. <code class="function">mpo_create_ifnet</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_ifnet</strong>(</code></td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ifnet
		*<var class="pdparam">ifnet</var></code>;<br /><code>struct label
		*<var class="pdparam">ifnetlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label to fill in for
		    <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on a newly created interface.  This call
	    may be made when a new physical interface becomes
	    available to the system, or when a pseudo-interface is
	    instantiated during the boot or as a result of a user
	    action.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-ipq"></a>6.7.3.3.3. <code class="function">mpo_create_ipq</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_ipq</strong>(</code></td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">fragment</var></code>;<br /><code>struct label
		*<var class="pdparam">fragmentlabel</var></code>;<br /><code>struct ipq
		*<var class="pdparam">ipq</var></code>;<br /><code>struct label
		*<var class="pdparam">ipqlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>fragment</code></em></td><td>First received IP fragment</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragmentlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>fragment</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipq</code></em></td><td>IP reassembly queue to be labeled</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>ipq</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on a newly created IP fragment
	    reassembly queue from the mbuf header of the first
	    received fragment.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-datagram-from-ipq"></a>6.7.3.3.4. <code class="function">mpo_create_datagram_from_ipq</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_create_datagram_from_ipq</strong>(</code></td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">datagram</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">datagramlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ipq
		*<var class="pdparam">ipq</var></code>;<br /><code>struct label
		*<var class="pdparam">ipqlabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">datagram</var></code>;<br /><code>struct label
		*<var class="pdparam">datagramlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>ipq</code></em></td><td>IP reassembly queue</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>ipq</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>datagram</code></em></td><td>Datagram to be labeled</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>datagramlabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>datagramlabel</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on a newly reassembled IP datagram from
	    the IP fragment reassembly queue from which it was
	    generated.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-fragment"></a>6.7.3.3.5. <code class="function">mpo_create_fragment</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_fragment</strong>(</code></td><td><var class="pdparam">datagram</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">datagramlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">datagram</var></code>;<br /><code>struct label
		*<var class="pdparam">datagramlabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">fragment</var></code>;<br /><code>struct label
		*<var class="pdparam">fragmentlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>datagram</code></em></td><td>Datagram</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>datagramlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>datagram</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragment</code></em></td><td>Fragment to be labeled</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragmentlabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>datagram</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on the mbuf header of a newly created IP
	    fragment from the label on the mbuf header of the datagram
	    it was generate from.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-mbuf"></a>6.7.3.3.6. <code class="function">mpo_create_mbuf_from_mbuf</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mbuf_from_mbuf</strong>(</code></td><td><var class="pdparam">oldmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldmbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">oldmbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">oldmbuflabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">newmbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">newmbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldmbuf</code></em></td><td>Existing (source) mbuf</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldmbuflabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>oldmbuf</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuf</code></em></td><td>New mbuf to be labeled</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuflabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>newmbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on the mbuf header of a newly created
	    datagram from the mbuf header of an existing datagram.
	    This call may be made in a number of situations, including
	    when an mbuf is re-allocated for alignment
	    purposes.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-linklayer"></a>6.7.3.3.7. <code class="function">mpo_create_mbuf_linklayer</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mbuf_linklayer</strong>(</code></td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ifnet
		*<var class="pdparam">ifnet</var></code>;<br /><code>struct label
		*<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">mbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>mbuf header for new datagram</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>mbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on the mbuf header of a newly created
	    datagram generated for the purposes of a link layer
	    response for the passed interface.  This call may be made
	    in a number of situations, including for ARP or ND6
	    responses in the IPv4 and IPv6 stacks.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-bpfdesc"></a>6.7.3.3.8. <code class="function">mpo_create_mbuf_from_bpfdesc</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mbuf_from_bpfdesc</strong>(</code></td><td><var class="pdparam">bpf_d</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct bpf_d
		*<var class="pdparam">bpf_d</var></code>;<br /><code>struct label
		*<var class="pdparam">bpflabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">mbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>bpf_d</code></em></td><td>BPF descriptor</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>bpflabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>bpflabel</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>New mbuf to be labeled</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Policy label to fill in for
		    <em class="parameter"><code>mbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on the mbuf header of a newly created
	    datagram generated using the passed BPF descriptor.  This
	    call is made when a write is performed to the BPF device
	    associated with the passed BPF descriptor.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-from-ifnet"></a>6.7.3.3.9. <code class="function">mpo_create_mbuf_from_ifnet</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mbuf_from_ifnet</strong>(</code></td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ifnet
		*<var class="pdparam">ifnet</var></code>;<br /><code>struct label
		*<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">mbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>ifnetlabel</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>mbuf header for new datagram</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>mbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on the mbuf header of a newly created
	    datagram generated from the passed network
	    interface.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-multicast-encap"></a>6.7.3.3.10. <code class="function">mpo_create_mbuf_multicast_encap</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mbuf_multicast_encap</strong>(</code></td><td><var class="pdparam">oldmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldmbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">oldmbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">oldmbuflabel</var></code>;<br /><code>struct ifnet
		*<var class="pdparam">ifnet</var></code>;<br /><code>struct label
		*<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">newmbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">newmbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldmbuf</code></em></td><td>mbuf header for existing datagram</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldmbuflabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>oldmbuf</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuf</code></em></td><td>mbuf header to be labeled for new
		    datagram</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuflabel</code></em></td><td>Policy label to be filled in for
		    <em class="parameter"><code>newmbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on the mbuf header of a newly created
	    datagram generated from the existing passed datagram when
	    it is processed by the passed multicast encapsulation
	    interface.  This call is made when an mbuf is to be
	    delivered using the virtual interface.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-mbuf-netlayer"></a>6.7.3.3.11. <code class="function">mpo_create_mbuf_netlayer</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_mbuf_netlayer</strong>(</code></td><td><var class="pdparam">oldmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldmbuflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newmbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">oldmbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">oldmbuflabel</var></code>;<br /><code>struct mbuf
		*<var class="pdparam">newmbuf</var></code>;<br /><code>struct label
		*<var class="pdparam">newmbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>oldmbuf</code></em></td><td>Received datagram</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldmbuflabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>oldmbuf</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuf</code></em></td><td>Newly created datagram</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newmbuflabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>newmbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label on the mbuf header of a newly created
	    datagram generated by the IP stack in response to an
	    existing received datagram
	    (<em class="parameter"><code>oldmbuf</code></em>).  This call may be made
	    in a number of situations, including when responding to
	    ICMP request datagrams.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-fragment-match"></a>6.7.3.3.12. <code class="function">mpo_fragment_match</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
		<strong class="fsfunc">mpo_fragment_match</strong>(</code></td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">fragment</var></code>;<br /><code>struct label
		*<var class="pdparam">fragmentlabel</var></code>;<br /><code>struct ipq
		*<var class="pdparam">ipq</var></code>;<br /><code>struct label
		*<var class="pdparam">ipqlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>fragment</code></em></td><td>IP datagram fragment</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>fragmentlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>fragment</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipq</code></em></td><td>IP fragment reassembly queue</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>ipq</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether an mbuf header containing an IP
	    datagram (<em class="parameter"><code>fragment</code></em>) fragment
	    matches the label of the passed IP fragment reassembly
	    queue (<em class="parameter"><code>ipq</code></em>).  Return
	    (<span class="returnvalue">1</span>) for a successful match, or
	    (<span class="returnvalue">0</span>) for no match.  This call is
	    made when the IP stack attempts to find an existing
	    fragment reassembly queue for a newly received fragment;
	    if this fails, a new fragment reassembly queue may be
	    instantiated for the fragment.  Policies may use this
	    entry point to prevent the reassembly of otherwise
	    matching IP fragments if policy does not permit them to be
	    reassembled based on the label or other
	    information.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-ifnet-relabel"></a>6.7.3.3.13. <code class="function">mpo_relabel_ifnet</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_relabel_ifnet</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
		*<var class="pdparam">ifnet</var></code>;<br /><code>struct label
		*<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct label
		*<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Object; Network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Label update to apply to
		    <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Update the label of network interface,
	    <em class="parameter"><code>ifnet</code></em>, based on the passed update
	    label, <em class="parameter"><code>newlabel</code></em>, and the passed
	    subject credential, <em class="parameter"><code>cred</code></em>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-update-ipq"></a>6.7.3.3.14. <code class="function">mpo_update_ipq</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_update_ipq</strong>(</code></td><td><var class="pdparam">fragment</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">fragmentlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipq</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ipqlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct mbuf
		*<var class="pdparam">fragment</var></code>;<br /><code>struct label
		*<var class="pdparam">fragmentlabel</var></code>;<br /><code>struct ipq
		*<var class="pdparam">ipq</var></code>;<br /><code>struct label
		*<var class="pdparam">ipqlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>mbuf</code></em></td><td>IP fragment</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>mbuf</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipq</code></em></td><td>IP fragment reassembly queue</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ipqlabel</code></em></td><td>Policy label to be updated for
		    <em class="parameter"><code>ipq</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Update the label on an IP fragment reassembly queue
	    (<em class="parameter"><code>ipq</code></em>) based on the acceptance of
	    the passed IP fragment mbuf header
	    (<em class="parameter"><code>mbuf</code></em>).</p></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-proc-labeling-event-ops"></a>6.7.3.4. Process Labeling Event Operations</h4></div></div></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-cred"></a>6.7.3.4.1. <code class="function">mpo_create_cred</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_cred</strong>(</code></td><td><var class="pdparam">parent_cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">child_cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">parent_cred</var></code>;<br /><code>struct ucred
		*<var class="pdparam">child_cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>parent_cred</code></em></td><td>Parent subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>child_cred</code></em></td><td>Child subject credential</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Set the label of a newly created subject credential
	    from the passed subject credential.  This call will be
	    made when <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=crcopy&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">crcopy</span>(9)</span></a> is invoked on a newly created
	    <span class="type">struct ucred</span>.  This call should not be
	    confused with a process forking or creation event.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-execve-transition"></a>6.7.3.4.2. <code class="function">mpo_execve_transition</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_execve_transition</strong>(</code></td><td><var class="pdparam">old</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">new</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">old</var></code>;<br /><code>struct ucred
		*<var class="pdparam">new</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vnodelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>old</code></em></td><td>Existing subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>new</code></em></td><td>New subject credential to be labeled</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>File to execute</td><td>Locked</td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Update the label of a newly created subject credential
	    (<em class="parameter"><code>new</code></em>) from the passed existing
	    subject credential (<em class="parameter"><code>old</code></em>) based on a
	    label transition caused by executing the passed vnode
	    (<em class="parameter"><code>vp</code></em>).  This call occurs when a
	    process executes the passed vnode and one of the policies
	    returns a success from the
	    <code class="function">mpo_execve_will_transition</code> entry
	    point.  Policies may choose to implement this call simply
	    by invoking <code class="function">mpo_create_cred</code> and
	    passing the two subject credentials so as not to implement
	    a transitioning event.  Policies should not leave this
	    entry point unimplemented if they implement
	    <code class="function">mpo_create_cred</code>, even if they do not
	    implement
	    <code class="function">mpo_execve_will_transition</code>.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-execve-will-transition"></a>6.7.3.4.3. <code class="function">mpo_execve_will_transition</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
		<strong class="fsfunc">mpo_execve_will_transition</strong>(</code></td><td><var class="pdparam">old</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">old</var></code>;<br /><code>struct vnode
		*<var class="pdparam">vp</var></code>;<br /><code>struct label
		*<var class="pdparam">vnodelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>old</code></em></td><td>Subject credential prior to
		    <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a></td><td>Immutable</td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>File to execute</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td>Policy label for
		    <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the policy will want to perform a
	    transition event as a result of the execution of the
	    passed vnode by the passed subject credential.  Return
	    <span class="returnvalue">1</span> if a transition is required,
	    <span class="returnvalue">0</span> if not.  Even if a policy
	    returns <span class="returnvalue">0</span>, it should behave
	    correctly in the presence of an unexpected invocation of
	    <code class="function">mpo_execve_transition</code>, as that call
	    may happen as a result of another policy requesting a
	    transition.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-proc0"></a>6.7.3.4.4. <code class="function">mpo_create_proc0</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_proc0</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential to be filled in</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Create the subject credential of process 0, the parent
	    of all kernel processes.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-create-proc1"></a>6.7.3.4.5. <code class="function">mpo_create_proc1</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_create_proc1</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential to be filled in</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Create the subject credential of process 1, the parent
	    of all user processes.</p></div><div class="sect4"><div xmlns="" class="titlepage"><div><div><h5 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-relabel-cred"></a>6.7.3.4.6. <code class="function">mpo_relabel_cred</code></h5></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
		<strong class="fsfunc">mpo_relabel_cred</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
		*<var class="pdparam">cred</var></code>;<br /><code>struct label
		*<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Label update to apply to
		    <em class="parameter"><code>cred</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Update the label on a subject credential from the
	    passed update label.</p></div></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-access-control-checks"></a>6.7.4. Access Control Checks</h3></div></div></div><p>Access control entry points permit policy modules to
	influence access control decisions made by the kernel.
	Generally, although not always, arguments to an access control
	entry point will include one or more authorizing credentials,
	information (possibly including a label) for any other objects
	involved in the operation.  An access control entry point may
	return 0 to permit the operation, or an <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=errno&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">errno</span>(2)</span></a> error
	value.  The results of invoking the entry point across various
	registered policy modules will be composed as follows: if all
	modules permit the operation to succeed, success will be
	returned.  If one or modules returns a failure, a failure will
	be returned.  If more than one module returns a failure, the
	errno value to return to the user will be selected using the
	following precedence, implemented by the
	<code class="function">error_select()</code> function in
	<code class="filename">kern_mac.c</code>:</p><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col /><col /></colgroup><tbody><tr><td>Most precedence</td><td><span class="errorcode">EDEADLK</span></td></tr><tr><td> </td><td><span class="errorcode">EINVAL</span></td></tr><tr><td> </td><td><span class="errorcode">ESRCH</span></td></tr><tr><td> </td><td>EACCES</td></tr><tr><td>Least precedence</td><td>EPERM</td></tr></tbody></table></div><p>If none of the error values returned by all modules are
	listed in the precedence chart then an arbitrarily selected
	value from the set will be returned.  In general, the rules
	provide precedence to errors in the following order: kernel
	failures, invalid arguments, object not present, access not
	permitted, other.</p><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-bpfdesc-check-receive-from-ifnet"></a>6.7.4.1. <code class="function">mpo_check_bpfdesc_receive</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_bpfdesc_receive</strong>(</code></td><td><var class="pdparam">bpf_d</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">bpflabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct bpf_d
	      *<var class="pdparam">bpf_d</var></code>;<br /><code>struct label
	      *<var class="pdparam">bpflabel</var></code>;<br /><code>struct ifnet
	      *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
	      *<var class="pdparam">ifnetlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>bpf_d</code></em></td><td>Subject; BPF descriptor</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>bpflabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>bpf_d</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Object; network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the MAC framework should permit
	  datagrams from the passed interface to be delivered to the
	  buffers of the passed BPF descriptor.  Return
	  (<span class="returnvalue">0</span>) for success, or an
	  <code class="varname">errno</code> value for failure Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatches,
	  <span class="errorcode">EPERM</span> for lack of privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-dump"></a>6.7.4.2. <code class="function">mpo_check_kenv_dump</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_kenv_dump</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  retrieve the kernel environment (see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=kenv&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">kenv</span>(2)</span></a>).</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-get"></a>6.7.4.3. <code class="function">mpo_check_kenv_get</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_kenv_get</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>char *<var class="pdparam">name</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>Kernel environment variable name</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  retrieve the value of the specified kernel environment
	  variable.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-set"></a>6.7.4.4. <code class="function">mpo_check_kenv_set</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_kenv_set</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>char *<var class="pdparam">name</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>Kernel environment variable name</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to set
	  the specified kernel environment variable.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kenv-unset"></a>6.7.4.5. <code class="function">mpo_check_kenv_unset</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_kenv_unset</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>char *<var class="pdparam">name</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>Kernel environment variable name</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to unset
	  the specified kernel environment variable.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kld-load"></a>6.7.4.6. <code class="function">mpo_check_kld_load</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_kld_load</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Kernel module vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to load
	  the specified module file.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kld-stat"></a>6.7.4.7. <code class="function">mpo_check_kld_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_kld_stat</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  retrieve a list of loaded kernel module files and associated
	  statistics.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-kld-unload"></a>6.7.4.8. <code class="function">mpo_check_kld_unload</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_kld_unload</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  unload a kernel module.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-ioctl"></a>6.7.4.9. <code class="function">mpo_check_pipe_ioctl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_pipe_ioctl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cmd</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">data</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
	      *<var class="pdparam">pipe</var></code>;<br /><code>struct label
	      *<var class="pdparam">pipelabel</var></code>;<br /><code>unsigned long
	      <var class="pdparam">cmd</var></code>;<br /><code>void *<var class="pdparam">data</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cmd</code></em></td><td><a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> command</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>data</code></em></td><td><a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> data</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to make
	  the specified <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> call.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-poll"></a>6.7.4.10. <code class="function">mpo_check_pipe_poll</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_pipe_poll</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
	      *<var class="pdparam">pipe</var></code>;<br /><code>struct label
	      *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to poll
	  <em class="parameter"><code>pipe</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-read"></a>6.7.4.11. <code class="function">mpo_check_pipe_read</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_pipe_read</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
	      *<var class="pdparam">pipe</var></code>;<br /><code>struct label
	      *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed read
	  access to <em class="parameter"><code>pipe</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-relabel"></a>6.7.4.12. <code class="function">mpo_check_pipe_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_pipe_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
	      *<var class="pdparam">pipe</var></code>;<br /><code>struct label
	      *<var class="pdparam">pipelabel</var></code>;<br /><code>struct label
	      *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td>Current policy label associated with
		  <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Label update to
		  <em class="parameter"><code>pipelabel</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  relabel <em class="parameter"><code>pipe</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-stat"></a>6.7.4.13. <code class="function">mpo_check_pipe_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_pipe_stat</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
	      *<var class="pdparam">pipe</var></code>;<br /><code>struct label
	      *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  retrieve statistics related to
	  <em class="parameter"><code>pipe</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-pipe-write"></a>6.7.4.14. <code class="function">mpo_check_pipe_write</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_pipe_write</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipe</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">pipelabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct pipe
	      *<var class="pdparam">pipe</var></code>;<br /><code>struct label
	      *<var class="pdparam">pipelabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipe</code></em></td><td>Pipe</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>pipelabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>pipe</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to write
	  to <em class="parameter"><code>pipe</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-bind"></a>6.7.4.15. <code class="function">mpo_check_socket_bind</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_bind</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sockaddr</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">socket</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;<br /><code>struct sockaddr
	      *<var class="pdparam">sockaddr</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>Socket to be bound</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sockaddr</code></em></td><td>Address of
		  <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-connect"></a>6.7.4.16. <code class="function">mpo_check_socket_connect</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_connect</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">sockaddr</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">socket</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;<br /><code>struct sockaddr
	      *<var class="pdparam">sockaddr</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>Socket to be connected</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>sockaddr</code></em></td><td>Address of
		  <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential
	  (<em class="parameter"><code>cred</code></em>) can connect the passed socket
	  (<em class="parameter"><code>socket</code></em>) to the passed socket address
	  (<em class="parameter"><code>sockaddr</code></em>).  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatches,
	  <span class="errorcode">EPERM</span> for lack of privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-socket-receive"></a>6.7.4.17. <code class="function">mpo_check_socket_receive</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_receive</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">so</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>Socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>so</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  receive information from the socket
	  <em class="parameter"><code>so</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-socket-send"></a>6.7.4.18. <code class="function">mpo_check_socket_send</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_send</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">so</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>Socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>so</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to send
	  information across the socket
	  <em class="parameter"><code>so</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-cred-visible"></a>6.7.4.19. <code class="function">mpo_check_cred_visible</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_cred_visible</strong>(</code></td><td><var class="pdparam">u1</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">u2</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">u1</var></code>;<br /><code>struct ucred
	      *<var class="pdparam">u2</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>u1</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>u2</code></em></td><td>Object credential</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential
	  <em class="parameter"><code>u1</code></em> can <span class="quote">&#8220;<span class="quote">see</span>&#8221;</span> other
	  subjects with the passed subject credential
	  <em class="parameter"><code>u2</code></em>.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatches,
	  <span class="errorcode">EPERM</span> for lack of privilege, or
	  <span class="errorcode">ESRCH</span> to hide visibility.  This call
	  may be made in a number of situations, including
	  inter-process status sysctl's used by <code class="command">ps</code>,
	  and in procfs lookups.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-visible"></a>6.7.4.20. <code class="function">mpo_check_socket_visible</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_visible</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">socket</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>Object; socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-ifnet-relabel"></a>6.7.4.21. <code class="function">mpo_check_ifnet_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_ifnet_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
	      *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
	      *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct label
	      *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Object; network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Existing policy label for
		  <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Policy label update to later be applied to
		  <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can relabel the
	  passed network interface to the passed label update.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-relabel"></a>6.7.4.22. <code class="function">mpo_check_socket_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">socket</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;<br /><code>struct label
	      *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>Object; socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Existing policy label for
		  <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Label update to later be applied to
		  <em class="parameter"><code>socketlabel</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can relabel the
	  passed socket to the passed label update.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-cred-relabel"></a>6.7.4.23. <code class="function">mpo_check_cred_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_cred_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct label
	      *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Label update to later be applied to
		  <em class="parameter"><code>cred</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can relabel
	  itself to the passed label update.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-relabel"></a>6.7.4.24. <code class="function">mpo_check_vnode_relabel</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_relabel</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vnodelabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">vnodelabel</var></code>;<br /><code>struct label
	      *<var class="pdparam">newlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td>Locked</td></tr><tr><td><em class="parameter"><code>vnodelabel</code></em></td><td>Existing policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlabel</code></em></td><td>Policy label update to later be applied to
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can relabel the
	  passed vnode to the passed label update.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-cred-check-mount-stat"></a>6.7.4.25. <code class="function">mpo_check_mount_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_mount_stat</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mountlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct mount
	      *<var class="pdparam">mp</var></code>;<br /><code>struct label
	      *<var class="pdparam">mountlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mp</code></em></td><td>Object; file system mount</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mountlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>mp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can see the
	  results of a statfs performed on the file system.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatches
	  or <span class="errorcode">EPERM</span> for lack of privilege.  This
	  call may be made in a number of situations, including during
	  invocations of <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=statfs&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">statfs</span>(2)</span></a> and related calls, as well as
	  to determine what file systems to exclude from listings of
	  file systems, such as when <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=getfsstat&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">getfsstat</span>(2)</span></a> is
	  invoked.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-proc-debug"></a>6.7.4.26. <code class="function">mpo_check_proc_debug</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_proc_debug</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">proc</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct proc
	      *<var class="pdparam">proc</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>proc</code></em></td><td>Object; process</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can debug the
	  passed process.  Return <span class="returnvalue">0</span> for
	  success, or an <code class="varname">errno</code> value for failure.
	  Suggested failure: <span class="errorcode">EACCES</span> for label
	  mismatch, <span class="errorcode">EPERM</span> for lack of
	  privilege, or <span class="errorcode">ESRCH</span> to hide
	  visibility of the target.  This call may be made in a number
	  of situations, including use of the <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=ptrace&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">ptrace</span>(2)</span></a> and
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=ktrace&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">ktrace</span>(2)</span></a> APIs, as well as for some types of procfs
	  operations.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-access"></a>6.7.4.27. <code class="function">mpo_check_vnode_access</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_access</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flags</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">flags</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flags</code></em></td><td><a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=access&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">access</span>(2)</span></a> flags</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine how invocations of <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=access&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">access</span>(2)</span></a> and related
	  calls by the subject credential should return when performed
	  on the passed vnode using the passed access flags.  This
	  should generally be implemented using the same semantics
	  used in <code class="function">mpo_check_vnode_open</code>.
	  Return <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatches
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-chdir"></a>6.7.4.28. <code class="function">mpo_check_vnode_chdir</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_chdir</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">dvp</var></code>;<br /><code>struct label
	      *<var class="pdparam">dlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Object; vnode to <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chdir&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chdir</span>(2)</span></a> into</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can change the
	  process working directory to the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-chroot"></a>6.7.4.29. <code class="function">mpo_check_vnode_chroot</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_chroot</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">dvp</var></code>;<br /><code>struct label
	      *<var class="pdparam">dlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Directory vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chroot</span>(2)</span></a> into the specified directory
	  (<em class="parameter"><code>dvp</code></em>).</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-create"></a>6.7.4.30. <code class="function">mpo_check_vnode_create</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_create</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vap</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">dvp</var></code>;<br /><code>struct label
	      *<var class="pdparam">dlabel</var></code>;<br /><code>struct componentname
	      *<var class="pdparam">cnp</var></code>;<br /><code>struct vattr
	      *<var class="pdparam">vap</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>Component name for
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vap</code></em></td><td>vnode attributes for
		  <em class="parameter"><code>vap</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can create a
	  vnode with the passed parent directory, passed name
	  information, and passed attribute information.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of privilege.  This
	  call may be made in a number of situations, including as a
	  result of calls to <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=open&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> with
	  <span class="symbol">O_CREAT</span>, <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=mkfifo&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">mkfifo</span>(2)</span></a>, and others.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-delete"></a>6.7.4.31. <code class="function">mpo_check_vnode_delete</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_delete</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">dvp</var></code>;<br /><code>struct label
	      *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>void *<var class="pdparam">label</var></code>;<br /><code>struct componentname
	      *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Parent directory vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode to delete</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>Component name for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can delete a
	  vnode from the passed parent directory and passed name
	  information.  Return <span class="returnvalue">0</span> for
	  success, or an <code class="varname">errno</code> value for failure.
	  Suggested failure: <span class="errorcode">EACCES</span> for label
	  mismatch, or <span class="errorcode">EPERM</span> for lack of
	  privilege.  This call may be made in a number of situations,
	  including as a result of calls to <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=unlink&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">unlink</span>(2)</span></a> and
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=rmdir&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">rmdir</span>(2)</span></a>.  Policies implementing this entry point
	  should also implement
	  <code class="function">mpo_check_rename_to</code> to authorize
	  deletion of objects as a result of being the target of a
	  rename.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-deleteacl"></a>6.7.4.32. <code class="function">mpo_check_vnode_deleteacl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_deleteacl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">type</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>acl_type_t
	      <var class="pdparam">type</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td>Locked</td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>type</code></em></td><td>ACL type</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can delete the
	  ACL of passed type from the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-exec"></a>6.7.4.33. <code class="function">mpo_check_vnode_exec</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_exec</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode to execute</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can execute the
	  passed vnode.  Determination of execute privilege is made
	  separately from decisions about any transitioning event.
	  Return <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mpo-cred-check-vnode-getacl"></a>6.7.4.34. <code class="function">mpo_check_vnode_getacl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_getacl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">type</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>acl_type_t
	      <var class="pdparam">type</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>type</code></em></td><td>ACL type</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can retrieve
	  the ACL of passed type from the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-getextattr"></a>6.7.4.35. <code class="function">mpo_check_vnode_getextattr</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_getextattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">attrnamespace</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uio</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int
	      <var class="pdparam">attrnamespace</var></code>;<br /><code>const char
	      *<var class="pdparam">name</var></code>;<br /><code>struct uio
	      *<var class="pdparam">uio</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>attrnamespace</code></em></td><td>Extended attribute namespace</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>Extended attribute name</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>uio</code></em></td><td>I/O structure pointer; see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=uio&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">uio</span>(9)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can retrieve
	  the extended attribute with the passed namespace and name
	  from the passed vnode.  Policies implementing labeling using
	  extended attributes may be interested in special handling of
	  operations on those extended attributes.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-link"></a>6.7.4.36. <code class="function">mpo_check_vnode_link</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_link</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">dvp</var></code>;<br /><code>struct label
	      *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>struct componentname
	      *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Directory vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Link destination vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>Component name for the link being
		  created</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  create a link to the vnode <em class="parameter"><code>vp</code></em> with
	  the name specified by <em class="parameter"><code>cnp</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-mmap"></a>6.7.4.37. <code class="function">mpo_check_vnode_mmap</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_mmap</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">prot</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">prot</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Vnode to map</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>prot</code></em></td><td>Mmap protections (see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=mmap&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">mmap</span>(2)</span></a>)</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to map
	  the vnode <em class="parameter"><code>vp</code></em> with the protections
	  specified in <em class="parameter"><code>prot</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-mmap-downgrade"></a>6.7.4.38. <code class="function">mpo_check_vnode_mmap_downgrade</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
	      <strong class="fsfunc">mpo_check_vnode_mmap_downgrade</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">prot</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int *<var class="pdparam">prot</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td rowspan="3">See <a class="xref" href="mac-entry-point-reference.html#mac-mpo-check-vnode-mmap" title="6.7.4.37. mpo_check_vnode_mmap">Section 6.7.4.37, &#8220;<code class="function">mpo_check_vnode_mmap</code>&#8221;</a>.</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>prot</code></em></td><td>Mmap protections to be downgraded</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Downgrade the mmap protections based on the subject and
	  object labels.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-mprotect"></a>6.7.4.39. <code class="function">mpo_check_vnode_mprotect</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_mprotect</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">prot</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">prot</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Mapped vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>prot</code></em></td><td>Memory protections</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to set
	  the specified memory protections on memory mapped from the
	  vnode <em class="parameter"><code>vp</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-poll"></a>6.7.4.40. <code class="function">mpo_check_vnode_poll</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_poll</strong>(</code></td><td><var class="pdparam">active_cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">file_cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">active_cred</var></code>;<br /><code>struct ucred
	      *<var class="pdparam">file_cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>active_cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>file_cred</code></em></td><td>Credential associated with the <span class="type">struct
		  file</span></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Polled vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to poll
	  the vnode <em class="parameter"><code>vp</code></em>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-rename-from"></a>6.7.4.41. <code class="function">mpo_check_vnode_rename_from</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_vnode_rename_from</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">dvp</var></code>;<br /><code>struct label
	      *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>struct componentname
	      *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Directory vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Vnode to be renamed</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>Component name for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  rename the vnode <em class="parameter"><code>vp</code></em> to something
	  else.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-vnode-rename-to"></a>6.7.4.42. <code class="function">mpo_check_vnode_rename_to</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_rename_to</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dvp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">dlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">samedir</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">dvp</var></code>;<br /><code>struct label
	      *<var class="pdparam">dlabel</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">samedir</var></code>;<br /><code>struct componentname
	      *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Directory vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Overwritten vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>samedir</code></em></td><td>Boolean; <code class="literal">1</code> if the source and
		  destination directories are the same</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>Destination component name</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  rename to the vnode <em class="parameter"><code>vp</code></em>, into the
	  directory <em class="parameter"><code>dvp</code></em>, or to the name
	  represented by <em class="parameter"><code>cnp</code></em>.  If there is no
	  existing file to overwrite, <em class="parameter"><code>vp</code></em> and
	  <em class="parameter"><code>label</code></em> will be NULL.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-listen"></a>6.7.4.43. <code class="function">mpo_check_socket_listen</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_listen</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socket</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">socket</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socket</code></em></td><td>Object; socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>socket</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can listen on
	  the passed socket.  Return <span class="returnvalue">0</span> for
	  success, or an <code class="varname">errno</code> value for failure.
	  Suggested failure: <span class="errorcode">EACCES</span> for label
	  mismatch, or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-lookup"></a>6.7.4.44. <code class="function">mpo_check_vnode_lookup</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_lookup</strong>(</code></td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">cnp</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred *<var class="pdparam"></var>cred</code>;<br /><code>struct vnode *<var class="pdparam"></var>dvp</code>;<br /><code>struct label *<var class="pdparam"></var>dlabel</code>;<br /><code>struct componentname
	      *<var class="pdparam">cnp</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>cnp</code></em></td><td>Component name being looked up</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can perform a
	  lookup in the passed directory vnode for the passed name.
	  Return <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-open"></a>6.7.4.45. <code class="function">mpo_check_vnode_open</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_open</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">acc_mode</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int <var class="pdparam">acc_mode</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>acc_mode</code></em></td><td><a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=open&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> access mode</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can perform an
	  open operation on the passed vnode with the passed access
	  mode.  Return <span class="returnvalue">0</span> for success, or
	  an errno value for failure.  Suggested failure:
	  <span class="errorcode">EACCES</span> for label mismatch, or
	  <span class="errorcode">EPERM</span> for lack of privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-readdir"></a>6.7.4.46. <code class="function">mpo_check_vnode_readdir</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_readdir</strong>(</code></td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred *<var class="pdparam"></var>cred</code>;<br /><code>struct vnode *<var class="pdparam"></var>dvp</code>;<br /><code>struct label *<var class="pdparam"></var>dlabel</code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dvp</code></em></td><td>Object; directory vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>dlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>dvp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can perform a
	  <code class="function">readdir</code> operation on the passed
	  directory vnode.  Return <span class="returnvalue">0</span> for
	  success, or an <code class="varname">errno</code> value for failure.
	  Suggested failure: <span class="errorcode">EACCES</span> for label
	  mismatch, or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-readlink"></a>6.7.4.47. <code class="function">mpo_check_vnode_readlink</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_readlink</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can perform a
	  <code class="function">readlink</code> operation on the passed
	  symlink vnode.  Return <span class="returnvalue">0</span> for
	  success, or an <code class="varname">errno</code> value for failure.
	  Suggested failure: <span class="errorcode">EACCES</span> for label
	  mismatch, or <span class="errorcode">EPERM</span> for lack of
	  privilege.  This call may be made in a number of situations,
	  including an explicit <code class="function">readlink</code> call by
	  the user process, or as a result of an implicit
	  <code class="function">readlink</code> during a name lookup by the
	  process.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-revoke"></a>6.7.4.48. <code class="function">mpo_check_vnode_revoke</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_revoke</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can revoke
	  access to the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setacl"></a>6.7.4.49. <code class="function">mpo_check_vnode_setacl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_setacl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">type</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">acl</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>acl_type_t
	      <var class="pdparam">type</var></code>;<br /><code>struct acl
	      *<var class="pdparam">acl</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>type</code></em></td><td>ACL type</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>acl</code></em></td><td>ACL</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can set the
	  passed ACL of passed type on the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setextattr"></a>6.7.4.50. <code class="function">mpo_check_vnode_setextattr</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_setextattr</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">attrnamespace</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uio</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>int
	      <var class="pdparam">attrnamespace</var></code>;<br /><code>const char
	      *<var class="pdparam">name</var></code>;<br /><code>struct uio
	      *<var class="pdparam">uio</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>attrnamespace</code></em></td><td>Extended attribute namespace</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td>Extended attribute name</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>uio</code></em></td><td>I/O structure pointer; see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=uio&amp;sektion=9&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">uio</span>(9)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can set the
	  extended attribute of passed name and passed namespace on
	  the passed vnode.  Policies implementing security labels
	  backed into extended attributes may want to provide
	  additional protections for those attributes.  Additionally,
	  policies should avoid making decisions based on the data
	  referenced from <em class="parameter"><code>uio</code></em>, as there is a
	  potential race condition between this check and the actual
	  operation.  The <em class="parameter"><code>uio</code></em> may also be
	  <code class="literal">NULL</code> if a delete operation is being
	  performed.  Return <span class="returnvalue">0</span> for success,
	  or an <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setflags"></a>6.7.4.51. <code class="function">mpo_check_vnode_setflags</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_setflags</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flags</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>u_long <var class="pdparam">flags</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>flags</code></em></td><td>File flags; see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chflags&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chflags</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can set the
	  passed flags on the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setmode"></a>6.7.4.52. <code class="function">mpo_check_vnode_setmode</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_setmode</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mode</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>mode_t <var class="pdparam">mode</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mode</code></em></td><td>File mode; see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=chmod&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">chmod</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can set the
	  passed mode on the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setowner"></a>6.7.4.53. <code class="function">mpo_check_vnode_setowner</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_setowner</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uid</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">gid</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;<br /><code>uid_t <var class="pdparam">uid</var></code>;<br /><code>gid_t <var class="pdparam">gid</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>uid</code></em></td><td>User ID</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>gid</code></em></td><td>Group ID</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can set the
	  passed uid and passed gid as file uid and file gid on the
	  passed vnode.  The IDs may be set to (<code class="literal">-1</code>)
	  to request no update.  Return <span class="returnvalue">0</span>
	  for success, or an <code class="varname">errno</code> value for
	  failure.  Suggested failure: <span class="errorcode">EACCES</span>
	  for label mismatch, or <span class="errorcode">EPERM</span> for lack
	  of privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-setutimes"></a>6.7.4.54. <code class="function">mpo_check_vnode_setutimes</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_setutimes</strong>(</code></td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam"></var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred *<var class="pdparam"></var>cred</code>;<br /><code>struct vnode *<var class="pdparam"></var>vp</code>;<br /><code>struct label *<var class="pdparam"></var>label</code>;<br /><code>struct timespec <var class="pdparam"></var>atime</code>;<br /><code>struct timespec <var class="pdparam"></var>mtime</code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vp</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>atime</code></em></td><td>Access time; see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=utimes&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">utimes</span>(2)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mtime</code></em></td><td>Modification time; see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=utimes&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">utimes</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can set the
	  passed access timestamps on the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-proc-sched"></a>6.7.4.55. <code class="function">mpo_check_proc_sched</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_proc_sched</strong>(</code></td><td><var class="pdparam">ucred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">proc</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">ucred</var></code>;<br /><code>struct proc
	      *<var class="pdparam">proc</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>proc</code></em></td><td>Object; process</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can change the
	  scheduling parameters of the passed process.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  <span class="errorcode">EPERM</span> for lack of privilege, or
	  <span class="errorcode">ESRCH</span> to limit visibility.</p><p>See <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=setpriority&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">setpriority</span>(2)</span></a> for more information.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-proc-signal"></a>6.7.4.56. <code class="function">mpo_check_proc_signal</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_proc_signal</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">proc</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">signal</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct proc
	      *<var class="pdparam">proc</var></code>;<br /><code>int <var class="pdparam">signal</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>proc</code></em></td><td>Object; process</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>signal</code></em></td><td>Signal; see <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=kill&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">kill</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can deliver the
	  passed signal to the passed process.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  <span class="errorcode">EPERM</span> for lack of privilege, or
	  <span class="errorcode">ESRCH</span> to limit visibility.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-vnode-stat"></a>6.7.4.57. <code class="function">mpo_check_vnode_stat</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_vnode_stat</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">label</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">label</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Object; vnode</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>label</code></em></td><td>Policy label for
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential can
	  <code class="function">stat</code> the passed vnode.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p><p>See <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=stat&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">stat</span>(2)</span></a> for more information.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-ifnet-transmit"></a>6.7.4.58. <code class="function">mpo_check_ifnet_transmit</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_ifnet_transmit</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
	      *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
	      *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
	      *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
	      *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>Object; mbuf to be sent</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>mbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the network interface can transmit the
	  passed mbuf.  Return <span class="returnvalue">0</span> for
	  success, or an <code class="varname">errno</code> value for failure.
	  Suggested failure: <span class="errorcode">EACCES</span> for label
	  mismatch, or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-cred-check-socket-deliver"></a>6.7.4.59. <code class="function">mpo_check_socket_deliver</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_deliver</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnet</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">ifnetlabel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuf</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mbuflabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct ifnet
	      *<var class="pdparam">ifnet</var></code>;<br /><code>struct label
	      *<var class="pdparam">ifnetlabel</var></code>;<br /><code>struct mbuf
	      *<var class="pdparam">mbuf</var></code>;<br /><code>struct label
	      *<var class="pdparam">mbuflabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnet</code></em></td><td>Network interface</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>ifnetlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>ifnet</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuf</code></em></td><td>Object; mbuf to be delivered</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>mbuflabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>mbuf</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the socket may receive the datagram
	  stored in the passed mbuf header.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failures: <span class="errorcode">EACCES</span> for label mismatch,
	  or <span class="errorcode">EPERM</span> for lack of
	  privilege.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-socket-visible"></a>6.7.4.60. <code class="function">mpo_check_socket_visible</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_socket_visible</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">so</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">socketlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct socket
	      *<var class="pdparam">so</var></code>;<br /><code>struct label
	      *<var class="pdparam">socketlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td>Immutable</td></tr><tr><td><em class="parameter"><code>so</code></em></td><td>Object; socket</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>socketlabel</code></em></td><td>Policy label for
		  <em class="parameter"><code>so</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject credential cred can "see"
	  the passed socket (<em class="parameter"><code>socket</code></em>) using
	  system monitoring functions, such as those employed by
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=netstat&amp;sektion=8&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">netstat</span>(8)</span></a> and <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sockstat&amp;sektion=1&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sockstat</span>(1)</span></a>.  Return
	  <span class="returnvalue">0</span> for success, or an
	  <code class="varname">errno</code> value for failure.  Suggested
	  failure: <span class="errorcode">EACCES</span> for label mismatches,
	  <span class="errorcode">EPERM</span> for lack of privilege, or
	  <span class="errorcode">ESRCH</span> to hide visibility.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-acct"></a>6.7.4.61. <code class="function">mpo_check_system_acct</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_system_acct</strong>(</code></td><td><var class="pdparam">ucred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">ucred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>ucred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Accounting file; <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=acct&amp;sektion=5&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">acct</span>(5)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  enable accounting, based on its label and the label of the
	  accounting log file.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-nfsd"></a>6.7.4.62. <code class="function">mpo_check_system_nfsd</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_system_nfsd</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to call
	  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=nfssvc&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">nfssvc</span>(2)</span></a>.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-reboot"></a>6.7.4.63. <code class="function">mpo_check_system_reboot</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_system_reboot</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">howto</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>int <var class="pdparam">howto</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>howto</code></em></td><td><em class="parameter"><code>howto</code></em> parameter from
		  <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=reboot&amp;sektion=2&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">reboot</span>(2)</span></a></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to
	  reboot the system in the specified manner.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-settime"></a>6.7.4.64. <code class="function">mpo_check_system_settime</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_system_settime</strong>(</code></td><td><var class="pdparam">cred</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the user should be allowed to set the
	  system clock.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-swapon"></a>6.7.4.65. <code class="function">mpo_check_system_swapon</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_system_swapon</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vlabel</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>struct vnode
	      *<var class="pdparam">vp</var></code>;<br /><code>struct label
	      *<var class="pdparam">vlabel</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vp</code></em></td><td>Swap device</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>vlabel</code></em></td><td>Label associated with
		  <em class="parameter"><code>vp</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to add
	  <em class="parameter"><code>vp</code></em> as a swap device.</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-mpo-check-system-sysctl"></a>6.7.4.66. <code class="function">mpo_check_system_sysctl</code></h4></div></div></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int
	      <strong class="fsfunc">mpo_check_system_sysctl</strong>(</code></td><td><var class="pdparam">cred</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">name</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">namelen</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">old</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">oldlenp</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">inkernel</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">new</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">newlen</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>struct ucred
	      *<var class="pdparam">cred</var></code>;<br /><code>int *<var class="pdparam">name</var></code>;<br /><code>u_int *<var class="pdparam">namelen</var></code>;<br /><code>void *<var class="pdparam">old</var></code>;<br /><code>size_t
	      *<var class="pdparam">oldlenp</var></code>;<br /><code>int <var class="pdparam">inkernel</var></code>;<br /><code>void *<var class="pdparam">new</var></code>;<br /><code>size_t <var class="pdparam">newlen</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="informaltable"><table class="informaltable" width="100%" border="0"><colgroup><col width="0" class="first" /><col width="0" /><col width="0" class="last" /></colgroup><thead><tr><th>Parameter</th><th>Description</th><th>Locking</th></tr></thead><tbody><tr><td><em class="parameter"><code>cred</code></em></td><td>Subject credential</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>name</code></em></td><td rowspan="4">See <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>namelen</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>old</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>oldlenp</code></em></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>inkernel</code></em></td><td>Boolean; <code class="literal">1</code> if called from
		  kernel</td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>new</code></em></td><td rowspan="2">See <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a></td><td class="auto-generated"> </td></tr><tr><td><em class="parameter"><code>newlen</code></em></td><td class="auto-generated"> </td></tr></tbody></table></div><p>Determine whether the subject should be allowed to make
	  the specified <a class="citerefentry" href="https://www.FreeBSD.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;manpath=freebsd-release-ports"><span class="citerefentry"><span class="refentrytitle">sysctl</span>(3)</span></a> transaction.</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mac-label-management"></a>6.7.5. Label Management Calls</h3></div></div></div><p>Relabel events occur when a user process has requested
	that the label on an object be modified.  A two-phase update
	occurs: first, an access control check will be performed to
	determine if the update is both valid and permitted, and then
	the update itself is performed via a separate entry point.
	Relabel entry points typically accept the object, object label
	reference, and an update label submitted by the process.
	Memory allocation during relabel is discouraged, as relabel
	calls are not permitted to fail (failure should be reported
	earlier in the relabel check).</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mac-policy-architecture.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="mac.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="mac-userland-arch.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">6.6. MAC Policy Architecture </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 6.8. Userland Architecture</td></tr></table></div><p xmlns="" align="center"><small>All FreeBSD documents are available for download
    at <a href="https://download.freebsd.org/ftp/doc/">https://download.freebsd.org/ftp/doc/</a></small></p><p xmlns="" align="center"><small>Questions that are not answered by the
    <a href="https://www.FreeBSD.org/docs.html">documentation</a> may be
    sent to &lt;<a href="mailto:freebsd-questions@FreeBSD.org">freebsd-questions@FreeBSD.org</a>&gt;.<br />
    Send questions about this document to &lt;<a href="mailto:freebsd-doc@FreeBSD.org">freebsd-doc@FreeBSD.org</a>&gt;.</small></p></body></html>